# 时空旅人拍卖会 - 开发指南

## 快速开始

### 1. 环境准备

确保您的开发环境已安装以下工具：

- **Node.js** (版本 14 或更高)
- **HBuilderX** 或 **Vue CLI**
- **微信开发者工具** (用于小程序开发)
- **支付宝开发者工具** (用于支付宝小程序开发)

### 2. 项目安装

```bash
# 克隆项目
git clone <项目地址>
cd peace_sale

# 安装依赖
npm install
```

### 3. 开发运行

#### H5 开发
```bash
npm run dev:h5
```
访问 `http://localhost:8080` 查看效果

#### 微信小程序开发
```bash
npm run dev:mp-weixin
```
使用微信开发者工具打开 `dist/dev/mp-weixin` 目录

#### 支付宝小程序开发
```bash
npm run dev:mp-alipay
```
使用支付宝开发者工具打开 `dist/dev/mp-alipay` 目录

## 项目结构说明

### 核心目录

```
src/
├── pages/           # 页面文件
├── components/      # 组件文件
├── services/        # 服务层（业务逻辑）
├── store/          # 状态管理
├── utils/          # 工具函数
└── static/         # 静态资源
```

### 数据文件

- `static/data/artifacts.json` - 奇物数据
- `static/data/items.json` - 道具数据
- `static/data/collections.json` - 收藏集配置

## 开发规范

### 1. 代码规范

- 使用 ES6+ 语法
- 组件名使用 PascalCase
- 文件名使用 kebab-case
- 函数和变量使用 camelCase

### 2. 组件开发

```vue
<template>
  <view class="component-name">
    <!-- 模板内容 -->
  </view>
</template>

<script>
export default {
  name: 'ComponentName',
  props: {
    // 属性定义
  },
  data() {
    return {
      // 数据定义
    }
  },
  methods: {
    // 方法定义
  }
}
</script>

<style scoped>
/* 样式定义 */
</style>
```

### 3. 服务层开发

```javascript
// services/example-service.js
class ExampleService {
  constructor() {
    // 初始化
  }
  
  async methodName() {
    // 业务逻辑
  }
}

export default new ExampleService()
```

## 功能开发指南

### 1. 添加新奇物

1. 在 `static/data/artifacts.json` 中添加数据：
```json
{
  "id": "artifact_new",
  "name": "新奇物名称",
  "era": "时代",
  "location": "地点",
  "story": "背景故事",
  "collectionTags": ["标签1", "标签2"],
  "baseValue": 10,
  "image": "/static/images/artifacts/artifact_new.jpg"
}
```

2. 添加对应的图片资源

### 2. 添加新道具

1. 在 `static/data/items.json` 中添加数据：
```json
{
  "id": "item_new",
  "name": "新道具名称",
  "price": 20,
  "description": "道具描述",
  "type": "类型",
  "targetType": "目标类型",
  "useTiming": "使用时机",
  "effect": "效果名称",
  "icon": "/static/images/items/item_new.png"
}
```

2. 在 `services/item-service.js` 中实现效果：
```javascript
executeNewEffect(item, target) {
  return {
    effect: 'new_effect',
    message: '新效果执行成功',
    target: target
  }
}
```

### 3. 添加新收藏集

1. 在 `static/data/collections.json` 中添加配置：
```json
{
  "id": "collection_new",
  "name": "新收藏集",
  "description": "收藏集描述",
  "requiredCount": 3,
  "tags": ["标签1"],
  "rewardPoints": 50,
  "icon": "/static/images/collections/new_collection.png"
}
```

## 调试技巧

### 1. 控制台调试

```javascript
// 在组件中使用
console.log('调试信息', data)

// 在服务中使用
console.error('错误信息', error)
```

### 2. 网络请求调试

```javascript
// 在 uni.request 中添加调试信息
uni.request({
  url: '/api/data',
  success: (res) => {
    console.log('请求成功', res.data)
  },
  fail: (err) => {
    console.error('请求失败', err)
  }
})
```

### 3. 状态管理调试

```javascript
// 在组件中监听状态变化
watch: {
  gamePhase(newVal, oldVal) {
    console.log('游戏阶段变化:', oldVal, '->', newVal)
  }
}
```

## 性能优化

### 1. 图片优化

- 使用 WebP 格式（支持的情况下）
- 压缩图片大小
- 使用懒加载

### 2. 代码优化

- 避免在模板中使用复杂计算
- 使用 `v-show` 替代 `v-if`（频繁切换时）
- 合理使用 `computed` 和 `watch`

### 3. 内存管理

- 及时清理定时器
- 避免内存泄漏
- 合理使用缓存

## 常见问题

### 1. 小程序开发问题

**问题**: 小程序真机调试时数据加载失败
**解决**: 检查网络请求域名是否在小程序后台配置

**问题**: 组件样式在小程序中不生效
**解决**: 检查样式作用域，使用 `scoped` 或调整样式优先级

### 2. H5 开发问题

**问题**: 路由跳转失败
**解决**: 检查 `pages.json` 配置是否正确

**问题**: 样式兼容性问题
**解决**: 使用浏览器前缀，测试不同浏览器

### 3. 数据问题

**问题**: 静态数据加载失败
**解决**: 检查文件路径和 JSON 格式

**问题**: 状态管理数据丢失
**解决**: 检查 Vuex 配置和组件生命周期

## 部署指南

### 1. H5 部署

```bash
# 构建
npm run build:h5

# 部署到服务器
# 将 dist 目录上传到 Web 服务器
```

### 2. 小程序部署

```bash
# 微信小程序
npm run build:mp-weixin
# 使用微信开发者工具上传

# 支付宝小程序
npm run build:mp-alipay
# 使用支付宝开发者工具上传
```

## 版本管理

### 1. Git 工作流

```bash
# 创建功能分支
git checkout -b feature/new-feature

# 提交更改
git add .
git commit -m "feat: 添加新功能"

# 推送分支
git push origin feature/new-feature
```

### 2. 版本发布

```bash
# 更新版本号
npm version patch

# 构建发布版本
npm run build:h5
npm run build:mp-weixin
npm run build:mp-alipay
```

## 联系支持

如果在开发过程中遇到问题，可以通过以下方式获取帮助：

- 查看项目 README.md
- 提交 GitHub Issue
- 联系开发团队

---

**注意**: 本指南会随着项目发展持续更新，请定期查看最新版本。
