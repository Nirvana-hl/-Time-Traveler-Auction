{"remainingRequest":"D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\babel-loader\\lib\\index.js!D:\\大学生活\\大三\\全栈ai\\项目\\-Time-Traveler-Auction\\src\\features\\game\\room-actions.service.js","dependencies":[{"path":"D:\\大学生活\\大三\\全栈ai\\项目\\-Time-Traveler-Auction\\src\\features\\game\\room-actions.service.js","mtime":1762152678219},{"path":"D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762215254891},{"path":"D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\babel-loader\\lib\\index.js","mtime":1762215256120}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8g5oi/6Ze05Z+656GA5pON5L2c77ya5YeG5aSH44CB5o2i5bqn44CB56a75byA5oi/6Ze0CgpleHBvcnQgYXN5bmMgZnVuY3Rpb24gdG9nZ2xlUmVhZHkoewogIHJvb21JZCwKICB1c2VySWQsCiAgcm9vbSwKICByb29tU2VydmljZSwKICByZWxvYWQKfSkgewogIGlmICghcm9vbUlkIHx8ICF1c2VySWQpIHJldHVybjsKICBjb25zdCBtZSA9IChyb29tICYmIHJvb20ucm9vbV9wbGF5ZXJzID8gcm9vbS5yb29tX3BsYXllcnMgOiBbXSkuZmluZChwID0+IHAudXNlcl9pZCA9PT0gdXNlcklkKTsKICBjb25zdCBuZXh0ID0gIShtZSAmJiBtZS5pc19yZWFkeSk7CiAgYXdhaXQgcm9vbVNlcnZpY2Uuc2V0UmVhZHkocm9vbUlkLCB1c2VySWQsIG5leHQpOwogIGlmIChyZWxvYWQpIGF3YWl0IHJlbG9hZCgpOwp9CmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtb3ZlVG9TZWF0KHsKICByb29tSWQsCiAgdXNlcklkLAogIHJvb20sCiAgc2VhdHMsCiAgcm9vbVNlcnZpY2UsCiAgcmVsb2FkCn0pIHsKICBpZiAoIXJvb21JZCB8fCAhdXNlcklkKSByZXR1cm47CiAgY29uc3QgbWUgPSAocm9vbSAmJiByb29tLnJvb21fcGxheWVycyA/IHJvb20ucm9vbV9wbGF5ZXJzIDogW10pLmZpbmQocCA9PiBwLnVzZXJfaWQgPT09IHVzZXJJZCk7CiAgY29uc3QgbXlPbGQgPSBtZSAmJiB0eXBlb2YgbWUuc2VhdF9pbmRleCA9PT0gJ251bWJlcicgPyBtZS5zZWF0X2luZGV4IDogLTE7CiAgY29uc3QgdGFyZ2V0ID0gc2VhdHMgJiYgc2VhdHMucGxheWVyID8gc2VhdHMucGxheWVyIDogbnVsbDsKICBjb25zdCBpZHggPSBzZWF0cyAmJiB0eXBlb2Ygc2VhdHMuaW5kZXggPT09ICdudW1iZXInID8gc2VhdHMuaW5kZXggOiAtMTsKICBpZiAoaWR4IDwgMCkgcmV0dXJuOwogIGlmICh0YXJnZXQgJiYgdGFyZ2V0LnVzZXJfaWQgJiYgdGFyZ2V0LnVzZXJfaWQgIT09IHVzZXJJZCkgewogICAgYXdhaXQgcm9vbVNlcnZpY2Uuc2V0U2VhdChyb29tSWQsIHRhcmdldC51c2VyX2lkLCBudWxsKTsKICAgIGF3YWl0IHJvb21TZXJ2aWNlLnNldFNlYXQocm9vbUlkLCB1c2VySWQsIGlkeCk7CiAgICBpZiAobXlPbGQgPj0gMCkgYXdhaXQgcm9vbVNlcnZpY2Uuc2V0U2VhdChyb29tSWQsIHRhcmdldC51c2VyX2lkLCBteU9sZCk7CiAgfSBlbHNlIHsKICAgIGF3YWl0IHJvb21TZXJ2aWNlLnNldFNlYXQocm9vbUlkLCB1c2VySWQsIGlkeCk7CiAgfQogIGlmIChyZWxvYWQpIGF3YWl0IHJlbG9hZCgpOwp9CmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsZWF2ZVJvb20oewogIHJvb21JZCwKICB1c2VySWQsCiAgY2xlYXJBdWN0aW9uVGltZXIsCiAgc2V0Q291bnRkb3duLAogIHN0b3JlLAogIGF1Y3Rpb25TZXJ2aWNlLAogIHJvb21TZXJ2aWNlLAogIHVuc3Vic2NyaWJlLAogIHNldFJvb21JZCwKICBzZXRMb2NhbFJvb20sCiAgbmF2aWdhdGVUb1Jvb21zCn0pIHsKICBpZiAoIXJvb21JZCB8fCAhdXNlcklkKSByZXR1cm47CiAgY2xlYXJBdWN0aW9uVGltZXIgJiYgY2xlYXJBdWN0aW9uVGltZXIoKTsKICBzZXRDb3VudGRvd24gJiYgc2V0Q291bnRkb3duKDApOwogIHN0b3JlLmNvbW1pdCgnU0VUX0dBTUVfUEhBU0UnLCAncHJlcGFyYXRpb24nKTsKICBzdG9yZS5jb21taXQoJ1NFVF9DVVJSRU5UX0FVQ1RJT05TJywgW10pOwogIHRyeSB7CiAgICBhdWN0aW9uU2VydmljZS5zdG9wQWxsKCk7CiAgfSBjYXRjaCAoXykge30KICBhd2FpdCByb29tU2VydmljZS5sZWF2ZVJvb20ocm9vbUlkLCB1c2VySWQpOwogIHVuc3Vic2NyaWJlICYmIHVuc3Vic2NyaWJlKCk7CiAgc2V0Um9vbUlkICYmIHNldFJvb21JZChudWxsKTsKICBzZXRMb2NhbFJvb20gJiYgc2V0TG9jYWxSb29tKG51bGwpOwogIG5hdmlnYXRlVG9Sb29tcyAmJiBuYXZpZ2F0ZVRvUm9vbXMoKTsKfQ=="},{"version":3,"names":["toggleReady","roomId","userId","room","roomService","reload","me","room_players","find","p","user_id","next","is_ready","setReady","moveToSeat","seats","myOld","seat_index","target","player","idx","index","setSeat","leaveRoom","clearAuctionTimer","setCountdown","store","auctionService","unsubscribe","setRoomId","setLocalRoom","navigateToRooms","commit","stopAll","_"],"sources":["D:/大学生活/大三/全栈ai/项目/-Time-Traveler-Auction/src/features/game/room-actions.service.js"],"sourcesContent":["// 房间基础操作：准备、换座、离开房间\r\n\r\nexport async function toggleReady({ roomId, userId, room, roomService, reload }) {\r\n  if (!roomId || !userId) return\r\n  const me = (room && room.room_players ? room.room_players : []).find(p => p.user_id === userId)\r\n  const next = !(me && me.is_ready)\r\n  await roomService.setReady(roomId, userId, next)\r\n  if (reload) await reload()\r\n}\r\n\r\nexport async function moveToSeat({ roomId, userId, room, seats, roomService, reload }) {\r\n  if (!roomId || !userId) return\r\n  const me = (room && room.room_players ? room.room_players : []).find(p => p.user_id === userId)\r\n  const myOld = (me && typeof me.seat_index === 'number') ? me.seat_index : -1\r\n  const target = seats && seats.player ? seats.player : null\r\n  const idx = seats && typeof seats.index === 'number' ? seats.index : -1\r\n  if (idx < 0) return\r\n  if (target && target.user_id && target.user_id !== userId) {\r\n    await roomService.setSeat(roomId, target.user_id, null)\r\n    await roomService.setSeat(roomId, userId, idx)\r\n    if (myOld >= 0) await roomService.setSeat(roomId, target.user_id, myOld)\r\n  } else {\r\n    await roomService.setSeat(roomId, userId, idx)\r\n  }\r\n  if (reload) await reload()\r\n}\r\n\r\nexport async function leaveRoom({\r\n  roomId,\r\n  userId,\r\n  clearAuctionTimer,\r\n  setCountdown,\r\n  store,\r\n  auctionService,\r\n  roomService,\r\n  unsubscribe,\r\n  setRoomId,\r\n  setLocalRoom,\r\n  navigateToRooms,\r\n}) {\r\n  if (!roomId || !userId) return\r\n  clearAuctionTimer && clearAuctionTimer()\r\n  setCountdown && setCountdown(0)\r\n  store.commit('SET_GAME_PHASE', 'preparation')\r\n  store.commit('SET_CURRENT_AUCTIONS', [])\r\n  try { auctionService.stopAll() } catch (_) {}\r\n  await roomService.leaveRoom(roomId, userId)\r\n  unsubscribe && unsubscribe()\r\n  setRoomId && setRoomId(null)\r\n  setLocalRoom && setLocalRoom(null)\r\n  navigateToRooms && navigateToRooms()\r\n}\r\n\r\n\r\n"],"mappings":"AAAA;;AAEA,OAAO,eAAeA,WAAWA,CAAC;EAAEC,MAAM;EAAEC,MAAM;EAAEC,IAAI;EAAEC,WAAW;EAAEC;AAAO,CAAC,EAAE;EAC/E,IAAI,CAACJ,MAAM,IAAI,CAACC,MAAM,EAAE;EACxB,MAAMI,EAAE,GAAG,CAACH,IAAI,IAAIA,IAAI,CAACI,YAAY,GAAGJ,IAAI,CAACI,YAAY,GAAG,EAAE,EAAEC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,OAAO,KAAKR,MAAM,CAAC;EAC/F,MAAMS,IAAI,GAAG,EAAEL,EAAE,IAAIA,EAAE,CAACM,QAAQ,CAAC;EACjC,MAAMR,WAAW,CAACS,QAAQ,CAACZ,MAAM,EAAEC,MAAM,EAAES,IAAI,CAAC;EAChD,IAAIN,MAAM,EAAE,MAAMA,MAAM,CAAC,CAAC;AAC5B;AAEA,OAAO,eAAeS,UAAUA,CAAC;EAAEb,MAAM;EAAEC,MAAM;EAAEC,IAAI;EAAEY,KAAK;EAAEX,WAAW;EAAEC;AAAO,CAAC,EAAE;EACrF,IAAI,CAACJ,MAAM,IAAI,CAACC,MAAM,EAAE;EACxB,MAAMI,EAAE,GAAG,CAACH,IAAI,IAAIA,IAAI,CAACI,YAAY,GAAGJ,IAAI,CAACI,YAAY,GAAG,EAAE,EAAEC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,OAAO,KAAKR,MAAM,CAAC;EAC/F,MAAMc,KAAK,GAAIV,EAAE,IAAI,OAAOA,EAAE,CAACW,UAAU,KAAK,QAAQ,GAAIX,EAAE,CAACW,UAAU,GAAG,CAAC,CAAC;EAC5E,MAAMC,MAAM,GAAGH,KAAK,IAAIA,KAAK,CAACI,MAAM,GAAGJ,KAAK,CAACI,MAAM,GAAG,IAAI;EAC1D,MAAMC,GAAG,GAAGL,KAAK,IAAI,OAAOA,KAAK,CAACM,KAAK,KAAK,QAAQ,GAAGN,KAAK,CAACM,KAAK,GAAG,CAAC,CAAC;EACvE,IAAID,GAAG,GAAG,CAAC,EAAE;EACb,IAAIF,MAAM,IAAIA,MAAM,CAACR,OAAO,IAAIQ,MAAM,CAACR,OAAO,KAAKR,MAAM,EAAE;IACzD,MAAME,WAAW,CAACkB,OAAO,CAACrB,MAAM,EAAEiB,MAAM,CAACR,OAAO,EAAE,IAAI,CAAC;IACvD,MAAMN,WAAW,CAACkB,OAAO,CAACrB,MAAM,EAAEC,MAAM,EAAEkB,GAAG,CAAC;IAC9C,IAAIJ,KAAK,IAAI,CAAC,EAAE,MAAMZ,WAAW,CAACkB,OAAO,CAACrB,MAAM,EAAEiB,MAAM,CAACR,OAAO,EAAEM,KAAK,CAAC;EAC1E,CAAC,MAAM;IACL,MAAMZ,WAAW,CAACkB,OAAO,CAACrB,MAAM,EAAEC,MAAM,EAAEkB,GAAG,CAAC;EAChD;EACA,IAAIf,MAAM,EAAE,MAAMA,MAAM,CAAC,CAAC;AAC5B;AAEA,OAAO,eAAekB,SAASA,CAAC;EAC9BtB,MAAM;EACNC,MAAM;EACNsB,iBAAiB;EACjBC,YAAY;EACZC,KAAK;EACLC,cAAc;EACdvB,WAAW;EACXwB,WAAW;EACXC,SAAS;EACTC,YAAY;EACZC;AACF,CAAC,EAAE;EACD,IAAI,CAAC9B,MAAM,IAAI,CAACC,MAAM,EAAE;EACxBsB,iBAAiB,IAAIA,iBAAiB,CAAC,CAAC;EACxCC,YAAY,IAAIA,YAAY,CAAC,CAAC,CAAC;EAC/BC,KAAK,CAACM,MAAM,CAAC,gBAAgB,EAAE,aAAa,CAAC;EAC7CN,KAAK,CAACM,MAAM,CAAC,sBAAsB,EAAE,EAAE,CAAC;EACxC,IAAI;IAAEL,cAAc,CAACM,OAAO,CAAC,CAAC;EAAC,CAAC,CAAC,OAAOC,CAAC,EAAE,CAAC;EAC5C,MAAM9B,WAAW,CAACmB,SAAS,CAACtB,MAAM,EAAEC,MAAM,CAAC;EAC3C0B,WAAW,IAAIA,WAAW,CAAC,CAAC;EAC5BC,SAAS,IAAIA,SAAS,CAAC,IAAI,CAAC;EAC5BC,YAAY,IAAIA,YAAY,CAAC,IAAI,CAAC;EAClCC,eAAe,IAAIA,eAAe,CAAC,CAAC;AACtC","ignoreList":[]}]}