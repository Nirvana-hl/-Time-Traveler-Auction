{"remainingRequest":"D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\babel-loader\\lib\\index.js!D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\大学生活\\大三\\全栈ai\\项目\\-Time-Traveler-Auction\\src\\pages\\index\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\大学生活\\大三\\全栈ai\\项目\\-Time-Traveler-Auction\\src\\pages\\index\\index.vue","mtime":1762829596718},{"path":"D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762215254891},{"path":"D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\babel-loader\\lib\\index.js","mtime":1762215256120},{"path":"D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762215254891},{"path":"D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\vue-loader\\lib\\index.js","mtime":1762215256637}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgbWFwU3RhdGUsIG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IEF1Y3Rpb25QYW5lbCBmcm9tICcuLi8uLi9jb21wb25lbnRzL2F1Y3Rpb24tcGFuZWwvYXVjdGlvbi1wYW5lbC52dWUnOwppbXBvcnQgcm9vbVNlcnZpY2UgZnJvbSAnLi4vLi4vc2VydmljZXMvcm9vbS1zZXJ2aWNlJzsKaW1wb3J0IHsgZ2V0U3VwYWJhc2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9zdXBhYmFzZS1jbGllbnQnOwppbXBvcnQgYXVjdGlvblNlcnZpY2UgZnJvbSAnLi4vLi4vc2VydmljZXMvYXVjdGlvbi1zZXJ2aWNlJzsKaW1wb3J0IHsgc3RhcnRDb3VudGRvd24sIGNsZWFyQ291bnRkb3duIH0gZnJvbSAnLi4vLi4vZmVhdHVyZXMvZ2FtZS9jb3VudGRvd24nOwppbXBvcnQgeyBsb2FkUm9vbVN0YXRlIGFzIGxvYWRSb29tU3RhdGVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vZmVhdHVyZXMvZ2FtZS9yb29tLXN0YXRlLnNlcnZpY2UnOwppbXBvcnQgeyBzdWJzY3JpYmVSb29tUmVhbHRpbWUgYXMgc3Vic2NyaWJlUm9vbVJlYWx0aW1lU2VydmljZSwgdW5zdWJzY3JpYmVSb29tUmVhbHRpbWUgYXMgdW5zdWJzY3JpYmVSb29tUmVhbHRpbWVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vZmVhdHVyZXMvZ2FtZS9yb29tLXJlYWx0aW1lJzsKaW1wb3J0IHsgc3RhcnRHYW1lIGFzIHN0YXJ0R2FtZUZsb3csIGF1dG9TdGFydEF1Y3Rpb24gYXMgYXV0b1N0YXJ0QXVjdGlvbkZsb3cgfSBmcm9tICcuLi8uLi9mZWF0dXJlcy9nYW1lL2F1Y3Rpb24tZmxvdy5zZXJ2aWNlJzsKaW1wb3J0IHsgc2VuZENoYXRNZXNzYWdlIH0gZnJvbSAnLi4vLi4vZmVhdHVyZXMvZ2FtZS9jaGF0LnNlcnZpY2UnOwppbXBvcnQgeyB0b2dnbGVSZWFkeSBhcyB0b2dnbGVSZWFkeUFjdGlvbiwgbW92ZVRvU2VhdCBhcyBtb3ZlVG9TZWF0QWN0aW9uLCBsZWF2ZVJvb20gYXMgbGVhdmVSb29tQWN0aW9uIH0gZnJvbSAnLi4vLi4vZmVhdHVyZXMvZ2FtZS9yb29tLWFjdGlvbnMuc2VydmljZSc7CmltcG9ydCB7IGxvYWRBcnRpZmFjdHMgYXMgbG9hZEFydGlmYWN0c1NlcnZpY2UgfSBmcm9tICcuLi8uLi9mZWF0dXJlcy9nYW1lL2FydGlmYWN0cy5zZXJ2aWNlJzsKaW1wb3J0IHsgbG9hZENvbGxlY3Rpb25zRnJvbUFydGlmYWN0cywgZ2V0Q3VycmVudENvbGxlY3Rpb25Db3VudCBhcyBnZXRDb2xsZWN0aW9uQ291bnRVdGlsLCBnZXRDb2xsZWN0aW9uUHJvZ3Jlc3MgYXMgZ2V0Q29sbGVjdGlvblByb2dyZXNzVXRpbCB9IGZyb20gJy4uLy4uL2ZlYXR1cmVzL2dhbWUvY29sbGVjdGlvbnMudXRpbHMnOwppbXBvcnQgeyBmb3JtYXRNZXNzYWdlVGltZSBhcyBmb3JtYXRNZXNzYWdlVGltZUhlbHBlciwgZ2V0QXZhdGFyRm9yIGFzIGdldEF2YXRhckZvckhlbHBlciwgZ2V0TmFtZUZvciBhcyBnZXROYW1lRm9ySGVscGVyIH0gZnJvbSAnLi4vLi4vZmVhdHVyZXMvZ2FtZS91aS5oZWxwZXJzJzsKaW1wb3J0IHsgZmlyc3RMb2dpbkRpYWxvZ3VlIGFzIGZpcnN0TG9naW5EaWFsb2d1ZUNvbmZpZywgZ2V0Q3VycmVudExhbmd1YWdlIGFzIGdldEN1cnJlbnRMYW5ndWFnZUltcG9ydGVkIH0gZnJvbSAnLi4vLi4vY29uZmlnL2RpYWxvZ3VlLWNvbmZpZyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnR2FtZUluZGV4JywKICBjb21wb25lbnRzOiB7CiAgICBBdWN0aW9uUGFuZWwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzZWxlY3RlZENhcmQ6IG51bGwsCiAgICAgIHNob3dIYW5kUG9wdXA6IGZhbHNlLAogICAgICBoYW5kUGxheWVyOiBudWxsLAogICAgICBhcnRpZmFjdE1hcDoge30sCiAgICAgIHJvb206IG51bGwsCiAgICAgIHByb2ZpbGVNYXA6IHt9LAogICAgICByZWZyZXNoVGltZXI6IG51bGwsCiAgICAgIGNvbGxlY3Rpb25zOiBbXSwKICAgICAgc2hvd0dhbWVFbmREaWFsb2c6IGZhbHNlLAogICAgICBmaW5hbFNjb3JlczogW10sCiAgICAgIHdpbm5lckluZm86IG51bGwsCiAgICAgIGF1Y3Rpb25Db3VudGRvd246IDAsCiAgICAgIGF1Y3Rpb25UaW1lcjogbnVsbCwKICAgICAgY3VycmVudEF1Y3Rpb246IG51bGwsCiAgICAgIC8vIOWbnuWQiOebuOWFs++8iOWJjeerr+WunuaXtuaYvuekuu+8jOaIv+S4u+avj+i9ruW8gOaLjeaXtuW5v+aSreS7peS/neaMgeWQjOatpe+8iQogICAgICByb3VuZENvdW50OiAwLAogICAgICB0b3RhbFJvdW5kczogNiwKICAgICAgY2hhdE1lc3NhZ2VzOiBbXSwKICAgICAgbmV3TWVzc2FnZTogJycsCiAgICAgIGNoYXRDaGFubmVsOiBudWxsLAogICAgICBjb3VudGRvd25JblByb2dyZXNzOiBmYWxzZSwKICAgICAgZXhwYW5kZWRDb2xsZWN0aW9uczoge30sCiAgICAgIHNob3dOYXJyYXRpb246IGZhbHNlLAogICAgICB0eXBpbmdUZXh0OiAnJywKICAgICAgdHlwaW5nVGltZXI6IG51bGwsCiAgICAgIC8vIOWtmOWCqOaJgOacieeOqeWutueahOaJi+eJjOaVsOaNru+8jOeUqOS6juS7t+WAvOiuoeeulwogICAgICBhbGxQbGF5ZXJzQXJ0aWZhY3RzOiB7fSwKICAgICAgLy8g5paH54mp6L2u5pKt55u45YWz5pWw5o2uCiAgICAgIGFydGlmYWN0Q2Fyb3VzZWxEYXRhOiBbXSwKICAgICAgY3VycmVudFNsaWRlOiAwLAogICAgICBjYXJvdXNlbEludGVydmFsOiBudWxsLAogICAgICAvLyDpn7PkuZDmjqfliLbnm7jlhbPmlbDmja4KICAgICAgaXNNdXNpY1BsYXlpbmc6IGZhbHNlLAogICAgICBhdWRpb0VsZW1lbnQ6IG51bGwsCiAgICAgIG11c2ljVm9sdW1lOiAwLjUKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoWydnYW1lUGhhc2UnLCAnZ2FtZUxvZycsICdzaG93Q2FyZERldGFpbCcsICd1c2VyJywgJ3Jvb21JZCcsICdyb3VuZEN1cnJlbnQnLCAncm91bmRUb3RhbCddKSwKICAgIC8vIOWwhuW9k+WJjeeOqeWutuazqOWFpeWIsOa4suafk+S4iuS4i+aWh++8jOmBv+WFjeaooeadv+W8leeUqOaKpemUmQogICAgY3VycmVudFBsYXllcigpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmN1cnJlbnRQbGF5ZXI7CiAgICB9LAogICAgaXNPd25lcigpIHsKICAgICAgcmV0dXJuIHRoaXMucm9vbSAmJiB0aGlzLnVzZXIgJiYgdGhpcy5yb29tLm93bmVyX2lkID09PSB0aGlzLnVzZXIuaWQ7CiAgICB9LAogICAgYWxsUmVhZHkoKSB7CiAgICAgIGNvbnN0IHBsYXllcnMgPSB0aGlzLnJvb20gJiYgdGhpcy5yb29tLnJvb21fcGxheWVycyA/IHRoaXMucm9vbS5yb29tX3BsYXllcnMgOiBbXTsKICAgICAgcmV0dXJuIHBsYXllcnMubGVuZ3RoID4gMCAmJiBwbGF5ZXJzLmV2ZXJ5KHAgPT4gISFwLmlzX3JlYWR5KTsKICAgIH0sCiAgICBjdXJyZW50VXNlclJlYWR5KCkgewogICAgICBjb25zdCB1c2VyID0gdGhpcy51c2VyOwogICAgICBjb25zdCBwbGF5ZXJzID0gdGhpcy5yb29tICYmIHRoaXMucm9vbS5yb29tX3BsYXllcnMgPyB0aGlzLnJvb20ucm9vbV9wbGF5ZXJzIDogW107CiAgICAgIGlmICghdXNlcikgcmV0dXJuIGZhbHNlOwogICAgICBjb25zdCBtZSA9IHBsYXllcnMuZmluZChwID0+IHAudXNlcl9pZCA9PT0gdXNlci5pZCk7CiAgICAgIHJldHVybiAhIShtZSAmJiBtZS5pc19yZWFkeSk7CiAgICB9LAogICAgcGxheWVyQ291bnQoKSB7CiAgICAgIHJldHVybiB0aGlzLnJvb20gJiYgdGhpcy5yb29tLnJvb21fcGxheWVycyA/IHRoaXMucm9vbS5yb29tX3BsYXllcnMubGVuZ3RoIDogMDsKICAgIH0sCiAgICBvd25lck5hbWUoKSB7CiAgICAgIGlmICghdGhpcy5yb29tKSByZXR1cm4gJy0nOwogICAgICByZXR1cm4gdGhpcy5nZXROYW1lRm9yKHRoaXMucm9vbS5vd25lcl9pZCk7CiAgICB9LAogICAgc2VhdENvdW50KCkgewogICAgICByZXR1cm4gdGhpcy5yb29tICYmIE51bWJlcih0aGlzLnJvb20ubWF4X3BsYXllcnMpID8gTnVtYmVyKHRoaXMucm9vbS5tYXhfcGxheWVycykgOiAwOwogICAgfSwKICAgIHNlYXRzKCkgewogICAgICBjb25zdCBwbGF5ZXJzID0gdGhpcy5yb29tICYmIHRoaXMucm9vbS5yb29tX3BsYXllcnMgPyB0aGlzLnJvb20ucm9vbV9wbGF5ZXJzIDogW107CiAgICAgIGNvbnN0IG1heCA9IHRoaXMuc2VhdENvdW50OwogICAgICBjb25zdCBzZWF0cyA9IEFycmF5LmZyb20oewogICAgICAgIGxlbmd0aDogbWF4CiAgICAgIH0sICgpID0+ICh7CiAgICAgICAgcGxheWVyOiBudWxsCiAgICAgIH0pKTsKICAgICAgLy8g5pS+572u5bey6K6+572u5bqn5L2N55qE546p5a62CiAgICAgIHBsYXllcnMuZm9yRWFjaChwID0+IHsKICAgICAgICBjb25zdCBpZHggPSB0eXBlb2YgcC5zZWF0X2luZGV4ID09PSAnbnVtYmVyJyA/IHAuc2VhdF9pbmRleCA6IC0xOwogICAgICAgIGlmIChpZHggPj0gMCAmJiBpZHggPCBtYXggJiYgIXNlYXRzW2lkeF0ucGxheWVyKSBzZWF0c1tpZHhdLnBsYXllciA9IHA7CiAgICAgIH0pOwogICAgICAvLyDlsIbmnKrorr7nva7luqfkvY3nmoTnjqnlrrbkvp3mrKHmlL7liLDnqbrkvY0KICAgICAgcGxheWVycy5maWx0ZXIocCA9PiB0eXBlb2YgcC5zZWF0X2luZGV4ICE9PSAnbnVtYmVyJyB8fCBwLnNlYXRfaW5kZXggPCAwKS5mb3JFYWNoKHAgPT4gewogICAgICAgIGNvbnN0IGVtcHR5SWR4ID0gc2VhdHMuZmluZEluZGV4KHMgPT4gIXMucGxheWVyKTsKICAgICAgICBpZiAoZW1wdHlJZHggPj0gMCkgc2VhdHNbZW1wdHlJZHhdLnBsYXllciA9IHA7CiAgICAgIH0pOwogICAgICByZXR1cm4gc2VhdHM7CiAgICB9LAogICAgZ2FtZVBoYXNlVGV4dCgpIHsKICAgICAgY29uc3QgcGhhc2VNYXAgPSB7CiAgICAgICAgJ3ByZXBhcmF0aW9uJzogJ+WHhuWkh+mYtuautScsCiAgICAgICAgJ2NvdW50ZG93bic6ICfpooTlgJLorqHml7YnLAogICAgICAgICdpbnRlcm1pc3Npb24nOiAn6Ze05q2H6Zi25q61JywKICAgICAgICAnYXVjdGlvbic6ICfmi43ljZbpmLbmrrUnLAogICAgICAgICdzZXR0bGVtZW50JzogJ+e7k+eul+mYtuautScKICAgICAgfTsKICAgICAgcmV0dXJuIHBoYXNlTWFwW3RoaXMuZ2FtZVBoYXNlXSB8fCAn5pyq55+l6Zi25q61JzsKICAgIH0sCiAgICAvLyDmoLnmja7lvZPliY3nlKjmiLfmiYvniYzorqHnrpfmlLbol4/pm4bmmL7npLrmlbDmja7vvIzluKbnvJPlrZjlrZfmrrXvvIzkvr/kuo7mqKHmnb/nm7TmjqXlvJXnlKgKICAgIGNvbGxlY3Rpb25zQ29tcHV0ZWQoKSB7CiAgICAgIGNvbnN0IGxpc3QgPSBBcnJheS5pc0FycmF5KHRoaXMuY29sbGVjdGlvbnMpID8gdGhpcy5jb2xsZWN0aW9ucyA6IFtdOwogICAgICAvLyDku4XlsZXnpLrnlKjmiLfmiYvniYzkuK3oh7PlsJHljIXlkKsx5Lu26K+l5pS26JeP6ZuG55qE5oOF5Ya1CiAgICAgIHJldHVybiBsaXN0Lm1hcChjb2wgPT4gewogICAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLmdldEN1cnJlbnRDb2xsZWN0aW9uQ291bnQoY29sKTsKICAgICAgICBjb25zdCBwcm9ncmVzcyA9IE1hdGgubWluKGN1cnJlbnQgLyAoY29sLnJlcXVpcmVkQ291bnQgfHwgMSkgKiAxMDAsIDEwMCk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIC4uLmNvbCwKICAgICAgICAgIF9jdXJyZW50OiBjdXJyZW50LAogICAgICAgICAgX3Byb2dyZXNzOiBwcm9ncmVzcwogICAgICAgIH07CiAgICAgIH0pLmZpbHRlcihjb2wgPT4gY29sLl9jdXJyZW50ID4gMCk7CiAgICB9LAogICAgLy8g5ZCI5bm26IGK5aSp5LiO57O757uf5pel5b+X5Li65ZCM5LiA5L+h5oGv5rWB77yM5oyJ5pe26Ze05o6S5bqPCiAgICBjaGF0RmVlZCgpIHsKICAgICAgY29uc3QgbG9ncyA9ICh0aGlzLmdhbWVMb2cgfHwgW10pLm1hcCgobCwgaWR4KSA9PiAoewogICAgICAgIGlkOiBgbG9nLSR7bC50aW1lc3RhbXAgfHwgaWR4fWAsCiAgICAgICAgdHlwZTogJ2xvZycsCiAgICAgICAgdXNlcklkOiBudWxsLAogICAgICAgIHVzZXJuYW1lOiAn57O757ufJywKICAgICAgICBjb250ZW50OiBsLm1lc3NhZ2UsCiAgICAgICAgdGltZXN0YW1wOiBsLnRpbWVzdGFtcCB8fCAwCiAgICAgIH0pKTsKICAgICAgY29uc3QgY2hhdHMgPSAodGhpcy5jaGF0TWVzc2FnZXMgfHwgW10pLm1hcChtID0+ICh7CiAgICAgICAgLi4ubSwKICAgICAgICB0eXBlOiAnY2hhdCcKICAgICAgfSkpOwogICAgICBjb25zdCBtZXJnZWQgPSBbLi4ubG9ncywgLi4uY2hhdHNdOwogICAgICByZXR1cm4gbWVyZ2VkLnNvcnQoKGEsIGIpID0+IChhLnRpbWVzdGFtcCB8fCAwKSAtIChiLnRpbWVzdGFtcCB8fCAwKSk7CiAgICB9LAogICAgLy8g5pq06Zyy5a+56K+d6YWN572u5L6b5qih5p2/5L2/55SoCiAgICBmaXJzdExvZ2luQ29uZmlnKCkgewogICAgICByZXR1cm4gZmlyc3RMb2dpbkRpYWxvZ3VlQ29uZmlnOwogICAgfSwKICAgIC8vIOW9k+WJjeiusui/sOinkuiJsumFjee9ruS4juWQjeensAogICAgbmFycmF0aW9uQ2hhcmFjdGVyTmFtZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuZ2V0Q3VycmVudExhbmd1YWdlKCkgPT09ICd6aC1DTicgPyAn576O6YeMJyA6ICdNaXNhdG8nOwogICAgfSwKICAgIG5hcnJhdGlvbkNoYXJhY3RlcigpIHsKICAgICAgY29uc3Qga2V5ID0gdGhpcy5uYXJyYXRpb25DaGFyYWN0ZXJOYW1lOwogICAgICBjb25zdCBjaGFycyA9IGZpcnN0TG9naW5EaWFsb2d1ZUNvbmZpZyAmJiBmaXJzdExvZ2luRGlhbG9ndWVDb25maWcuY2hhcmFjdGVyczsKICAgICAgcmV0dXJuIGNoYXJzICYmIGNoYXJzW2tleV0gPyBjaGFyc1trZXldIDogewogICAgICAgIGltYWdlOiAnL2ltYWdlcy9ndWlkZS5wbmcnLAogICAgICAgIHBvc2l0aW9uOiAncmlnaHQnLAogICAgICAgIGNvbG9yOiAnIzNiODJmNicKICAgICAgfTsKICAgIH0KICB9LAogIGFzeW5jIG1vdW50ZWQoKSB7CiAgICBjb25zdCByb29tSWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5yb29tSWQ7CiAgICBpZiAocm9vbUlkKSB0aGlzLiRzdG9yZS5jb21taXQoJ1NFVF9ST09NX0lEJywgcm9vbUlkKTsKICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZUdhbWUoKTsKICAgIGF3YWl0IHRoaXMubG9hZFJvb21TdGF0ZSgpOwogICAgLy8g56uL5Y2z5Yid5aeL5YyW5paH54mp6L2u5pKt5pWw5o2u77yM56Gu5L+d5YeG5aSH6Zi25q615bCx5pyJ5YaF5a65CiAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVBcnRpZmFjdENhcm91c2VsKCk7CiAgICAvLyBsb2FkUm9vbVN0YXRlIOS4reW3sue7j+iwg+eUqOS6hiBsb2FkQWxsUGxheWVyc0FydGlmYWN0c++8jOi/memHjOehruS/neaVsOaNruWKoOi9vQogICAgYXdhaXQgdGhpcy5zdWJzY3JpYmVSb29tUmVhbHRpbWUoKTsKICAgIC8vIOWIneWni+WMlumfs+S5kOaSreaUvuWZqAogICAgdGhpcy5pbml0aWFsaXplTXVzaWMoKTsKICB9LAogIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLnVuc3Vic2NyaWJlUm9vbVJlYWx0aW1lKCk7CiAgICBpZiAodGhpcy5yZWZyZXNoVGltZXIpIHsKICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnJlZnJlc2hUaW1lcik7CiAgICAgIHRoaXMucmVmcmVzaFRpbWVyID0gbnVsbDsKICAgIH0KICAgIGlmICh0aGlzLmF1Y3Rpb25UaW1lcikgewogICAgICBjbGVhckludGVydmFsKHRoaXMuYXVjdGlvblRpbWVyKTsKICAgICAgdGhpcy5hdWN0aW9uVGltZXIgPSBudWxsOwogICAgfQogICAgaWYgKHRoaXMudHlwaW5nVGltZXIpIHsKICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnR5cGluZ1RpbWVyKTsKICAgICAgdGhpcy50eXBpbmdUaW1lciA9IG51bGw7CiAgICB9CiAgICBpZiAodGhpcy5jYXJvdXNlbEludGVydmFsKSB7CiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jYXJvdXNlbEludGVydmFsKTsKICAgICAgdGhpcy5jYXJvdXNlbEludGVydmFsID0gbnVsbDsKICAgIH0KICAgIC8vIOa4heeQhumfs+S5kOaSreaUvuWZqAogICAgdGhpcy5jbGVhbnVwTXVzaWMoKTsKICAgIHRoaXMuJHNldCh0aGlzLCAnYXVjdGlvbkNvdW50ZG93bicsIDApOwogIH0sCiAgd2F0Y2g6IHsKICAgIGdhbWVMb2coKSB7CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICBjb25zdCBjaGF0Q29udGFpbmVyID0gdGhpcy4kcmVmcy5jaGF0Q29udGFpbmVyOwogICAgICAgIGlmIChjaGF0Q29udGFpbmVyKSB7CiAgICAgICAgICBjaGF0Q29udGFpbmVyLnNjcm9sbFRvcCA9IGNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy8g55uR5ZCs5ri45oiP6Zi25q615Y+Y5YyW77yM5Zyo5YeG5aSH6Zi25q6156Gu5L+d6L2u5pKt5pWw5o2u5a2Y5ZyoCiAgICBnYW1lUGhhc2UobmV3UGhhc2UpIHsKICAgICAgaWYgKG5ld1BoYXNlID09PSAncHJlcGFyYXRpb24nKSB7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgLy8g5aaC5p6c6L2u5pKt5pWw5o2u5Li656m677yM6YeN5paw5Yid5aeL5YyWCiAgICAgICAgICBpZiAoIXRoaXMuYXJ0aWZhY3RDYXJvdXNlbERhdGEgfHwgdGhpcy5hcnRpZmFjdENhcm91c2VsRGF0YS5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplQXJ0aWZhY3RDYXJvdXNlbCgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8g5pWw5o2u5bey5a2Y5Zyo77yM5Y+q6ZyA56Gu5L+d6L2u5pKt5q2j5bi46L+Q6KGMCiAgICAgICAgICAgIHRoaXMuc3RhcnRBdXRvQ2Fyb3VzZWwoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyDnprvlvIDlh4blpIfpmLbmrrXml7blgZzmraLova7mkq0KICAgICAgICB0aGlzLnN0b3BBdXRvQ2Fyb3VzZWwoKTsKICAgICAgfQoKICAgICAgLy8g5qC55o2u5ri45oiP6Zi25q616LCD5pW06Z+z5LmQ5pKt5pS+CiAgICAgIHRoaXMuaGFuZGxlR2FtZVBoYXNlTXVzaWMobmV3UGhhc2UpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLy8g5Yid5aeL5YyW5paH54mp6L2u5pKt5pWw5o2u77yI5pS56L+b54mI77ya56Gu5L+d5oC75pyJ5YaF5a655pi+56S677yJCiAgICBhc3luYyBpbml0aWFsaXplQXJ0aWZhY3RDYXJvdXNlbCgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zb2xlLmxvZygn8J+nrSDlvIDlp4vliJ3lp4vljJbmlofnianova7mkq3mlbDmja4uLi4nKTsKCiAgICAgICAgLy8g5YWI5qOA5p+l5piv5ZCm5pyJ57yT5a2Y55qE6L2u5pKt5pWw5o2uCiAgICAgICAgaWYgKHRoaXMuYXJ0aWZhY3RDYXJvdXNlbERhdGEgJiYgdGhpcy5hcnRpZmFjdENhcm91c2VsRGF0YS5sZW5ndGggPiAwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn8J+TmiDkvb/nlKjnvJPlrZjova7mkq3mlbDmja4nKTsKICAgICAgICAgIHRoaXMuc3RhcnRBdXRvQ2Fyb3VzZWwoKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIOebtOaOpeS9v+eUqGFydGlmYWN0c+ihqOiOt+WPluaVsOaNrgogICAgICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2UoKTsKICAgICAgICBjb25zb2xlLmxvZygn8J+UlyDojrflj5ZTdXBhYmFzZeWunuS+izonLCBzdXBhYmFzZSA/ICfinIUg5oiQ5YqfJyA6ICfinYwg5aSx6LSlJyk7CiAgICAgICAgY29uc29sZS5sb2coJ/Cfk6Ug5q2j5Zyo5LuOYXJ0aWZhY3Rz6KGo6I635Y+W5pWw5o2uLi4uJyk7CiAgICAgICAgY29uc3QgewogICAgICAgICAgZGF0YTogYXJ0aWZhY3REYXRhLAogICAgICAgICAgZXJyb3I6IGFydGlmYWN0RXJyb3IKICAgICAgICB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbSgnYXJ0aWZhY3RzJykuc2VsZWN0KCdpZCwgbmFtZSwgZXJhLCBsb2NhdGlvbiwgaW1hZ2UsIGJhc2VfdmFsdWUnKS5saW1pdCgxMCk7IC8vIOiOt+WPljEw5Liq5paH54mp55So5LqO6L2u5pKtCgogICAgICAgIGNvbnNvbGUubG9nKCfwn5OKIOS7jmFydGlmYWN0c+ihqOiOt+WPluaVsOaNrue7k+aenDonLCB7CiAgICAgICAgICBkYXRhTGVuZ3RoOiBhcnRpZmFjdERhdGEgPyBhcnRpZmFjdERhdGEubGVuZ3RoIDogMCwKICAgICAgICAgIGVycm9yOiBhcnRpZmFjdEVycm9yLAogICAgICAgICAgZGF0YTogYXJ0aWZhY3REYXRhCiAgICAgICAgfSk7CiAgICAgICAgbGV0IGZpbmFsRGF0YSA9IFtdOwogICAgICAgIGlmIChhcnRpZmFjdEVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwg5LuOYXJ0aWZhY3Rz6KGo6I635Y+W5paH54mp5pWw5o2u5aSx6LSlOicsIGFydGlmYWN0RXJyb3IpOwogICAgICAgICAgY29uc29sZS5sb2coJ/CflIQg5L2/55So5qih5ouf5pWw5o2u5L2c5Li65aSH55SoLi4uJyk7CiAgICAgICAgICBmaW5hbERhdGEgPSB0aGlzLmdldE1vY2tBcnRpZmFjdERhdGEoKTsKICAgICAgICB9IGVsc2UgaWYgKGFydGlmYWN0RGF0YSAmJiBhcnRpZmFjdERhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgY29uc29sZS5sb2coJ+KchSDmiJDlip/ojrflj5bliLDmlofnianmlbDmja46JywgYXJ0aWZhY3REYXRhLmxlbmd0aCwgJ+adoScpOwogICAgICAgICAgLy8g5aSE55CG55yf5a6e5pWw5o2uCiAgICAgICAgICBmaW5hbERhdGEgPSBhcnRpZmFjdERhdGEubWFwKChpdGVtLCBpbmRleCkgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+TuCDlpITnkIbmlofniakgJHtpbmRleCArIDF9OmAsIGl0ZW0ubmFtZSwgJ+WOn+Wni+WbvueJh1VSTDonLCBpdGVtLmltYWdlKTsKCiAgICAgICAgICAgIC8vIOehruS/neWbvueJh1VSTOaYr+WujOaVtOeahFVSTAogICAgICAgICAgICBsZXQgaW1hZ2VVcmwgPSBpdGVtLmltYWdlOwogICAgICAgICAgICBpZiAoaW1hZ2VVcmwpIHsKICAgICAgICAgICAgICBpZiAoaW1hZ2VVcmwuc3RhcnRzV2l0aCgnLycpKSB7CiAgICAgICAgICAgICAgICAvLyDnm7jlr7not6/lvoTvvIzovazmjaLkuLrnu53lr7not6/lvoQKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIOi9rOaNouebuOWvuei3r+W+hOS4uue7neWvuei3r+W+hC4uLicpOwogICAgICAgICAgICAgICAgaWYgKGltYWdlVXJsLnN0YXJ0c1dpdGgoJy9zdGF0aWMvJykpIHsKICAgICAgICAgICAgICAgICAgLy8g6Z2Z5oCB6LWE5rqQ6Lev5b6E77yM5L2/55So6aG555uu5qC56Lev5b6ECiAgICAgICAgICAgICAgICAgIGltYWdlVXJsID0gd2luZG93LmxvY2F0aW9uLm9yaWdpbiArIGltYWdlVXJsOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgLy8g5YW25LuW55u45a+56Lev5b6E77yM5L2/55SoU3VwYWJhc2XlrZjlgqjot6/lvoQKICAgICAgICAgICAgICAgICAgaW1hZ2VVcmwgPSAnaHR0cHM6Ly90Z2t6cHl3dWtvcmN3ZHNiZnVidy5zdXBhYmFzZS5jbycgKyBpbWFnZVVybDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFpbWFnZVVybC5zdGFydHNXaXRoKCdodHRwJykpIHsKICAgICAgICAgICAgICAgIC8vIOWPr+iDveaYr+ebuOWvuei3r+W+hOS9hue8uuWwkeaWnOadoAogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ/CflIQg5aSE55CG5Y+v6IO957y65bCR5pac5p2g55qE6Lev5b6ELi4uJyk7CiAgICAgICAgICAgICAgICBpbWFnZVVybCA9ICdodHRwczovL3Rna3pweXd1a29yY3dkc2JmdWJ3LnN1cGFiYXNlLmNvL3N0b3JhZ2UvdjEvb2JqZWN0L3B1YmxpYy8nICsgaW1hZ2VVcmw7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IHByb2Nlc3NlZEl0ZW0gPSB7CiAgICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsCiAgICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lLAogICAgICAgICAgICAgIGVyYTogaXRlbS5lcmEsCiAgICAgICAgICAgICAgbG9jYXRpb246IGl0ZW0ubG9jYXRpb24sCiAgICAgICAgICAgICAgaW1hZ2U6IGltYWdlVXJsIHx8ICdodHRwczovL3ZpYS5wbGFjZWhvbGRlci5jb20vNDAweDMwMD90ZXh0PeaWh+eJqemihOiniCcsCiAgICAgICAgICAgICAgYmFzZVZhbHVlOiBpdGVtLmJhc2VfdmFsdWUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgY29uc29sZS5sb2coYOKchSDmlofniakgJHtpbmRleCArIDF9IOWkhOeQhuWujOaIkCAtIOacgOe7iOWbvueJh1VSTDpgLCBwcm9jZXNzZWRJdGVtLmltYWdlKTsKICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NlZEl0ZW07CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coJ/Cfk60gYXJ0aWZhY3Rz6KGo5Li656m677yM5L2/55So5qih5ouf5pWw5o2uJyk7CiAgICAgICAgICBmaW5hbERhdGEgPSB0aGlzLmdldE1vY2tBcnRpZmFjdERhdGEoKTsKICAgICAgICB9CgogICAgICAgIC8vIOehruS/neacgOe7iOaVsOaNruS4jeS4uuepugogICAgICAgIGlmIChmaW5hbERhdGEubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn4pqg77iPIOacgOe7iOaVsOaNruS4uuepuu+8jOS9v+eUqOWkh+eUqOaooeaLn+aVsOaNricpOwogICAgICAgICAgZmluYWxEYXRhID0gdGhpcy5nZXRNb2NrQXJ0aWZhY3REYXRhKCk7CiAgICAgICAgfQogICAgICAgIHRoaXMuYXJ0aWZhY3RDYXJvdXNlbERhdGEgPSBmaW5hbERhdGE7CiAgICAgICAgY29uc29sZS5sb2coJ/Cfjq8g5pyA57uI6L2u5pKt5pWw5o2uOicsIHRoaXMuYXJ0aWZhY3RDYXJvdXNlbERhdGEubGVuZ3RoLCAn5p2hJyk7CiAgICAgICAgY29uc29sZS5sb2coJ/CflIQg5byA5aeL6Ieq5Yqo6L2u5pKtLi4uJyk7CgogICAgICAgIC8vIOW8gOWni+iHquWKqOi9ruaSrQogICAgICAgIHRoaXMuc3RhcnRBdXRvQ2Fyb3VzZWwoKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfwn5KlIOWIneWni+WMluaWh+eJqei9ruaSreWksei0pTonLCBlcnJvcik7CiAgICAgICAgY29uc29sZS5sb2coJ/CflIQg5L2/55So5qih5ouf5pWw5o2u5L2c5Li65pyA57uI5aSH55SoLi4uJyk7CiAgICAgICAgLy8g56Gu5L+d5Y2z5L2/5Ye66ZSZ5Lmf5pyJ5pWw5o2u5bGV56S6CiAgICAgICAgdGhpcy5hcnRpZmFjdENhcm91c2VsRGF0YSA9IHRoaXMuZ2V0TW9ja0FydGlmYWN0RGF0YSgpOwogICAgICAgIHRoaXMuc3RhcnRBdXRvQ2Fyb3VzZWwoKTsKICAgICAgfQogICAgfSwKICAgIC8vIOiOt+WPluaooeaLn+aWh+eJqeaVsOaNru+8iOWkh+eUqOaWueahiO+8iQogICAgZ2V0TW9ja0FydGlmYWN0RGF0YSgpIHsKICAgICAgcmV0dXJuIFt7CiAgICAgICAgaWQ6ICdhcnRpZmFjdF8wMDEnLAogICAgICAgIG5hbWU6ICfllJDku6Pnp5joibLnk7cnLAogICAgICAgIGVyYTogJ+WUkOS7oycsCiAgICAgICAgbG9jYXRpb246ICfkuK3lm70nLAogICAgICAgIGltYWdlOiAnaHR0cHM6Ly92aWEucGxhY2Vob2xkZXIuY29tLzQwMHgzMDAvZjBmMGYwLzY2NjY2Nj90ZXh0PeWUkOS7o+enmOiJsueTtycsCiAgICAgICAgYmFzZVZhbHVlOiA4CiAgICAgIH0sIHsKICAgICAgICBpZDogJ2FydGlmYWN0XzAwMicsCiAgICAgICAgbmFtZTogJ+i+vuiKrOWlh+Wlh+iuvuWbvicsCiAgICAgICAgZXJhOiAn5paH6Im65aSN5YW0JywKICAgICAgICBsb2NhdGlvbjogJ+aEj+Wkp+WIqScsCiAgICAgICAgaW1hZ2U6ICdodHRwczovL3ZpYS5wbGFjZWhvbGRlci5jb20vNDAweDMwMC9mMGYwZjAvNjY2NjY2P3RleHQ96L6+6Iqs5aWH5aWH6K6+5Zu+JywKICAgICAgICBiYXNlVmFsdWU6IDkKICAgICAgfSwgewogICAgICAgIGlkOiAnYXJ0aWZhY3RfMDAzJywKICAgICAgICBuYW1lOiAn55Cl54+A5YyW55+zJywKICAgICAgICBlcmE6ICflj7LliY0nLAogICAgICAgIGxvY2F0aW9uOiAn5rOi572X55qE5rW3JywKICAgICAgICBpbWFnZTogJ2h0dHBzOi8vdmlhLnBsYWNlaG9sZGVyLmNvbS80MDB4MzAwL2YwZjBmMC82NjY2NjY/dGV4dD3nkKXnj4DljJbnn7MnLAogICAgICAgIGJhc2VWYWx1ZTogNgogICAgICB9LCB7CiAgICAgICAgaWQ6ICdhcnRpZmFjdF8wMDQnLAogICAgICAgIG5hbWU6ICfnu7TkuqzpvpnlpLToiLknLAogICAgICAgIGVyYTogJ+e7tOS6rOaXtuS7oycsCiAgICAgICAgbG9jYXRpb246ICfljJfmrKcnLAogICAgICAgIGltYWdlOiAnaHR0cHM6Ly92aWEucGxhY2Vob2xkZXIuY29tLzQwMHgzMDAvZjBmMGYwLzY2NjY2Nj90ZXh0Pee7tOS6rOm+meWktOiIuScsCiAgICAgICAgYmFzZVZhbHVlOiA3CiAgICAgIH0sIHsKICAgICAgICBpZDogJ2FydGlmYWN0XzAwNScsCiAgICAgICAgbmFtZTogJ+aYn+ebmOS7qicsCiAgICAgICAgZXJhOiAn5Lit5LiW57qqJywKICAgICAgICBsb2NhdGlvbjogJ+mYv+aLieS8rycsCiAgICAgICAgaW1hZ2U6ICdodHRwczovL3ZpYS5wbGFjZWhvbGRlci5jb20vNDAweDMwMC9mMGYwZjAvNjY2NjY2P3RleHQ95pif55uY5LuqJywKICAgICAgICBiYXNlVmFsdWU6IDcKICAgICAgfV07CiAgICB9LAogICAgLy8g5byA5aeL6Ieq5Yqo6L2u5pKtCiAgICBzdGFydEF1dG9DYXJvdXNlbCgpIHsKICAgICAgaWYgKHRoaXMuY2Fyb3VzZWxJbnRlcnZhbCkgewogICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jYXJvdXNlbEludGVydmFsKTsKICAgICAgfQoKICAgICAgLy8g56Gu5L+d5pyJ5pWw5o2u5omN5byA5ZCv6L2u5pKtCiAgICAgIGlmICghdGhpcy5hcnRpZmFjdENhcm91c2VsRGF0YSB8fCB0aGlzLmFydGlmYWN0Q2Fyb3VzZWxEYXRhLmxlbmd0aCA9PT0gMCkgewogICAgICAgIGNvbnNvbGUubG9nKCfimqDvuI8g6L2u5pKt5pWw5o2u5Li656m677yM5LiN5ZCv5Yqo6Ieq5Yqo6L2u5pKtJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuY2Fyb3VzZWxJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgICB0aGlzLm5leHRTbGlkZSgpOwogICAgICB9LCAzMDAwKTsgLy8g5q+PM+enkuiHquWKqOWIh+aNogogICAgfSwKICAgIC8vIOWBnOatouiHquWKqOi9ruaSrQogICAgc3RvcEF1dG9DYXJvdXNlbCgpIHsKICAgICAgaWYgKHRoaXMuY2Fyb3VzZWxJbnRlcnZhbCkgewogICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jYXJvdXNlbEludGVydmFsKTsKICAgICAgICB0aGlzLmNhcm91c2VsSW50ZXJ2YWwgPSBudWxsOwogICAgICB9CiAgICB9LAogICAgLy8g5LiL5LiA5byg5bm754Gv54mHCiAgICBuZXh0U2xpZGUoKSB7CiAgICAgIGlmICh0aGlzLmFydGlmYWN0Q2Fyb3VzZWxEYXRhICYmIHRoaXMuYXJ0aWZhY3RDYXJvdXNlbERhdGEubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMuY3VycmVudFNsaWRlID0gKHRoaXMuY3VycmVudFNsaWRlICsgMSkgJSB0aGlzLmFydGlmYWN0Q2Fyb3VzZWxEYXRhLmxlbmd0aDsKICAgICAgfQogICAgfSwKICAgIC8vIOS4iuS4gOW8oOW5u+eBr+eJhwogICAgcHJldlNsaWRlKCkgewogICAgICBpZiAodGhpcy5hcnRpZmFjdENhcm91c2VsRGF0YSAmJiB0aGlzLmFydGlmYWN0Q2Fyb3VzZWxEYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLmN1cnJlbnRTbGlkZSA9ICh0aGlzLmN1cnJlbnRTbGlkZSAtIDEgKyB0aGlzLmFydGlmYWN0Q2Fyb3VzZWxEYXRhLmxlbmd0aCkgJSB0aGlzLmFydGlmYWN0Q2Fyb3VzZWxEYXRhLmxlbmd0aDsKICAgICAgfQogICAgfSwKICAgIC8vIOi3s+i9rOWIsOaMh+WumuW5u+eBr+eJhwogICAgZ29Ub1NsaWRlKGluZGV4KSB7CiAgICAgIGlmICh0aGlzLmFydGlmYWN0Q2Fyb3VzZWxEYXRhICYmIGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLmFydGlmYWN0Q2Fyb3VzZWxEYXRhLmxlbmd0aCkgewogICAgICAgIHRoaXMuY3VycmVudFNsaWRlID0gaW5kZXg7CiAgICAgIH0KICAgIH0sCiAgICAvLyDlpITnkIblm77niYfliqDovb3plJnor68KICAgIGhhbmRsZUltYWdlRXJyb3IoYXJ0aWZhY3QpIHsKICAgICAgY29uc29sZS53YXJuKGDmlofnianlm77niYfliqDovb3lpLHotKU6ICR7YXJ0aWZhY3QubmFtZX1gKTsKICAgICAgLy8g5Y+v5Lul6K6+572u6buY6K6k5Zu+54mH5oiW5L2/55So5Y2g5L2N56ymCiAgICAgIGFydGlmYWN0LmltYWdlID0gJ2h0dHBzOi8vdmlhLnBsYWNlaG9sZGVyLmNvbS80MDB4MzAwP3RleHQ95paH54mp6aKE6KeIJzsKICAgIH0sCiAgICAvLyDljrvmjonmqKHmi5/liJ3lp4vljJbnjqnlrrbvvIzmlLnkuLrkvb/nlKjmiL/pl7TnmoTlrp7pmYXnjqnlrrbliJfooagKICAgIGFzeW5jIGluaXRpYWxpemVHYW1lKCkgewogICAgICBjb25zdCBhcnRpZmFjdHMgPSBhd2FpdCB0aGlzLmxvYWRBcnRpZmFjdHMoKTsKICAgICAgdGhpcy5hcnRpZmFjdE1hcCA9IGFydGlmYWN0cy5yZWR1Y2UoKGFjYywgYSkgPT4gewogICAgICAgIGFjY1thLmlkXSA9IGE7CiAgICAgICAgcmV0dXJuIGFjYzsKICAgICAgfSwge30pOwogICAgICBhd2FpdCB0aGlzLmxvYWRDb2xsZWN0aW9ucygpOwogICAgfSwKICAgIGFzeW5jIHN1YnNjcmliZVJvb21SZWFsdGltZSgpIHsKICAgICAgY29uc3QgcmlkID0gdGhpcy4kc3RvcmUuc3RhdGUucm9vbUlkOwogICAgICBpZiAoIXJpZCkgcmV0dXJuOwogICAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlKCk7CiAgICAgIGNvbnN0IHsKICAgICAgICByb29tQ2hhbm5lbCwKICAgICAgICBicm9hZGNhc3RDaGFubmVsCiAgICAgIH0gPSBzdWJzY3JpYmVSb29tUmVhbHRpbWVTZXJ2aWNlKHsKICAgICAgICByb29tSWQ6IHJpZCwKICAgICAgICBzdXBhYmFzZSwKICAgICAgICBvbkxvYWRSb29tU3RhdGU6IHRoaXMubG9hZFJvb21TdGF0ZQogICAgICB9LCB7CiAgICAgICAgb25HYW1lU3RhcnRlZDogYXN5bmMgX3BheWxvYWQgPT4gewogICAgICAgICAgLy8g6Ziy5q2i6YeN5aSN5ZCv5Yqo5aSa5Liq5YCS6K6h5pe2CiAgICAgICAgICBpZiAodGhpcy5jb3VudGRvd25JblByb2dyZXNzKSByZXR1cm47CiAgICAgICAgICB0aGlzLmNvdW50ZG93bkluUHJvZ3Jlc3MgPSB0cnVlOwoKICAgICAgICAgIC8vIOaWsOWxgOW8gOWni++8mumHjee9ruiBiuWkqea2iOaBr+WSjOS7t+WAvOaVsOaNrgogICAgICAgICAgdGhpcy5jaGF0TWVzc2FnZXMgPSBbXTsKICAgICAgICAgIHRoaXMuYWxsUGxheWVyc0FydGlmYWN0cyA9IHt9OwogICAgICAgICAgLy8g6YeN572u5Zue5ZCI5pWwCiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ1JFU0VUX1JPVU5EJyk7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ1NFVF9ST1VORF9UT1RBTCcsIDYpOwogICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdTRVRfR0FNRV9QSEFTRScsICdjb3VudGRvd24nKTsKICAgICAgICAgIHRoaXMuJHNldCh0aGlzLCAnYXVjdGlvbkNvdW50ZG93bicsIDUpOwogICAgICAgICAgY29uc3QgbWUgPSAodGhpcy5yb29tICYmIHRoaXMucm9vbS5yb29tX3BsYXllcnMgPyB0aGlzLnJvb20ucm9vbV9wbGF5ZXJzIDogW10pLmZpbmQocCA9PiBwLnVzZXJfaWQgPT09IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuaWQpOwogICAgICAgICAgaWYgKG1lKSB7CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnU0VUX0NVUlJFTlRfUExBWUVSJywgewogICAgICAgICAgICAgIGlkOiBtZS51c2VyX2lkLAogICAgICAgICAgICAgIG5hbWU6IHRoaXMuZ2V0TmFtZUZvcihtZS51c2VyX2lkKSwKICAgICAgICAgICAgICBlbmVyZ3k6IDUwLAogICAgICAgICAgICAgIGFydGlmYWN0czogW10sCiAgICAgICAgICAgICAgaXRlbXM6IFtdCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHRoaXMuYXVjdGlvblRpbWVyKSB7CiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5hdWN0aW9uVGltZXIpOwogICAgICAgICAgICB0aGlzLmF1Y3Rpb25UaW1lciA9IG51bGw7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgIHN0YXJ0Q291bnRkb3duKHsKICAgICAgICAgICAgICBzZWNvbmRzOiA1LAogICAgICAgICAgICAgIG9uVGljazogcyA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLiRzZXQodGhpcywgJ2F1Y3Rpb25Db3VudGRvd24nLCBzKTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIG9uRG9uZTogYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5jb3VudGRvd25JblByb2dyZXNzID0gZmFsc2U7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc093bmVyKSB7CiAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXV0b1N0YXJ0QXVjdGlvbigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZ2V0UmVmOiAoKSA9PiB0aGlzLmF1Y3Rpb25UaW1lciwKICAgICAgICAgICAgICBzZXRSZWY6IGlkID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuYXVjdGlvblRpbWVyID0gaWQ7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgb25BdWN0aW9uU3RhcnRlZDogYXN5bmMgKGR1cmF0aW9uLCBwYXlsb2FkKSA9PiB7CiAgICAgICAgICAvLyDnoa7kv53miYDmnInnjqnlrrbpg73og73nnIvliLDmi43ljZbmlbDmja4KICAgICAgICAgIGF3YWl0IHRoaXMubG9hZFJvb21TdGF0ZSgpOwoKICAgICAgICAgIC8vIOWQjOatpeWbnuWQiOaVsO+8iOWmguaenOW5v+aSreS4reWMheWQq+S6huWbnuWQiOS/oeaBr++8iQogICAgICAgICAgaWYgKHBheWxvYWQgJiYgdHlwZW9mIHBheWxvYWQucm91bmRDdXJyZW50ID09PSAnbnVtYmVyJykgewogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ1NFVF9ST1VORF9DVVJSRU5UJywgcGF5bG9hZC5yb3VuZEN1cnJlbnQpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHBheWxvYWQgJiYgdHlwZW9mIHBheWxvYWQucm91bmRUb3RhbCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdTRVRfUk9VTkRfVE9UQUwnLCBwYXlsb2FkLnJvdW5kVG90YWwpOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5zdGFydEF1Y3Rpb25UaW1lcihkdXJhdGlvbik7CiAgICAgICAgfSwKICAgICAgICBvbkJpZFVwZGF0ZTogKHsKICAgICAgICAgIGF1Y3Rpb25JZCwKICAgICAgICAgIGhpZ2hlc3RCaWQsCiAgICAgICAgICBoaWdoZXN0QmlkZGVyCiAgICAgICAgfSkgPT4gewogICAgICAgICAgaWYgKCFhdWN0aW9uSWQpIHJldHVybjsKICAgICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLiRzdG9yZS5zdGF0ZS5jdXJyZW50QXVjdGlvbnMgfHwgW107CiAgICAgICAgICBjb25zdCBpZHggPSBsaXN0LmZpbmRJbmRleChhID0+IGEuaWQgPT09IGF1Y3Rpb25JZCk7CiAgICAgICAgICBpZiAoaWR4ID49IDApIHsKICAgICAgICAgICAgY29uc3QgbmV4dCA9IHsKICAgICAgICAgICAgICAuLi5saXN0W2lkeF0sCiAgICAgICAgICAgICAgaGlnaGVzdEJpZCwKICAgICAgICAgICAgICBoaWdoZXN0QmlkZGVyCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnQUREX09SX1VQREFURV9BVUNUSU9OJywgbmV4dCk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAvLyDml6flm57lkIjlub/mkq3lt7Lnp7vpmaTvvIznu5/kuIDmnKzlnLDmjqjov5vvvIzkuI3lho3mjqXmlLbor6Xkuovku7YKICAgICAgICBvblJvdW5kVXBkYXRlZDogX2RhdGEgPT4ge30sCiAgICAgICAgb25HYW1lRW5kZWQ6ICgpID0+IHsKICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnU0VUX0dBTUVfUEhBU0UnLCAnc2V0dGxlbWVudCcpOwogICAgICAgICAgdGhpcy5jb21wdXRlRmluYWxTY29yZXMoKS5maW5hbGx5KCgpID0+IHsKICAgICAgICAgICAgdGhpcy5zaG93R2FtZUVuZERpYWxvZyA9IHRydWU7CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmICh0aGlzLmF1Y3Rpb25UaW1lcikgewogICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuYXVjdGlvblRpbWVyKTsKICAgICAgICAgICAgdGhpcy5hdWN0aW9uVGltZXIgPSBudWxsOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgb25BdWN0aW9uRW5kZWQ6IGFzeW5jICgpID0+IHsKICAgICAgICAgIGF3YWl0IHRoaXMubG9hZFJvb21TdGF0ZSgpOwogICAgICAgIH0sCiAgICAgICAgb25DaGF0TWVzc2FnZTogbWVzc2FnZSA9PiB7CiAgICAgICAgICAvLyDpgb/lhY3ph43lpI3mt7vliqDmtojmga8KICAgICAgICAgIGlmICghbWVzc2FnZSB8fCAhbWVzc2FnZS5pZCkgcmV0dXJuOwogICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSB0aGlzLmNoYXRNZXNzYWdlcy5maW5kKG0gPT4gbS5pZCA9PT0gbWVzc2FnZS5pZCB8fCBtLnVzZXJJZCA9PT0gbWVzc2FnZS51c2VySWQgJiYgbS50aW1lc3RhbXAgPT09IG1lc3NhZ2UudGltZXN0YW1wICYmIG0uY29udGVudCA9PT0gbWVzc2FnZS5jb250ZW50KTsKICAgICAgICAgIGlmIChleGlzdGluZykgcmV0dXJuOwogICAgICAgICAgdGhpcy5jaGF0TWVzc2FnZXMucHVzaChtZXNzYWdlKTsKICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgICAgY29uc3QgY2hhdENvbnRhaW5lciA9IHRoaXMuJHJlZnMuY2hhdENvbnRhaW5lcjsKICAgICAgICAgICAgaWYgKGNoYXRDb250YWluZXIpIHsKICAgICAgICAgICAgICBjaGF0Q29udGFpbmVyLnNjcm9sbFRvcCA9IGNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0OwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sICgpID0+IHsKICAgICAgICBpZiAoIXRoaXMucmVmcmVzaFRpbWVyKSB7CiAgICAgICAgICB0aGlzLnJlZnJlc2hUaW1lciA9IHNldEludGVydmFsKHRoaXMubG9hZFJvb21TdGF0ZSwgMTAwMCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5yb29tQ2hhbm5lbCA9IHJvb21DaGFubmVsOwogICAgICB0aGlzLmJyb2FkY2FzdENoYW5uZWwgPSBicm9hZGNhc3RDaGFubmVsOwogICAgfSwKICAgIHVuc3Vic2NyaWJlUm9vbVJlYWx0aW1lKCkgewogICAgICB1bnN1YnNjcmliZVJvb21SZWFsdGltZVNlcnZpY2UodGhpcy5yb29tQ2hhbm5lbCwgdGhpcy5icm9hZGNhc3RDaGFubmVsKTsKICAgICAgdGhpcy5yb29tQ2hhbm5lbCA9IG51bGw7CiAgICAgIHRoaXMuYnJvYWRjYXN0Q2hhbm5lbCA9IG51bGw7CiAgICB9LAogICAgYXN5bmMgbG9hZFJvb21TdGF0ZSgpIHsKICAgICAgY29uc3QgcmlkID0gdGhpcy4kc3RvcmUuc3RhdGUucm9vbUlkOwogICAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlKCk7CiAgICAgIGF3YWl0IGxvYWRSb29tU3RhdGVTZXJ2aWNlKHsKICAgICAgICByb29tSWQ6IHJpZCwKICAgICAgICByb29tU2VydmljZSwKICAgICAgICBzdXBhYmFzZSwKICAgICAgICBhcnRpZmFjdE1hcDogdGhpcy5hcnRpZmFjdE1hcCwKICAgICAgICBzdG9yZTogdGhpcy4kc3RvcmUsCiAgICAgICAgc2V0Um9vbTogcm9vbSA9PiB7CiAgICAgICAgICB0aGlzLnJvb20gPSByb29tOwogICAgICAgIH0sCiAgICAgICAgc2V0UHJvZmlsZU1hcDogbWFwID0+IHsKICAgICAgICAgIHRoaXMucHJvZmlsZU1hcCA9IG1hcDsKICAgICAgICB9LAogICAgICAgIHNldEdhbWVQaGFzZTogcGhhc2UgPT4gewogICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdTRVRfR0FNRV9QSEFTRScsIHBoYXNlKTsKICAgICAgICB9LAogICAgICAgIGNsZWFyQXVjdGlvblRpbWVyOiAoKSA9PiB7CiAgICAgICAgICBpZiAodGhpcy5hdWN0aW9uVGltZXIpIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmF1Y3Rpb25UaW1lcik7CiAgICAgICAgICAgIHRoaXMuYXVjdGlvblRpbWVyID0gbnVsbDsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHNldEF1Y3Rpb25Db3VudGRvd246IG4gPT4gewogICAgICAgICAgdGhpcy4kc2V0KHRoaXMsICdhdWN0aW9uQ291bnRkb3duJywgbik7CiAgICAgICAgfSwKICAgICAgICBvblNob3dHYW1lRW5kOiAoKSA9PiB7CiAgICAgICAgICB0aGlzLnNob3dHYW1lRW5kRGlhbG9nID0gdHJ1ZTsKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICB0aGlzLmhhbmRsZUdhbWVFbmQoKTsKICAgICAgICAgIH0sIDMwMDApOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIC8vIOWKoOi9veaJgOacieeOqeWutueahOaJi+eJjOaVsOaNru+8jOeUqOS6juS7t+WAvOiuoeeulwogICAgICBhd2FpdCB0aGlzLmxvYWRBbGxQbGF5ZXJzQXJ0aWZhY3RzKCk7CiAgICAgIC8vIOWmguaenOWIt+aWsOWQjuWPkeeOsOS7jeaciea0u+i3g+aLjeWNlu+8jOS9huacrOWcsOaXoOWAkuiuoeaXtu+8jOWImeeUqOW9k+WJjeWJqeS9meaXtumXtOWQr+WKqOe7n+S4gOWAkuiuoeaXtgogICAgICBjb25zdCBhdWN0aW9ucyA9IHRoaXMuJHN0b3JlLnN0YXRlLmN1cnJlbnRBdWN0aW9ucyB8fCBbXTsKICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLmdhbWVQaGFzZSA9PT0gJ2F1Y3Rpb24nICYmIGF1Y3Rpb25zLmxlbmd0aCA+IDApIHsKICAgICAgICBjb25zdCByZW1haW5pbmcgPSBOdW1iZXIodGhpcy5hdWN0aW9uQ291bnRkb3duIHx8IDApOwogICAgICAgIGlmICghdGhpcy5hdWN0aW9uVGltZXIgJiYgcmVtYWluaW5nID4gMCkgewogICAgICAgICAgc3RhcnRDb3VudGRvd24oewogICAgICAgICAgICBzZWNvbmRzOiByZW1haW5pbmcsCiAgICAgICAgICAgIG9uVGljazogcyA9PiB7CiAgICAgICAgICAgICAgdGhpcy4kc2V0KHRoaXMsICdhdWN0aW9uQ291bnRkb3duJywgcyk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uRG9uZTogYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgIGF3YWl0IHRoaXMub25BdWN0aW9uVGltZVVwKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGdldFJlZjogKCkgPT4gdGhpcy5hdWN0aW9uVGltZXIsCiAgICAgICAgICAgIHNldFJlZjogaWQgPT4gewogICAgICAgICAgICAgIHRoaXMuYXVjdGlvblRpbWVyID0gaWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOWKoOi9veaJgOacieeOqeWutueahOaJi+eJjOaVsOaNrgogICAgYXN5bmMgbG9hZEFsbFBsYXllcnNBcnRpZmFjdHMoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmlkID0gdGhpcy4kc3RvcmUuc3RhdGUucm9vbUlkOwogICAgICAgIGlmICghcmlkKSB7CiAgICAgICAgICB0aGlzLmFsbFBsYXllcnNBcnRpZmFjdHMgPSB7fTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpOwogICAgICAgIC8vIOiOt+WPluaIv+mXtOWGheaJgOacieeOqeWutueahOaJi+eJjOaVsOaNrgogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGRhdGE6IGFsbEFydGlmYWN0cwogICAgICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5mcm9tKCdyb29tX2FydGlmYWN0cycpLnNlbGVjdCgnb3duZXJfdXNlcl9pZCwgYXJ0aWZhY3RfaWQnKS5lcSgncm9vbV9pZCcsIHJpZCk7CgogICAgICAgIC8vIOaMieeOqeWutklE5YiG57uECiAgICAgICAgY29uc3QgcGxheWVyQXJ0aWZhY3RzTWFwID0ge307CiAgICAgICAgaWYgKGFsbEFydGlmYWN0cyAmJiBhbGxBcnRpZmFjdHMubGVuZ3RoID4gMCkgewogICAgICAgICAgYWxsQXJ0aWZhY3RzLmZvckVhY2gocm93ID0+IHsKICAgICAgICAgICAgY29uc3QgdXNlcklkID0gcm93Lm93bmVyX3VzZXJfaWQ7CiAgICAgICAgICAgIGlmICghcGxheWVyQXJ0aWZhY3RzTWFwW3VzZXJJZF0pIHsKICAgICAgICAgICAgICBwbGF5ZXJBcnRpZmFjdHNNYXBbdXNlcklkXSA9IFtdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHBsYXllckFydGlmYWN0c01hcFt1c2VySWRdLnB1c2gocm93LmFydGlmYWN0X2lkKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLy8g5L2/55SoIFZ1ZS5zZXQg56Gu5L+d5ZON5bqU5byP5pu05pawCiAgICAgICAgdGhpcy4kc2V0KHRoaXMsICdhbGxQbGF5ZXJzQXJ0aWZhY3RzJywgcGxheWVyQXJ0aWZhY3RzTWFwKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUud2FybignW2dhbWVdIGxvYWRBbGxQbGF5ZXJzQXJ0aWZhY3RzIGZhaWxlZCcsIGUpOwogICAgICAgIHRoaXMuYWxsUGxheWVyc0FydGlmYWN0cyA9IHt9OwogICAgICB9CiAgICB9LAogICAgYXN5bmMgdG9nZ2xlUmVhZHkoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmlkID0gdGhpcy4kc3RvcmUuc3RhdGUucm9vbUlkOwogICAgICAgIGNvbnN0IHVpZCA9IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIgJiYgdGhpcy4kc3RvcmUuc3RhdGUudXNlci5pZDsKICAgICAgICBpZiAoIXJpZCB8fCAhdWlkKSByZXR1cm47CiAgICAgICAgYXdhaXQgdG9nZ2xlUmVhZHlBY3Rpb24oewogICAgICAgICAgcm9vbUlkOiByaWQsCiAgICAgICAgICB1c2VySWQ6IHVpZCwKICAgICAgICAgIHJvb206IHRoaXMucm9vbSwKICAgICAgICAgIHJvb21TZXJ2aWNlLAogICAgICAgICAgcmVsb2FkOiB0aGlzLmxvYWRSb29tU3RhdGUKICAgICAgICB9KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUud2FybignW2dhbWVdIHRvZ2dsZVJlYWR5IGZhaWxlZCcsIGUpOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgbW92ZVRvU2VhdChpZHgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByaWQgPSB0aGlzLiRzdG9yZS5zdGF0ZS5yb29tSWQ7CiAgICAgICAgY29uc3QgdWlkID0gdGhpcy4kc3RvcmUuc3RhdGUudXNlciAmJiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmlkOwogICAgICAgIGlmICghcmlkIHx8ICF1aWQpIHJldHVybjsKICAgICAgICBjb25zdCB0YXJnZXRTZWF0ID0gewogICAgICAgICAgaW5kZXg6IGlkeCwKICAgICAgICAgIHBsYXllcjogdGhpcy5zZWF0c1tpZHhdICYmIHRoaXMuc2VhdHNbaWR4XS5wbGF5ZXIKICAgICAgICB9OwogICAgICAgIGF3YWl0IG1vdmVUb1NlYXRBY3Rpb24oewogICAgICAgICAgcm9vbUlkOiByaWQsCiAgICAgICAgICB1c2VySWQ6IHVpZCwKICAgICAgICAgIHJvb206IHRoaXMucm9vbSwKICAgICAgICAgIHNlYXRzOiB0YXJnZXRTZWF0LAogICAgICAgICAgcm9vbVNlcnZpY2UsCiAgICAgICAgICByZWxvYWQ6IHRoaXMubG9hZFJvb21TdGF0ZQogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS53YXJuKCdbZ2FtZV0gbW92ZVRvU2VhdCBmYWlsZWQnLCBlKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGxlYXZlUm9vbSgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByaWQgPSB0aGlzLiRzdG9yZS5zdGF0ZS5yb29tSWQ7CiAgICAgICAgY29uc3QgdWlkID0gdGhpcy4kc3RvcmUuc3RhdGUudXNlciAmJiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmlkOwogICAgICAgIGlmICghcmlkIHx8ICF1aWQpIHJldHVybjsKICAgICAgICBhd2FpdCBsZWF2ZVJvb21BY3Rpb24oewogICAgICAgICAgcm9vbUlkOiByaWQsCiAgICAgICAgICB1c2VySWQ6IHVpZCwKICAgICAgICAgIGNsZWFyQXVjdGlvblRpbWVyOiAoKSA9PiB7CiAgICAgICAgICAgIGlmICh0aGlzLmF1Y3Rpb25UaW1lcikgewogICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5hdWN0aW9uVGltZXIpOwogICAgICAgICAgICAgIHRoaXMuYXVjdGlvblRpbWVyID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHNldENvdW50ZG93bjogbiA9PiB7CiAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLCAnYXVjdGlvbkNvdW50ZG93bicsIG4pOwogICAgICAgICAgfSwKICAgICAgICAgIHN0b3JlOiB0aGlzLiRzdG9yZSwKICAgICAgICAgIGF1Y3Rpb25TZXJ2aWNlLAogICAgICAgICAgcm9vbVNlcnZpY2UsCiAgICAgICAgICB1bnN1YnNjcmliZTogKCkgPT4gdGhpcy51bnN1YnNjcmliZVJvb21SZWFsdGltZSgpLAogICAgICAgICAgc2V0Um9vbUlkOiB2ID0+IHRoaXMuJHN0b3JlLmNvbW1pdCgnU0VUX1JPT01fSUQnLCB2KSwKICAgICAgICAgIHNldExvY2FsUm9vbTogdiA9PiB7CiAgICAgICAgICAgIHRoaXMucm9vbSA9IHY7CiAgICAgICAgICB9LAogICAgICAgICAgbmF2aWdhdGVUb1Jvb21zOiAoKSA9PiB0aGlzLiRyb3V0ZXIucHVzaCgnL3Jvb21zJykKICAgICAgICB9KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUud2FybignW2dhbWVdIGxlYXZlUm9vbSBmYWlsZWQnLCBlKTsKICAgICAgfQogICAgfSwKICAgIC8vIOa4uOaIj+e7k+adn+WkhOeQhgogICAgYXN5bmMgaGFuZGxlR2FtZUVuZCgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByaWQgPSB0aGlzLiRzdG9yZS5zdGF0ZS5yb29tSWQ7CiAgICAgICAgaWYgKHJpZCkgewogICAgICAgICAgLy8g5bCG5oi/6Ze054q25oCB6YeN572u5Li6IHdhaXRpbmfvvIzkvr/kuo7nu6fnu63miL/pl7TlhoXlh4blpIcv5paw5LiA5bGACiAgICAgICAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlKCk7CiAgICAgICAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKCdyb29tcycpLnVwZGF0ZSh7CiAgICAgICAgICAgIHN0YXR1czogJ3dhaXRpbmcnCiAgICAgICAgICB9KS5lcSgnaWQnLCByaWQpOwogICAgICAgICAgLy8g6Lez6L2s5Zue5oi/6Ze06aG16Z2i77yI5ri45oiP6aG15pC65bimIHJvb21JZCDljbPmmK/miL/pl7TnlYzpnaLvvIkKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgcGF0aDogJy9nYW1lJywKICAgICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgICByb29tSWQ6IHJpZCwKICAgICAgICAgICAgICBnYW1lRW5kZWQ6ICd0cnVlJwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9yb29tcycpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUud2FybignW2dhbWVdIGhhbmRsZUdhbWVFbmQgZmFpbGVkJywgZSk7CiAgICAgICAgLy8g5YWc5bqV6Lez5Zue5oi/6Ze05YiX6KGoCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9yb29tcycpOwogICAgICB9CiAgICB9LAogICAgLy8g6Z+z5LmQ5o6n5Yi255u45YWz5pa55rOVCiAgICBpbml0aWFsaXplTXVzaWMoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgLy8g5Yib5bu66Z+z6aKR5YWD57SgCiAgICAgICAgdGhpcy5hdWRpb0VsZW1lbnQgPSBuZXcgQXVkaW8oJy9pbWFnZXMvYmdtLm1wMycpOwogICAgICAgIHRoaXMuYXVkaW9FbGVtZW50Lmxvb3AgPSB0cnVlOwogICAgICAgIHRoaXMuYXVkaW9FbGVtZW50LnZvbHVtZSA9IHRoaXMubXVzaWNWb2x1bWU7CgogICAgICAgIC8vIOebkeWQrOmfs+mikeaSreaUvueKtuaAgQogICAgICAgIHRoaXMuYXVkaW9FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZGRhdGEnLCAoKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZygn8J+OtSDog4zmma/pn7PkuZDliqDovb3lrozmiJAnKTsKICAgICAgICB9KTsKICAgICAgICB0aGlzLmF1ZGlvRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGUgPT4gewogICAgICAgICAgY29uc29sZS5lcnJvcign8J+OtSDog4zmma/pn7PkuZDliqDovb3lpLHotKU6JywgZSk7CiAgICAgICAgfSk7CgogICAgICAgIC8vIOWwneivleiHquWKqOaSreaUvu+8iOmcgOimgeeUqOaIt+S6pOS6kuWQjuaJjeiDveeUn+aViO+8iQogICAgICAgIHRoaXMuYXVkaW9FbGVtZW50LmxvYWQoKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfwn461IOWIneWni+WMlumfs+S5kOaSreaUvuWZqOWksei0pTonLCBlcnJvcik7CiAgICAgIH0KICAgIH0sCiAgICB0b2dnbGVNdXNpYygpIHsKICAgICAgaWYgKCF0aGlzLmF1ZGlvRWxlbWVudCkgcmV0dXJuOwogICAgICBpZiAodGhpcy5pc011c2ljUGxheWluZykgewogICAgICAgIHRoaXMucGF1c2VNdXNpYygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucGxheU11c2ljKCk7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBwbGF5TXVzaWMoKSB7CiAgICAgIGlmICghdGhpcy5hdWRpb0VsZW1lbnQpIHJldHVybjsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCB0aGlzLmF1ZGlvRWxlbWVudC5wbGF5KCk7CiAgICAgICAgdGhpcy5pc011c2ljUGxheWluZyA9IHRydWU7CiAgICAgICAgY29uc29sZS5sb2coJ/CfjrUg6IOM5pmv6Z+z5LmQ5byA5aeL5pKt5pS+Jyk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS53YXJuKCfwn461IOmfs+S5kOaSreaUvuWksei0pe+8jOWPr+iDvemcgOimgeeUqOaIt+S6pOS6kjonLCBlcnJvcik7CiAgICAgICAgLy8g5aaC5p6c5piv6Ieq5Yqo5pKt5pS+562W55Wl5a+86Ie055qE5aSx6LSl77yM5oiR5Lus5LuN5bCG54q25oCB5qCH6K6w5Li65pKt5pS+CiAgICAgICAgdGhpcy5pc011c2ljUGxheWluZyA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICBwYXVzZU11c2ljKCkgewogICAgICBpZiAoIXRoaXMuYXVkaW9FbGVtZW50KSByZXR1cm47CiAgICAgIHRoaXMuYXVkaW9FbGVtZW50LnBhdXNlKCk7CiAgICAgIHRoaXMuaXNNdXNpY1BsYXlpbmcgPSBmYWxzZTsKICAgICAgY29uc29sZS5sb2coJ/CfjrUg6IOM5pmv6Z+z5LmQ5pqC5YGcJyk7CiAgICB9LAogICAgc2V0Vm9sdW1lKHZvbHVtZSkgewogICAgICB0aGlzLm11c2ljVm9sdW1lID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgdm9sdW1lKSk7CiAgICAgIGlmICh0aGlzLmF1ZGlvRWxlbWVudCkgewogICAgICAgIHRoaXMuYXVkaW9FbGVtZW50LnZvbHVtZSA9IHRoaXMubXVzaWNWb2x1bWU7CiAgICAgIH0KICAgIH0sCiAgICBjbGVhbnVwTXVzaWMoKSB7CiAgICAgIGlmICh0aGlzLmF1ZGlvRWxlbWVudCkgewogICAgICAgIHRoaXMucGF1c2VNdXNpYygpOwogICAgICAgIHRoaXMuYXVkaW9FbGVtZW50ID0gbnVsbDsKICAgICAgfQogICAgfSwKICAgIC8vIOagueaNrua4uOaIj+mYtuauteWkhOeQhumfs+S5kOaSreaUvgogICAgaGFuZGxlR2FtZVBoYXNlTXVzaWMocGhhc2UpIHsKICAgICAgaWYgKCF0aGlzLmF1ZGlvRWxlbWVudCkgcmV0dXJuOwoKICAgICAgLy8g5Y+q5pyJ5Zyo6Z+z5LmQ5q2j5Zyo5pKt5pS+5pe25omN6ZyA6KaB5qC55o2u6Zi25q616LCD5pW0CiAgICAgIGlmICghdGhpcy5pc011c2ljUGxheWluZykgcmV0dXJuOwogICAgICBzd2l0Y2ggKHBoYXNlKSB7CiAgICAgICAgY2FzZSAncHJlcGFyYXRpb24nOgogICAgICAgICAgLy8g5YeG5aSH6Zi25q6177ya5q2j5bi45pKt5pS+CiAgICAgICAgICB0aGlzLnNldFZvbHVtZSgwLjUpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnY291bnRkb3duJzoKICAgICAgICBjYXNlICdpbnRlcm1pc3Npb24nOgogICAgICAgICAgLy8g5YCS6K6h5pe25ZKM6Ze05q2H6Zi25q6177ya6ZmN5L2O6Z+z6YePCiAgICAgICAgICB0aGlzLnNldFZvbHVtZSgwLjMpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnYXVjdGlvbic6CiAgICAgICAgICAvLyDmi43ljZbpmLbmrrXvvJrmraPluLjpn7Pph48KICAgICAgICAgIHRoaXMuc2V0Vm9sdW1lKDAuNSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdpdGVtJzoKICAgICAgICAgIC8vIOmBk+WFt+mYtuaute+8mueojeW+rumZjeS9jumfs+mHjwogICAgICAgICAgdGhpcy5zZXRWb2x1bWUoMC40KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ3NldHRsZW1lbnQnOgogICAgICAgICAgLy8g57uT566X6Zi25q6177ya6ZmN5L2O6Z+z6YePCiAgICAgICAgICB0aGlzLnNldFZvbHVtZSgwLjMpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHRoaXMuc2V0Vm9sdW1lKDAuNSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDpn7PkuZDmjqfliLbnm7jlhbPmlrnms5UKICAgIGluaXRpYWxpemVNdXNpYygpIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyDliJvlu7rpn7PpopHlhYPntKAKICAgICAgICB0aGlzLmF1ZGlvRWxlbWVudCA9IG5ldyBBdWRpbygnL2ltYWdlcy9iZ20ubXAzJyk7CiAgICAgICAgdGhpcy5hdWRpb0VsZW1lbnQubG9vcCA9IHRydWU7CiAgICAgICAgdGhpcy5hdWRpb0VsZW1lbnQudm9sdW1lID0gdGhpcy5tdXNpY1ZvbHVtZTsKCiAgICAgICAgLy8g55uR5ZCs6Z+z6aKR5pKt5pS+54q25oCBCiAgICAgICAgdGhpcy5hdWRpb0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkZGF0YScsICgpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKCfwn461IOiDjOaZr+mfs+S5kOWKoOi9veWujOaIkCcpOwogICAgICAgIH0pOwogICAgICAgIHRoaXMuYXVkaW9FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZSA9PiB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfwn461IOiDjOaZr+mfs+S5kOWKoOi9veWksei0pTonLCBlKTsKICAgICAgICB9KTsKCiAgICAgICAgLy8g5bCd6K+V6Ieq5Yqo5pKt5pS+77yI6ZyA6KaB55So5oi35Lqk5LqS5ZCO5omN6IO955Sf5pWI77yJCiAgICAgICAgdGhpcy5hdWRpb0VsZW1lbnQubG9hZCgpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ/CfjrUg5Yid5aeL5YyW6Z+z5LmQ5pKt5pS+5Zmo5aSx6LSlOicsIGVycm9yKTsKICAgICAgfQogICAgfSwKICAgIHRvZ2dsZU11c2ljKCkgewogICAgICBpZiAoIXRoaXMuYXVkaW9FbGVtZW50KSByZXR1cm47CiAgICAgIGlmICh0aGlzLmlzTXVzaWNQbGF5aW5nKSB7CiAgICAgICAgdGhpcy5wYXVzZU11c2ljKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5wbGF5TXVzaWMoKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIHBsYXlNdXNpYygpIHsKICAgICAgaWYgKCF0aGlzLmF1ZGlvRWxlbWVudCkgcmV0dXJuOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IHRoaXMuYXVkaW9FbGVtZW50LnBsYXkoKTsKICAgICAgICB0aGlzLmlzTXVzaWNQbGF5aW5nID0gdHJ1ZTsKICAgICAgICBjb25zb2xlLmxvZygn8J+OtSDog4zmma/pn7PkuZDlvIDlp4vmkq3mlL4nKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ/CfjrUg6Z+z5LmQ5pKt5pS+5aSx6LSl77yM5Y+v6IO96ZyA6KaB55So5oi35Lqk5LqSOicsIGVycm9yKTsKICAgICAgICAvLyDlpoLmnpzmmK/oh6rliqjmkq3mlL7nrZbnlaXlr7zoh7TnmoTlpLHotKXvvIzmiJHku6zku43lsIbnirbmgIHmoIforrDkuLrmkq3mlL4KICAgICAgICB0aGlzLmlzTXVzaWNQbGF5aW5nID0gdHJ1ZTsKICAgICAgfQogICAgfSwKICAgIHBhdXNlTXVzaWMoKSB7CiAgICAgIGlmICghdGhpcy5hdWRpb0VsZW1lbnQpIHJldHVybjsKICAgICAgdGhpcy5hdWRpb0VsZW1lbnQucGF1c2UoKTsKICAgICAgdGhpcy5pc011c2ljUGxheWluZyA9IGZhbHNlOwogICAgICBjb25zb2xlLmxvZygn8J+OtSDog4zmma/pn7PkuZDmmoLlgZwnKTsKICAgIH0sCiAgICBzZXRWb2x1bWUodm9sdW1lKSB7CiAgICAgIHRoaXMubXVzaWNWb2x1bWUgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCB2b2x1bWUpKTsKICAgICAgaWYgKHRoaXMuYXVkaW9FbGVtZW50KSB7CiAgICAgICAgdGhpcy5hdWRpb0VsZW1lbnQudm9sdW1lID0gdGhpcy5tdXNpY1ZvbHVtZTsKICAgICAgfQogICAgfSwKICAgIGNsZWFudXBNdXNpYygpIHsKICAgICAgaWYgKHRoaXMuYXVkaW9FbGVtZW50KSB7CiAgICAgICAgdGhpcy5wYXVzZU11c2ljKCk7CiAgICAgICAgdGhpcy5hdWRpb0VsZW1lbnQgPSBudWxsOwogICAgICB9CiAgICB9LAogICAgLy8g5qC55o2u5ri45oiP6Zi25q615aSE55CG6Z+z5LmQ5pKt5pS+CiAgICBoYW5kbGVHYW1lUGhhc2VNdXNpYyhwaGFzZSkgewogICAgICBpZiAoIXRoaXMuYXVkaW9FbGVtZW50KSByZXR1cm47CgogICAgICAvLyDlj6rmnInlnKjpn7PkuZDmraPlnKjmkq3mlL7ml7bmiY3pnIDopoHmoLnmja7pmLbmrrXosIPmlbQKICAgICAgaWYgKCF0aGlzLmlzTXVzaWNQbGF5aW5nKSByZXR1cm47CiAgICAgIHN3aXRjaCAocGhhc2UpIHsKICAgICAgICBjYXNlICdwcmVwYXJhdGlvbic6CiAgICAgICAgICAvLyDlh4blpIfpmLbmrrXvvJrmraPluLjmkq3mlL4KICAgICAgICAgIHRoaXMuc2V0Vm9sdW1lKDAuNSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdjb3VudGRvd24nOgogICAgICAgIGNhc2UgJ2ludGVybWlzc2lvbic6CiAgICAgICAgICAvLyDlgJLorqHml7blkozpl7TmrYfpmLbmrrXvvJrpmY3kvY7pn7Pph48KICAgICAgICAgIHRoaXMuc2V0Vm9sdW1lKDAuMyk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdhdWN0aW9uJzoKICAgICAgICAgIC8vIOaLjeWNlumYtuaute+8muato+W4uOmfs+mHjwogICAgICAgICAgdGhpcy5zZXRWb2x1bWUoMC41KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ2l0ZW0nOgogICAgICAgICAgLy8g6YGT5YW36Zi25q6177ya56iN5b6u6ZmN5L2O6Z+z6YePCiAgICAgICAgICB0aGlzLnNldFZvbHVtZSgwLjQpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnc2V0dGxlbWVudCc6CiAgICAgICAgICAvLyDnu5PnrpfpmLbmrrXvvJrpmY3kvY7pn7Pph48KICAgICAgICAgIHRoaXMuc2V0Vm9sdW1lKDAuMyk7CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhpcy5zZXRWb2x1bWUoMC41KTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIHN0YXJ0R2FtZSgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByaWQgPSB0aGlzLiRzdG9yZS5zdGF0ZS5yb29tSWQ7CiAgICAgICAgY29uc3QgdWlkID0gdGhpcy4kc3RvcmUuc3RhdGUudXNlciAmJiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmlkOwogICAgICAgIGlmICghcmlkIHx8ICF1aWQgfHwgIXRoaXMuaXNPd25lciB8fCAhdGhpcy5hbGxSZWFkeSkgcmV0dXJuOwogICAgICAgIC8vIOaWsOWxgOW8gOWni+WJjemHjee9ruezu+e7n+aXpeW/l+OAgeiBiuWkqea2iOaBr+WSjOS7t+WAvOaVsOaNrgogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ0NMRUFSX0dBTUVfTE9HJyk7CiAgICAgICAgfSBjYXRjaCAoXykge30KICAgICAgICB0aGlzLmNoYXRNZXNzYWdlcyA9IFtdOwogICAgICAgIHRoaXMuYWxsUGxheWVyc0FydGlmYWN0cyA9IHt9OwogICAgICAgIGF3YWl0IHJvb21TZXJ2aWNlLnN0YXJ0R2FtZShyaWQsIHVpZCk7CiAgICAgICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpOwogICAgICAgIHRoaXMucm91bmRDb3VudCA9IDA7CiAgICAgICAgYXdhaXQgc3RhcnRHYW1lRmxvdyh7CiAgICAgICAgICByb29tSWQ6IHJpZCwKICAgICAgICAgIHVzZXJJZDogdWlkLAogICAgICAgICAgaXNPd25lcjogdGhpcy5pc093bmVyLAogICAgICAgICAgYWxsUmVhZHk6IHRoaXMuYWxsUmVhZHksCiAgICAgICAgICBzdG9yZTogdGhpcy4kc3RvcmUsCiAgICAgICAgICBzdXBhYmFzZSwKICAgICAgICAgIHNldENvdW50ZG93bjogbiA9PiB0aGlzLiRzZXQodGhpcywgJ2F1Y3Rpb25Db3VudGRvd24nLCBuKSwKICAgICAgICAgIHNldEN1cnJlbnRQbGF5ZXJGcm9tUm9vbTogKCkgPT4gewogICAgICAgICAgICBjb25zdCBtZSA9ICh0aGlzLnJvb20gJiYgdGhpcy5yb29tLnJvb21fcGxheWVycyA/IHRoaXMucm9vbS5yb29tX3BsYXllcnMgOiBbXSkuZmluZChwID0+IHAudXNlcl9pZCA9PT0gdWlkKTsKICAgICAgICAgICAgaWYgKG1lKSB7CiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdTRVRfQ1VSUkVOVF9QTEFZRVInLCB7CiAgICAgICAgICAgICAgICBpZDogbWUudXNlcl9pZCwKICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMuZ2V0TmFtZUZvcihtZS51c2VyX2lkKSwKICAgICAgICAgICAgICAgIGVuZXJneTogNTAsCiAgICAgICAgICAgICAgICBhcnRpZmFjdHM6IFtdLAogICAgICAgICAgICAgICAgaXRlbXM6IFtdCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICBvbkNvdW50ZG93bkRvbmU6IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgaWYgKHRoaXMuaXNPd25lcikgewogICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXV0b1N0YXJ0QXVjdGlvbigpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgLy8g5oi/5Li75pys5Zyw5Lmf5ZCv5Yqo6aKE5YCS6K6h5pe277yM6Ziy5q2i5bm/5pKt5LiN5Zue5Lyg5a+86Ie05LiN6Kem5Y+RIG9uR2FtZVN0YXJ0ZWQKICAgICAgICBpZiAoIXRoaXMuY291bnRkb3duSW5Qcm9ncmVzcykgewogICAgICAgICAgdGhpcy5jb3VudGRvd25JblByb2dyZXNzID0gdHJ1ZTsKICAgICAgICAgIC8vIOehruS/neacrOWcsOS5n+mHjee9ruaVsOaNrgogICAgICAgICAgdGhpcy5jaGF0TWVzc2FnZXMgPSBbXTsKICAgICAgICAgIHRoaXMuYWxsUGxheWVyc0FydGlmYWN0cyA9IHt9OwogICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdTRVRfR0FNRV9QSEFTRScsICdjb3VudGRvd24nKTsKICAgICAgICAgIHRoaXMuJHNldCh0aGlzLCAnYXVjdGlvbkNvdW50ZG93bicsIDUpOwogICAgICAgICAgY29uc3QgbWUgPSAodGhpcy5yb29tICYmIHRoaXMucm9vbS5yb29tX3BsYXllcnMgPyB0aGlzLnJvb20ucm9vbV9wbGF5ZXJzIDogW10pLmZpbmQocCA9PiBwLnVzZXJfaWQgPT09IHVpZCk7CiAgICAgICAgICBpZiAobWUpIHsKICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdTRVRfQ1VSUkVOVF9QTEFZRVInLCB7CiAgICAgICAgICAgICAgaWQ6IG1lLnVzZXJfaWQsCiAgICAgICAgICAgICAgbmFtZTogdGhpcy5nZXROYW1lRm9yKG1lLnVzZXJfaWQpLAogICAgICAgICAgICAgIGVuZXJneTogNTAsCiAgICAgICAgICAgICAgYXJ0aWZhY3RzOiBbXSwKICAgICAgICAgICAgICBpdGVtczogW10KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodGhpcy5hdWN0aW9uVGltZXIpIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmF1Y3Rpb25UaW1lcik7CiAgICAgICAgICAgIHRoaXMuYXVjdGlvblRpbWVyID0gbnVsbDsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgICAgc3RhcnRDb3VudGRvd24oewogICAgICAgICAgICAgIHNlY29uZHM6IDUsCiAgICAgICAgICAgICAgb25UaWNrOiBzID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLCAnYXVjdGlvbkNvdW50ZG93bicsIHMpOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgb25Eb25lOiBhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmNvdW50ZG93bkluUHJvZ3Jlc3MgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzT3duZXIpIHsKICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hdXRvU3RhcnRBdWN0aW9uKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBnZXRSZWY6ICgpID0+IHRoaXMuYXVjdGlvblRpbWVyLAogICAgICAgICAgICAgIHNldFJlZjogaWQgPT4gewogICAgICAgICAgICAgICAgdGhpcy5hdWN0aW9uVGltZXIgPSBpZDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS53YXJuKCdbZ2FtZV0gc3RhcnRHYW1lIGZhaWxlZCcsIGUpOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgc3RhcnRBdWN0aW9uKCkgewogICAgICAvLyDlkIzml7bmir3lj5blpJrku7bov5vooYzmi43ljZbvvIjnpLrkvovkuLoy5Lu277yJCiAgICAgIGNvbnN0IGFydGlmYWN0cyA9IGF3YWl0IHRoaXMubG9hZEFydGlmYWN0cygpOwogICAgICBpZiAoYXJ0aWZhY3RzLmxlbmd0aCA+IDApIHsKICAgICAgICBjb25zdCBwaWNrcyA9IFtdOwogICAgICAgIHdoaWxlIChwaWNrcy5sZW5ndGggPCBNYXRoLm1pbigyLCBhcnRpZmFjdHMubGVuZ3RoKSkgewogICAgICAgICAgY29uc3QgY2FuZGlkYXRlID0gYXJ0aWZhY3RzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFydGlmYWN0cy5sZW5ndGgpXTsKICAgICAgICAgIGlmICghcGlja3MuZmluZChwID0+IHAuaWQgPT09IGNhbmRpZGF0ZS5pZCkpIHBpY2tzLnB1c2goY2FuZGlkYXRlKTsKICAgICAgICB9CiAgICAgICAgZm9yIChjb25zdCBhcnQgb2YgcGlja3MpIHsKICAgICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdzdGFydEF1Y3Rpb24nLCBhcnQpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGFzeW5jIGxvYWRBcnRpZmFjdHMoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpOwogICAgICAgIHJldHVybiBhd2FpdCBsb2FkQXJ0aWZhY3RzU2VydmljZSh7CiAgICAgICAgICBzdXBhYmFzZQogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WKoOi9veWNoeeJjOaVsOaNruWksei0pTonLCBlcnJvcik7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CiAgICB9LAogICAgc2hvd0FydGlmYWN0RGV0YWlsKGFydGlmYWN0SWQpIHsKICAgICAgLy8g6Iul5bey5Yqg6L29YXJ0aWZhY3RNYXDvvIzliJnkvJjlhYjlsZXnpLrnnJ/lrp7mlbDmja4KICAgICAgY29uc3QgYXJ0aWZhY3QgPSB0aGlzLmFydGlmYWN0TWFwW2FydGlmYWN0SWRdOwogICAgICBpZiAoYXJ0aWZhY3QpIHsKICAgICAgICB0aGlzLnNlbGVjdGVkQ2FyZCA9IGFydGlmYWN0OwogICAgICB9IGVsc2UgewogICAgICAgIC8vIOWbnumAgO+8mue7tOaMgeWOn+ekuuS+iwogICAgICAgIHRoaXMuc2VsZWN0ZWRDYXJkID0gewogICAgICAgICAgaWQ6IGFydGlmYWN0SWQsCiAgICAgICAgICBuYW1lOiAn56S65L6L5aWH54mpJywKICAgICAgICAgIGVyYTogJ+WPpOS7oycsCiAgICAgICAgICBsb2NhdGlvbjogJ+acquefpScsCiAgICAgICAgICBzdG9yeTogJ+i/meaYr+S4gOS4quelnuenmOeahOWlh+eJqS4uLicsCiAgICAgICAgICBjb2xsZWN0aW9uVGFnczogWyfoibrmnK/nkbDlrp0nXSwKICAgICAgICAgIGJhc2VWYWx1ZTogOCwKICAgICAgICAgIGltYWdlOiAnaHR0cHM6Ly92aWEucGxhY2Vob2xkZXIuY29tLzMwMHgyMDA/dGV4dD3npLrkvovlpYfniaknCiAgICAgICAgfTsKICAgICAgfQogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ1NFVF9TSE9XX0NBUkRfREVUQUlMJywgdHJ1ZSk7CiAgICB9LAogICAgaGlkZUNhcmREZXRhaWwoKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnU0VUX1NIT1dfQ0FSRF9ERVRBSUwnLCBmYWxzZSk7CiAgICAgIHRoaXMuc2VsZWN0ZWRDYXJkID0gbnVsbDsKICAgIH0sCiAgICBzaG93QXJ0aWZhY3REZXRhaWxGcm9tQXVjdGlvbihhcnRpZmFjdCkgewogICAgICB0aGlzLnNlbGVjdGVkQ2FyZCA9IGFydGlmYWN0OwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ1NFVF9TSE9XX0NBUkRfREVUQUlMJywgZmFsc2UpOwogICAgICB0aGlzLm9wZW5OYXJyYXRpb24oKTsKICAgIH0sCiAgICAvLyDorqHnrpfnjqnlrrbmgLvku7flgLzvvIjmlK/mjIHmiYDmnInnjqnlrrbvvIkKICAgIGdldFBsYXllclRvdGFsVmFsdWUodXNlcklkKSB7CiAgICAgIGlmICghdXNlcklkKSByZXR1cm4gMDsKCiAgICAgIC8vIOS8mOWFiOS7jiBhbGxQbGF5ZXJzQXJ0aWZhY3RzIOiOt+WPluaJgOacieeOqeWutueahOaJi+eJjOaVsOaNrgogICAgICBsZXQgb3duZWQgPSBbXTsKICAgICAgaWYgKHRoaXMuYWxsUGxheWVyc0FydGlmYWN0cyAmJiB0aGlzLmFsbFBsYXllcnNBcnRpZmFjdHNbdXNlcklkXSkgewogICAgICAgIG93bmVkID0gQXJyYXkuaXNBcnJheSh0aGlzLmFsbFBsYXllcnNBcnRpZmFjdHNbdXNlcklkXSkgPyB0aGlzLmFsbFBsYXllcnNBcnRpZmFjdHNbdXNlcklkXSA6IFtdOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIOWbnumAgO+8muWmguaenCBhbGxQbGF5ZXJzQXJ0aWZhY3RzIOS4reayoeacie+8jOWwneivleS7juW9k+WJjeeOqeWutuaVsOaNruiOt+WPlgogICAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLiRzdG9yZS5zdGF0ZS5jdXJyZW50UGxheWVyOwogICAgICAgIGlmIChjdXJyZW50ICYmIGN1cnJlbnQuaWQgPT09IHVzZXJJZCkgewogICAgICAgICAgb3duZWQgPSBBcnJheS5pc0FycmF5KHRoaXMuJHN0b3JlLnN0YXRlLnBsYXllckFydGlmYWN0cykgPyB0aGlzLiRzdG9yZS5zdGF0ZS5wbGF5ZXJBcnRpZmFjdHMgOiBbXTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCFvd25lZCB8fCBvd25lZC5sZW5ndGggPT09IDApIHJldHVybiAwOwoKICAgICAgLy8g56Gu5L+dIGFydGlmYWN0TWFwIOW3suWKoOi9vQogICAgICBpZiAoIXRoaXMuYXJ0aWZhY3RNYXAgfHwgT2JqZWN0LmtleXModGhpcy5hcnRpZmFjdE1hcCkubGVuZ3RoID09PSAwKSByZXR1cm4gMDsKICAgICAgbGV0IHRvdGFsID0gMDsKICAgICAgb3duZWQuZm9yRWFjaChhaWQgPT4gewogICAgICAgIGNvbnN0IGEgPSB0aGlzLmFydGlmYWN0TWFwW2FpZF07CiAgICAgICAgaWYgKGEgJiYgdHlwZW9mIGEuYmFzZVZhbHVlID09PSAnbnVtYmVyJykgewogICAgICAgICAgdG90YWwgKz0gYS5iYXNlVmFsdWU7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIHRvdGFsOwogICAgfSwKICAgIHNob3dQbGF5ZXJIYW5kKHBsYXllcikgewogICAgICAvLyDmnoTpgKDnjqnlrrblr7nosaHvvIzljIXlkKvmiYvniYzkv6Hmga8KICAgICAgY29uc3QgcGxheWVyRGF0YSA9IHsKICAgICAgICBpZDogcGxheWVyLnVzZXJfaWQsCiAgICAgICAgbmFtZTogdGhpcy5nZXROYW1lRm9yKHBsYXllci51c2VyX2lkKSwKICAgICAgICBhcnRpZmFjdHM6IHRoaXMuY3VycmVudFBsYXllciAmJiB0aGlzLmN1cnJlbnRQbGF5ZXIuaWQgPT09IHBsYXllci51c2VyX2lkID8gdGhpcy5jdXJyZW50UGxheWVyLmFydGlmYWN0cyB8fCBbXSA6IFtdCiAgICAgIH07CiAgICAgIHRoaXMuaGFuZFBsYXllciA9IHBsYXllckRhdGE7CiAgICAgIHRoaXMuc2hvd0hhbmRQb3B1cCA9IHRydWU7CiAgICB9LAogICAgaGlkZUhhbmQoKSB7CiAgICAgIHRoaXMuaGFuZFBsYXllciA9IG51bGw7CiAgICAgIHRoaXMuc2hvd0hhbmRQb3B1cCA9IGZhbHNlOwogICAgfSwKICAgIGdldEF2YXRhckZvcih1c2VySWQpIHsKICAgICAgcmV0dXJuIGdldEF2YXRhckZvckhlbHBlcih7CiAgICAgICAgcHJvZmlsZU1hcDogdGhpcy5wcm9maWxlTWFwLAogICAgICAgIHVzZXJJZAogICAgICB9KTsKICAgIH0sCiAgICBnZXROYW1lRm9yKHVzZXJJZCkgewogICAgICByZXR1cm4gZ2V0TmFtZUZvckhlbHBlcih7CiAgICAgICAgcHJvZmlsZU1hcDogdGhpcy5wcm9maWxlTWFwLAogICAgICAgIHJvb206IHRoaXMucm9vbSwKICAgICAgICB1c2VySWQKICAgICAgfSk7CiAgICB9LAogICAgZ2V0Q3VycmVudExhbmd1YWdlKCkgewogICAgICByZXR1cm4gZ2V0Q3VycmVudExhbmd1YWdlSW1wb3J0ZWQoKTsKICAgIH0sCiAgICAvLyDliqDovb3mlLbol4/pm4bmlbDmja7vvJrln7rkuo7mlbDmja7lupMgYXJ0aWZhY3RzIOeahCBjb2xsZWN0aW9uX3RhZ3Mg5Yqo5oCB55Sf5oiQCiAgICBhc3luYyBsb2FkQ29sbGVjdGlvbnMoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgdGhpcy5jb2xsZWN0aW9ucyA9IGxvYWRDb2xsZWN0aW9uc0Zyb21BcnRpZmFjdHModGhpcy5hcnRpZmFjdE1hcCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Yqg6L295pS26JeP6ZuG5pWw5o2u5aSx6LSlOicsIGVycm9yKTsKICAgICAgICB0aGlzLmNvbGxlY3Rpb25zID0gW107CiAgICAgIH0KICAgIH0sCiAgICAvLyDojrflj5blvZPliY3mlLbol4/pm4bmlbDph4/vvIjln7rkuo7lvZPliY3nlKjmiLfmiYvniYzvvIzkuJTlj5fmnIDlpKfopoHmsYLmlbDkuIrpmZDpmZDliLbvvIkKICAgIGdldEN1cnJlbnRDb2xsZWN0aW9uQ291bnQoY29sbGVjdGlvbikgewogICAgICBjb25zdCBvd25lZCA9IHRoaXMuY3VycmVudFBsYXllciAmJiB0aGlzLmN1cnJlbnRQbGF5ZXIuYXJ0aWZhY3RzID8gdGhpcy5jdXJyZW50UGxheWVyLmFydGlmYWN0cyA6IFtdOwogICAgICByZXR1cm4gZ2V0Q29sbGVjdGlvbkNvdW50VXRpbCh7CiAgICAgICAgYXJ0aWZhY3RNYXA6IHRoaXMuYXJ0aWZhY3RNYXAsCiAgICAgICAgb3duZWRBcnRpZmFjdElkczogb3duZWQsCiAgICAgICAgY29sbGVjdGlvbgogICAgICB9KTsKICAgIH0sCiAgICAvLyDlsZXlvIAv5pS26LW35pS26JeP6ZuGCiAgICB0b2dnbGVDb2xsZWN0aW9uKGNvbGxlY3Rpb24pIHsKICAgICAgY29uc3QgaWQgPSBjb2xsZWN0aW9uICYmIGNvbGxlY3Rpb24uaWQ7CiAgICAgIGlmICghaWQpIHJldHVybjsKICAgICAgdGhpcy4kc2V0KHRoaXMuZXhwYW5kZWRDb2xsZWN0aW9ucywgaWQsICF0aGlzLmV4cGFuZGVkQ29sbGVjdGlvbnNbaWRdKTsKICAgIH0sCiAgICAvLyDlhbPpl63muLjmiI/nu5PmnZ/lr7nor53moYYKICAgIGNsb3NlR2FtZUVuZERpYWxvZygpIHsKICAgICAgdGhpcy5zaG93R2FtZUVuZERpYWxvZyA9IGZhbHNlOwogICAgfSwKICAgIC8vIOeVmeWcqOaIv+mXtAogICAgc3RheUluUm9vbSgpIHsKICAgICAgdGhpcy5zaG93R2FtZUVuZERpYWxvZyA9IGZhbHNlOwogICAgICB0cnkgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnQ0xFQVJfR0FNRV9MT0cnKTsKICAgICAgfSBjYXRjaCAoXykge30KICAgICAgLy8g6L+U5Zue5b2T5YmN5oi/6Ze05YeG5aSH55WM6Z2iCiAgICAgIGNvbnN0IHJpZCA9IHRoaXMuJHN0b3JlLnN0YXRlLnJvb21JZDsKICAgICAgaWYgKHJpZCkgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnU0VUX0dBTUVfUEhBU0UnLCAncHJlcGFyYXRpb24nKTsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICBwYXRoOiAnL2dhbWUnLAogICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgcm9vbUlkOiByaWQKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIC8vIOi/lOWbnuaIv+mXtOWIl+ihqAogICAgZ29Ub1Jvb21zKCkgewogICAgICB0aGlzLnNob3dHYW1lRW5kRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMudW5zdWJzY3JpYmVSb29tUmVhbHRpbWUoKTsKICAgICAgdHJ5IHsKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ0NMRUFSX0dBTUVfTE9HJyk7CiAgICAgIH0gY2F0Y2ggKF8pIHt9CiAgICAgIC8vIOi/lOWbnuW9k+WJjeaIv+mXtOWHhuWkh+eVjOmdou+8iOabtOespuWQiOacn+acm++8iQogICAgICBjb25zdCByaWQgPSB0aGlzLiRzdG9yZS5zdGF0ZS5yb29tSWQ7CiAgICAgIGlmIChyaWQpIHsKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ1NFVF9HQU1FX1BIQVNFJywgJ3ByZXBhcmF0aW9uJyk7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgcGF0aDogJy9nYW1lJywKICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgIHJvb21JZDogcmlkCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9yb29tcycpOwogICAgICB9CiAgICB9LAogICAgLy8g5pe26Ze05Yiw77ya57uT5p2f5b2T5YmN5omA5pyJ5ouN5Y2W5bm257uT566X5Yiw5a+55bqU546p5a625omL54mM77yM54S25ZCO6L+b5YWlMTBz6Ze05q2H5oiW57uT5p2f5ri45oiPCiAgICBhc3luYyBvbkF1Y3Rpb25UaW1lVXAoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgYXVjdGlvbnMgPSB0aGlzLiRzdG9yZS5zdGF0ZS5jdXJyZW50QXVjdGlvbnMgfHwgW107CiAgICAgICAgLy8g57uf5LiA5YCS6K6h5pe257uT5p2f77ya57uT5p2f5omA5pyJ5b2T5YmN5ouN5Y2WCiAgICAgICAgZm9yIChjb25zdCBhIG9mIGF1Y3Rpb25zKSB7CiAgICAgICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZW5kQXVjdGlvbicsIGEuaWQpOwogICAgICAgIH0KICAgICAgICAvLyDliKTmlq3mmK/lkKbovr7liLDmgLvlm57lkIjmlbAKICAgICAgICBjb25zdCBjdXIgPSBOdW1iZXIodGhpcy4kc3RvcmUuc3RhdGUucm91bmRDdXJyZW50IHx8IDApOwogICAgICAgIGNvbnN0IHRvdCA9IE51bWJlcih0aGlzLiRzdG9yZS5zdGF0ZS5yb3VuZFRvdGFsIHx8IDYpOwogICAgICAgIGlmIChjdXIgPj0gdG90KSB7CiAgICAgICAgICAvLyDop6blj5Hnu5PmnZ8KICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnU0VUX0dBTUVfUEhBU0UnLCAnc2V0dGxlbWVudCcpOwogICAgICAgICAgYXdhaXQgdGhpcy5jb21wdXRlRmluYWxTY29yZXMoKTsKICAgICAgICAgIHRoaXMuc2hvd0dhbWVFbmREaWFsb2cgPSB0cnVlOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAvLyDlkKbliJnov5vlhaUxMHPpl7TmrYfpmLbmrrUKICAgICAgICB0aGlzLnN0YXJ0SW50ZXJtaXNzaW9uVGltZXIoMTApOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS53YXJuKCdbZ2FtZV0gb25BdWN0aW9uVGltZVVwIGZhaWxlZCcsIGUpOwogICAgICB9CiAgICB9LAogICAgLy8g5byA5aeL5ouN5Y2W5YCS6K6h5pe277ya57uf5LiA5q+P6L2u5ouN5Y2W5Y+q5pyJ5LiA5Liq5YCS6K6h5pe2CiAgICBzdGFydEF1Y3Rpb25UaW1lcihkdXJhdGlvbiA9IDMwKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnU0VUX0dBTUVfUEhBU0UnLCAnYXVjdGlvbicpOwogICAgICBzdGFydENvdW50ZG93bih7CiAgICAgICAgc2Vjb25kczogZHVyYXRpb24sCiAgICAgICAgb25UaWNrOiBzID0+IHsKICAgICAgICAgIHRoaXMuJHNldCh0aGlzLCAnYXVjdGlvbkNvdW50ZG93bicsIHMpOwogICAgICAgIH0sCiAgICAgICAgb25Eb25lOiBhc3luYyAoKSA9PiB7CiAgICAgICAgICBhd2FpdCB0aGlzLm9uQXVjdGlvblRpbWVVcCgpOwogICAgICAgIH0sCiAgICAgICAgZ2V0UmVmOiAoKSA9PiB0aGlzLmF1Y3Rpb25UaW1lciwKICAgICAgICBzZXRSZWY6IGlkID0+IHsKICAgICAgICAgIHRoaXMuYXVjdGlvblRpbWVyID0gaWQ7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyDmr4/ova7kuYvpl7TnmoTpl7TmrYforqHml7blmajvvIznu5PmnZ/lkI7oh6rliqjlvIDlp4vkuIvkuIDova7mi43ljZYKICAgIHN0YXJ0SW50ZXJtaXNzaW9uVGltZXIoZHVyYXRpb24gPSAxMCkgewogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ1NFVF9HQU1FX1BIQVNFJywgJ2ludGVybWlzc2lvbicpOwogICAgICBzdGFydENvdW50ZG93bih7CiAgICAgICAgc2Vjb25kczogZHVyYXRpb24sCiAgICAgICAgb25UaWNrOiBzID0+IHsKICAgICAgICAgIHRoaXMuJHNldCh0aGlzLCAnYXVjdGlvbkNvdW50ZG93bicsIHMpOwogICAgICAgIH0sCiAgICAgICAgb25Eb25lOiBhc3luYyAoKSA9PiB7CiAgICAgICAgICBpZiAodGhpcy5pc093bmVyKSB7CiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXV0b1N0YXJ0QXVjdGlvbigpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZ2V0UmVmOiAoKSA9PiB0aGlzLmF1Y3Rpb25UaW1lciwKICAgICAgICBzZXRSZWY6IGlkID0+IHsKICAgICAgICAgIHRoaXMuYXVjdGlvblRpbWVyID0gaWQ7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyDoh6rliqjlvIDlp4vmi43ljZYKICAgIGFzeW5jIGF1dG9TdGFydEF1Y3Rpb24oKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmlkID0gdGhpcy4kc3RvcmUuc3RhdGUucm9vbUlkOwogICAgICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2UoKTsKICAgICAgICBhd2FpdCBhdXRvU3RhcnRBdWN0aW9uRmxvdyh7CiAgICAgICAgICByb29tSWQ6IHJpZCwKICAgICAgICAgIHN0b3JlOiB0aGlzLiRzdG9yZSwKICAgICAgICAgIHN1cGFiYXNlLAogICAgICAgICAgbG9hZEFydGlmYWN0czogKCkgPT4gdGhpcy5sb2FkQXJ0aWZhY3RzKCksCiAgICAgICAgICBkaXNwYXRjaFN0YXJ0QXVjdGlvbjogYXJ0ID0+IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdzdGFydEF1Y3Rpb24nLCBhcnQpLAogICAgICAgICAgc3RhcnRBdWN0aW9uVGltZXI6IHNlYyA9PiB0aGlzLnN0YXJ0QXVjdGlvblRpbWVyKHNlYyksCiAgICAgICAgICByb3VuZENvdW50OiB0aGlzLnJvdW5kQ291bnQsCiAgICAgICAgICB0b3RhbFJvdW5kczogdGhpcy50b3RhbFJvdW5kcywKICAgICAgICAgIHNldFJvdW5kQ291bnQ6IG4gPT4gewogICAgICAgICAgICB0aGlzLnJvdW5kQ291bnQgPSBuOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS53YXJuKCdbZ2FtZV0gYXV0b1N0YXJ0QXVjdGlvbiBmYWlsZWQnLCBlKTsKICAgICAgfQogICAgfSwKICAgIC8vIOWPkemAgeiBiuWkqea2iOaBrwogICAgYXN5bmMgc2VuZE1lc3NhZ2UoKSB7CiAgICAgIGlmICghdGhpcy5uZXdNZXNzYWdlLnRyaW0oKSB8fCAhdGhpcy51c2VyKSByZXR1cm47CiAgICAgIGNvbnN0IG1lc3NhZ2UgPSB7CiAgICAgICAgaWQ6IERhdGUubm93KCksCiAgICAgICAgdXNlcklkOiB0aGlzLnVzZXIuaWQsCiAgICAgICAgdXNlcm5hbWU6IHRoaXMuZ2V0TmFtZUZvcih0aGlzLnVzZXIuaWQpLAogICAgICAgIGNvbnRlbnQ6IHRoaXMubmV3TWVzc2FnZS50cmltKCksCiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpCiAgICAgIH07CiAgICAgIC8vIOacrOWcsOeri+WNs+aYvuekuu+8jOaPkOS+m+WNs+aXtuWPjemmiAogICAgICB0aGlzLmNoYXRNZXNzYWdlcy5wdXNoKG1lc3NhZ2UpOwogICAgICB0aGlzLm5ld01lc3NhZ2UgPSAnJzsKCiAgICAgIC8vIOa7muWKqOWIsOW6lemDqAogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgY29uc3QgY2hhdENvbnRhaW5lciA9IHRoaXMuJHJlZnMuY2hhdENvbnRhaW5lcjsKICAgICAgICBpZiAoY2hhdENvbnRhaW5lcikgewogICAgICAgICAgY2hhdENvbnRhaW5lci5zY3JvbGxUb3AgPSBjaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodDsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgLy8g5Y+R6YCB5Yiw5pyN5Yqh5Zmo77yM5bm/5pKt57uZ5omA5pyJ546p5a62CiAgICAgIGNvbnN0IHJpZCA9IHRoaXMuJHN0b3JlLnN0YXRlLnJvb21JZDsKICAgICAgaWYgKHJpZCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlKCk7CiAgICAgICAgICBhd2FpdCBzZW5kQ2hhdE1lc3NhZ2UoewogICAgICAgICAgICBzdXBhYmFzZSwKICAgICAgICAgICAgcm9vbUlkOiByaWQsCiAgICAgICAgICAgIG1lc3NhZ2UKICAgICAgICAgIH0pOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIGNvbnNvbGUud2FybignW2dhbWVdIHNlbmRNZXNzYWdlIGZhaWxlZCcsIGUpOwogICAgICAgICAgLy8g5Y+R6YCB5aSx6LSl5pe277yM5Y+v5Lul6YCJ5oup56e76Zmk5pys5Zyw5raI5oGv5oiW5L+d55WZ77yI5L+d55WZ5o+Q5L6b5pu05aW955qE55So5oi35L2T6aqM77yJCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy8g5qC85byP5YyW5raI5oGv5pe26Ze0CiAgICBmb3JtYXRNZXNzYWdlVGltZSh0aW1lc3RhbXApIHsKICAgICAgcmV0dXJuIGZvcm1hdE1lc3NhZ2VUaW1lSGVscGVyKHRpbWVzdGFtcCk7CiAgICB9LAogICAgLy8g6K6h566X5pyA57uI5b6X5YiG5bm256Gu5a6a6LWi5a62CiAgICBhc3luYyBjb21wdXRlRmluYWxTY29yZXMoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmlkID0gdGhpcy4kc3RvcmUuc3RhdGUucm9vbUlkOwogICAgICAgIGlmICghcmlkKSByZXR1cm47CiAgICAgICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpOwogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGRhdGE6IHJvd3MKICAgICAgICB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbSgncm9vbV9hcnRpZmFjdHMnKS5zZWxlY3QoJ293bmVyX3VzZXJfaWQsIGFydGlmYWN0X2lkJykuZXEoJ3Jvb21faWQnLCByaWQpOwogICAgICAgIGNvbnN0IHVzZXJUb0FydGlmYWN0cyA9IHt9OwogICAgICAgIChyb3dzIHx8IFtdKS5mb3JFYWNoKHIgPT4gewogICAgICAgICAgaWYgKCF1c2VyVG9BcnRpZmFjdHNbci5vd25lcl91c2VyX2lkXSkgdXNlclRvQXJ0aWZhY3RzW3Iub3duZXJfdXNlcl9pZF0gPSBbXTsKICAgICAgICAgIHVzZXJUb0FydGlmYWN0c1tyLm93bmVyX3VzZXJfaWRdLnB1c2goci5hcnRpZmFjdF9pZCk7CiAgICAgICAgfSk7CiAgICAgICAgY29uc3QgY29sbGVjdGlvbnMgPSBBcnJheS5pc0FycmF5KHRoaXMuY29sbGVjdGlvbnMpID8gdGhpcy5jb2xsZWN0aW9ucyA6IFtdOwogICAgICAgIGNvbnN0IHNjb3JlcyA9IE9iamVjdC5rZXlzKHVzZXJUb0FydGlmYWN0cykubWFwKHVpZCA9PiB7CiAgICAgICAgICBjb25zdCBvd25lZCA9IHVzZXJUb0FydGlmYWN0c1t1aWRdOwogICAgICAgICAgLy8g5pS26JeP6ZuG5YiG5pWwCiAgICAgICAgICBsZXQgY29sbGVjdGlvblNjb3JlID0gMDsKICAgICAgICAgIGNvbGxlY3Rpb25zLmZvckVhY2goY29sID0+IHsKICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGdldENvbGxlY3Rpb25Db3VudFV0aWwoewogICAgICAgICAgICAgIGFydGlmYWN0TWFwOiB0aGlzLmFydGlmYWN0TWFwLAogICAgICAgICAgICAgIG93bmVkQXJ0aWZhY3RJZHM6IG93bmVkLAogICAgICAgICAgICAgIGNvbGxlY3Rpb246IGNvbAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKGN1cnJlbnQgPj0gKGNvbC5yZXF1aXJlZENvdW50IHx8IDEpKSBjb2xsZWN0aW9uU2NvcmUgKz0gY29sLnJld2FyZFBvaW50cyB8fCAwOwogICAgICAgICAgfSk7CiAgICAgICAgICAvLyDpm7bmlaPlpYfnianliIbmlbDvvIjln7rnoYDku7flgLzkuIDljYrvvIzlkJHkuIvlj5bmlbTvvIkKICAgICAgICAgIGxldCBhcnRpZmFjdFNjb3JlID0gMDsKICAgICAgICAgIG93bmVkLmZvckVhY2goYWlkID0+IHsKICAgICAgICAgICAgY29uc3QgYSA9IHRoaXMuYXJ0aWZhY3RNYXBbYWlkXTsKICAgICAgICAgICAgaWYgKGEgJiYgdHlwZW9mIGEuYmFzZVZhbHVlID09PSAnbnVtYmVyJykgYXJ0aWZhY3RTY29yZSArPSBNYXRoLmZsb29yKGEuYmFzZVZhbHVlIC8gMik7CiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbnN0IHRvdGFsID0gY29sbGVjdGlvblNjb3JlICsgYXJ0aWZhY3RTY29yZTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHVzZXJJZDogdWlkLAogICAgICAgICAgICBuYW1lOiB0aGlzLmdldE5hbWVGb3IodWlkKSwKICAgICAgICAgICAgYXZhdGFyOiB0aGlzLmdldEF2YXRhckZvcih1aWQpLAogICAgICAgICAgICBjb2xsZWN0aW9uU2NvcmUsCiAgICAgICAgICAgIGFydGlmYWN0U2NvcmUsCiAgICAgICAgICAgIHRvdGFsCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICAgIGNvbnN0IHNvcnRlZCA9IHNjb3Jlcy5zb3J0KChhLCBiKSA9PiBiLnRvdGFsIC0gYS50b3RhbCk7CiAgICAgICAgdGhpcy5maW5hbFNjb3JlcyA9IHNvcnRlZDsKICAgICAgICB0aGlzLndpbm5lckluZm8gPSBzb3J0ZWRbMF0gfHwgbnVsbDsKICAgICAgICBpZiAodGhpcy53aW5uZXJJbmZvKSB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ0FERF9HQU1FX0xPRycsIHsKICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLAogICAgICAgICAgICBtZXNzYWdlOiBg5pys5bGA57uT5p2f77yM6IOc6ICF77yaJHt0aGlzLndpbm5lckluZm8ubmFtZX3vvIjmgLvliIYgJHt0aGlzLndpbm5lckluZm8udG90YWx977yJYAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS53YXJuKCdbZ2FtZV0gY29tcHV0ZUZpbmFsU2NvcmVzIGZhaWxlZCcsIGUpOwogICAgICB9CiAgICB9LAogICAgLy8g5byA5ZCvL+WFs+mXreaWh+eJqeiusui/sAogICAgb3Blbk5hcnJhdGlvbigpIHsKICAgICAgLy8g5p6E6YCg6K6y6L+w5paH5pys77yM5YyF5ZCr5Z+65pys5LuL57uNICsg5pWF5LqLCiAgICAgIGNvbnN0IGJhc2UgPSBgJHt0aGlzLnNlbGVjdGVkQ2FyZC5uYW1lfe+8jOadpeiHqiAke3RoaXMuc2VsZWN0ZWRDYXJkLmVyYX0ke3RoaXMuc2VsZWN0ZWRDYXJkLmxvY2F0aW9uID8gJyDCtyAnICsgdGhpcy5zZWxlY3RlZENhcmQubG9jYXRpb24gOiAnJ33jgIJcbmA7CiAgICAgIGNvbnN0IHN0b3J5ID0gKHRoaXMuc2VsZWN0ZWRDYXJkLnN0b3J5IHx8ICcnKS50cmltKCk7CiAgICAgIGNvbnN0IGZ1bGwgPSBgJHtiYXNlfSR7c3Rvcnl9YC50cmltKCk7CiAgICAgIC8vIOaJk+Wtl+acuuaViOaenAogICAgICB0aGlzLnR5cGluZ1RleHQgPSAnJzsKICAgICAgdGhpcy5zaG93TmFycmF0aW9uID0gdHJ1ZTsKICAgICAgY29uc3Qgc3BlZWQgPSBmaXJzdExvZ2luRGlhbG9ndWVDb25maWcgJiYgZmlyc3RMb2dpbkRpYWxvZ3VlQ29uZmlnLmFuaW1hdGlvbnMgJiYgZmlyc3RMb2dpbkRpYWxvZ3VlQ29uZmlnLmFuaW1hdGlvbnMudGV4dFR5cGluZ1NwZWVkIHx8IDMwOwogICAgICBpZiAodGhpcy50eXBpbmdUaW1lcikgewogICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50eXBpbmdUaW1lcik7CiAgICAgICAgdGhpcy50eXBpbmdUaW1lciA9IG51bGw7CiAgICAgIH0KICAgICAgbGV0IGkgPSAwOwogICAgICB0aGlzLnR5cGluZ1RpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgIGlmIChpID49IGZ1bGwubGVuZ3RoKSB7CiAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudHlwaW5nVGltZXIpOwogICAgICAgICAgdGhpcy50eXBpbmdUaW1lciA9IG51bGw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudHlwaW5nVGV4dCArPSBmdWxsW2ldOwogICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgICAgfSwgc3BlZWQpOwogICAgfSwKICAgIGNsb3NlTmFycmF0aW9uKCkgewogICAgICBpZiAodGhpcy50eXBpbmdUaW1lcikgewogICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50eXBpbmdUaW1lcik7CiAgICAgICAgdGhpcy50eXBpbmdUaW1lciA9IG51bGw7CiAgICAgIH0KICAgICAgdGhpcy5zaG93TmFycmF0aW9uID0gZmFsc2U7CiAgICAgIHRoaXMudHlwaW5nVGV4dCA9ICcnOwogICAgfQogIH0KfTs="},{"version":3,"names":["mapState","mapGetters","AuctionPanel","roomService","getSupabase","auctionService","startCountdown","clearCountdown","loadRoomState","loadRoomStateService","subscribeRoomRealtime","subscribeRoomRealtimeService","unsubscribeRoomRealtime","unsubscribeRoomRealtimeService","startGame","startGameFlow","autoStartAuction","autoStartAuctionFlow","sendChatMessage","toggleReady","toggleReadyAction","moveToSeat","moveToSeatAction","leaveRoom","leaveRoomAction","loadArtifacts","loadArtifactsService","loadCollectionsFromArtifacts","getCurrentCollectionCount","getCollectionCountUtil","getCollectionProgress","getCollectionProgressUtil","formatMessageTime","formatMessageTimeHelper","getAvatarFor","getAvatarForHelper","getNameFor","getNameForHelper","firstLoginDialogue","firstLoginDialogueConfig","getCurrentLanguage","getCurrentLanguageImported","name","components","data","selectedCard","showHandPopup","handPlayer","artifactMap","room","profileMap","refreshTimer","collections","showGameEndDialog","finalScores","winnerInfo","auctionCountdown","auctionTimer","currentAuction","roundCount","totalRounds","chatMessages","newMessage","chatChannel","countdownInProgress","expandedCollections","showNarration","typingText","typingTimer","allPlayersArtifacts","artifactCarouselData","currentSlide","carouselInterval","isMusicPlaying","audioElement","musicVolume","computed","currentPlayer","$store","state","isOwner","user","owner_id","id","allReady","players","room_players","length","every","p","is_ready","currentUserReady","me","find","user_id","playerCount","ownerName","seatCount","Number","max_players","seats","max","Array","from","player","forEach","idx","seat_index","filter","emptyIdx","findIndex","s","gamePhaseText","phaseMap","gamePhase","collectionsComputed","list","isArray","map","col","current","progress","Math","min","requiredCount","_current","_progress","chatFeed","logs","gameLog","l","timestamp","type","userId","username","content","message","chats","m","merged","sort","a","b","firstLoginConfig","narrationCharacterName","narrationCharacter","key","chars","characters","image","position","color","mounted","roomId","$route","query","commit","initializeGame","initializeArtifactCarousel","initializeMusic","beforeDestroy","clearInterval","cleanupMusic","$set","watch","$nextTick","chatContainer","$refs","scrollTop","scrollHeight","newPhase","startAutoCarousel","stopAutoCarousel","handleGamePhaseMusic","methods","console","log","supabase","artifactData","error","artifactError","select","limit","dataLength","finalData","getMockArtifactData","item","index","imageUrl","startsWith","window","location","origin","processedItem","era","baseValue","base_value","setInterval","nextSlide","prevSlide","goToSlide","handleImageError","artifact","warn","artifacts","reduce","acc","loadCollections","rid","roomChannel","broadcastChannel","onLoadRoomState","onGameStarted","_payload","energy","items","seconds","onTick","onDone","getRef","setRef","onAuctionStarted","duration","payload","roundCurrent","roundTotal","startAuctionTimer","onBidUpdate","auctionId","highestBid","highestBidder","currentAuctions","next","onRoundUpdated","_data","onGameEnded","computeFinalScores","finally","onAuctionEnded","onChatMessage","existing","push","store","setRoom","setProfileMap","setGamePhase","phase","clearAuctionTimer","setAuctionCountdown","n","onShowGameEnd","setTimeout","handleGameEnd","loadAllPlayersArtifacts","auctions","remaining","onAuctionTimeUp","allArtifacts","eq","playerArtifactsMap","row","owner_user_id","artifact_id","e","uid","reload","targetSeat","setCountdown","unsubscribe","setRoomId","v","setLocalRoom","navigateToRooms","$router","update","status","path","gameEnded","Audio","loop","volume","addEventListener","load","toggleMusic","pauseMusic","playMusic","play","pause","setVolume","_","setCurrentPlayerFromRoom","onCountdownDone","startAuction","picks","candidate","floor","random","art","dispatch","showArtifactDetail","artifactId","story","collectionTags","hideCardDetail","showArtifactDetailFromAuction","openNarration","getPlayerTotalValue","owned","playerArtifacts","Object","keys","total","aid","showPlayerHand","playerData","hideHand","collection","ownedArtifactIds","toggleCollection","closeGameEndDialog","stayInRoom","goToRooms","cur","tot","startIntermissionTimer","dispatchStartAuction","sec","setRoundCount","sendMessage","trim","Date","now","rows","userToArtifacts","r","scores","collectionScore","rewardPoints","artifactScore","avatar","sorted","base","full","speed","animations","textTypingSpeed","i","closeNarration"],"sources":["src/pages/index/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"game-container\" :class=\"{ 'post-start': gamePhase !== 'preparation' }\">\r\n    <!-- 顶部状态栏：品牌/用户信息/导航控制（登录、个人中心、准备/开始/商店/退出） -->\r\n    <div class=\"top-auth-bar\">\r\n      <div class=\"left\">\r\n        <span class=\"brand\">时空旅人拍卖会</span>\r\n      </div>\r\n      <div class=\"right\" v-if=\"user\">\r\n        <span class=\"user-email\">{{ user.email }}</span>\r\n        <!-- 音乐控制按钮 -->\r\n        <button class=\"nav-button music-control\" @click=\"toggleMusic\" :class=\"{ 'music-playing': isMusicPlaying }\">\r\n          <span class=\"music-icon\">{{ isMusicPlaying ? '🔊' : '🔇' }}</span>\r\n          <span class=\"music-text\">{{ isMusicPlaying ? '音乐' : '静音' }}</span>\r\n        </button>\r\n        <button class=\"nav-button\" @click=\"$router.push('/profile')\">个人中心</button>\r\n      </div>\r\n      <div class=\"right\" v-else>\r\n        <button class=\"nav-button primary\" @click=\"$router.push('/login')\">登录 / 注册</button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"game-status\">\r\n      <div class=\"room-info\">\r\n        <div class=\"room-name\">{{ room ? (room.name || '未命名房间') : '未加入房间' }}</div>\r\n        <div class=\"room-meta\" v-if=\"room\">玩家 {{ playerCount }}/{{ seatCount }} · 房主：{{ ownerName }}</div>\r\n        <div class=\"room-id-pill\">ID: {{ room ? (room.short_id || room.id) : '-' }}</div>\r\n      </div>\r\n      <span class=\"game-phase\">{{ gamePhaseText }}</span>\r\n      <div class=\"game-controls\">\r\n        <button class=\"control-button\" @click=\"toggleReady\" v-if=\"gamePhase === 'preparation'\">{{ currentUserReady ? '取消准备' : '准备' }}</button>\r\n        <button class=\"control-button\" @click=\"startGame\" v-if=\"gamePhase === 'preparation' && isOwner && allReady\">开始游戏</button>\r\n        <button class=\"control-button\" @click=\"startAuction\" v-if=\"false\">开始拍卖</button>\r\n        <button class=\"control-button danger\" @click=\"leaveRoom\">退出房间</button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 玩家头像区域：展示房间玩家，点击头像可查看该玩家手牌（当前仅展示自己的手牌明细） -->\r\n    <div class=\"players-avatars\" v-if=\"playerCount > 0 && gamePhase !== 'preparation'\">\r\n      <div class=\"avatar-item\" v-for=\"p in (room ? room.room_players : [])\" :key=\"p.user_id\" @click=\"showPlayerHand(p)\">\r\n        <div class=\"avatar-wrap\">\r\n          <img class=\"player-avatar\" :src=\"getAvatarFor(p.user_id)\" />\r\n          <span class=\"ready-indicator\" :class=\"{ on: !!p.is_ready }\"></span>\r\n        </div>\r\n        <div class=\"player-name\">{{ getNameFor(p.user_id) }}</div>\r\n        <div class=\"player-value\">价值 {{ getPlayerTotalValue(p.user_id) }}</div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 拍卖舞台：在不同的 gamePhase 下显示倒计时/间歇/拍卖面板或占位提示 -->\r\n    <div class=\"auction-stage\" :class=\"{ 'align-left': gamePhase === 'auction' }\">\r\n      <!-- 预倒计时阶段（游戏开始后5s预热） -->\r\n      <template v-if=\"gamePhase === 'countdown'\">\r\n        <div class=\"countdown-stage\">\r\n          <div class=\"countdown-content\">\r\n            <div class=\"countdown-icon\">⏳</div>\r\n            <div class=\"countdown-title\">游戏即将开始</div>\r\n            <div class=\"countdown-timer\">{{ auctionCountdown }}s</div>\r\n            <div class=\"countdown-subtitle\">请稍候，拍卖即将开始...</div>\r\n          </div>\r\n        </div>\r\n      </template>\r\n            <!-- 间歇阶段（每轮结束后的休息时间） -->\r\n      <template v-else-if=\"gamePhase === 'intermission'\">\r\n        <div class=\"countdown-stage\">\r\n          <div class=\"countdown-content\">\r\n            <div class=\"countdown-icon\">🧭</div>\r\n            <div class=\"countdown-title\">间歇中</div>\r\n            <div class=\"countdown-timer\">{{ auctionCountdown }}s</div>\r\n            <div class=\"countdown-subtitle\">请稍候，下一轮拍卖即将开始...</div>\r\n          </div>\r\n        </div>\r\n      </template>\r\n      \r\n      <!-- 拍卖阶段：展示拍卖面板（当前拍品列表、轮次信息、点击卡片触发讲述） -->\r\n      <auction-panel \r\n        v-else-if=\"gamePhase === 'auction' && $store.state.currentAuctions && $store.state.currentAuctions.length\" \r\n        :auctions=\"$store.state.currentAuctions\" \r\n        :countdown=\"auctionCountdown\"\r\n        :round-current=\"$store.state.roundCurrent\"\r\n        :round-total=\"$store.state.roundTotal\"\r\n        @artifact-click=\"showArtifactDetailFromAuction\" \r\n      />\r\n      <!-- 准备阶段：显示文物照片自动滑动展示 -->\r\n      <div v-else-if=\"gamePhase === 'preparation'\" class=\"preparation-stage\">\r\n        <div class=\"artifact-carousel-container\">\r\n          <div class=\"carousel-header\">\r\n            <h3 class=\"carousel-title\">时空珍宝预览</h3>\r\n            <p class=\"carousel-subtitle\">准备阶段 - 即将拍卖的珍贵文物</p>\r\n          </div>\r\n          \r\n          <div class=\"artifact-carousel\">\r\n            <div class=\"carousel-track\" :style=\"{ transform: `translateX(-${currentSlide * 100}%)` }\">\r\n              <div \r\n                v-for=\"(artifact, index) in artifactCarouselData\" \r\n                :key=\"index\" \r\n                class=\"carousel-slide\"\r\n              >\r\n                <div class=\"artifact-slide-content\">\r\n                  <div class=\"artifact-image-container\">\r\n                    <img \r\n                      class=\"artifact-image\" \r\n                      :src=\"artifact.image || 'https://via.placeholder.com/400x300?text=文物预览'\" \r\n                      :alt=\"artifact.name\"\r\n                      @error=\"handleImageError(artifact)\"\r\n                    />\r\n                    <div class=\"artifact-overlay\"></div>\r\n                  </div>\r\n                  <div class=\"artifact-info\">\r\n                    <h4 class=\"artifact-name\">{{ artifact.name || '未知文物' }}</h4>\r\n                    <div class=\"artifact-meta\">\r\n                      <span class=\"artifact-era\" v-if=\"artifact.era\">{{ artifact.era }}</span>\r\n                      <span class=\"artifact-location\" v-if=\"artifact.location\">{{ artifact.location }}</span>\r\n                    </div>\r\n                    <p class=\"artifact-value\" v-if=\"artifact.baseValue !== undefined\">\r\n                      基础价值: {{ artifact.baseValue }} ⚡\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <!-- 轮播控制按钮 -->\r\n            <button class=\"carousel-nav carousel-prev\" @click=\"prevSlide\">\r\n              <span>‹</span>\r\n            </button>\r\n            <button class=\"carousel-nav carousel-next\" @click=\"nextSlide\">\r\n              <span>›</span>\r\n            </button>\r\n            \r\n            <!-- 轮播指示器 -->\r\n            <div class=\"carousel-indicators\">\r\n              <span \r\n                v-for=\"(artifact, index) in (artifactCarouselData || []).slice(0, 5)\" \r\n                :key=\"index\" \r\n                class=\"indicator-dot\"\r\n                :class=\"{ active: artifactCarouselData && artifactCarouselData.length > 0 && currentSlide % artifactCarouselData.length === index }\"\r\n                @click=\"goToSlide(index)\"\r\n              ></span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- 其他情况显示占位提示 -->\r\n      <div v-else class=\"stage-placeholder\">拍卖会台空闲，等待新一轮拍卖</div>\r\n    </div>\r\n\r\n    <!-- 房间座位区（准备阶段）：点击空位入座，已入座玩家显示头像与准备标记 -->\r\n    <div class=\"seats\" v-if=\"seatCount > 0 && gamePhase === 'preparation'\" :style=\"{ gridTemplateColumns: 'repeat(' + seatCount + ', 1fr)' }\">\r\n      <div class=\"seat\" v-for=\"(seat, idx) in seats\" :key=\"idx\" :class=\"{ occupied: !!seat.player }\" @click=\"moveToSeat(idx)\">\r\n        <div class=\"seat-index\">{{ idx + 1 }}/{{ seatCount }}</div>\r\n        <div class=\"seat-body\">\r\n          <div v-if=\"seat.player\" class=\"seat-player\">\r\n            <div class=\"avatar-wrap\">\r\n              <img class=\"seat-avatar\" :src=\"getAvatarFor(seat.player.user_id)\" />\r\n              <span v-if=\"seat.player.is_ready\" class=\"ready-badge\">✓</span>\r\n            </div>\r\n            <div class=\"seat-name\">{{ getNameFor(seat.player.user_id) }}</div>\r\n          </div>\r\n          <div v-else class=\"seat-empty\">空位</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 当前玩家手牌：展示自己已拥有的奇物，点击查看详情（或触发讲述） -->\r\n    <div class=\"my-hand\" v-if=\"gamePhase !== 'preparation'\">\r\n      <h3 class=\"hand-title\">我的手牌</h3>\r\n      <div class=\"hand-grid\">\r\n        <div\r\n          v-for=\"(aid, idx) in (currentPlayer ? currentPlayer.artifacts : [])\"\r\n          :key=\"aid + '-' + idx\"\r\n          class=\"hand-card fancy\"\r\n          @click=\"showArtifactDetail(aid)\"\r\n        >\r\n          <div class=\"hand-media\">\r\n            <img\r\n              class=\"hand-image\"\r\n              :src=\"artifactMap[aid] ? artifactMap[aid].image : 'https://via.placeholder.com/160x100?text=未知卡牌'\"\r\n            />\r\n            <div class=\"hand-overlay\"></div>\r\n          </div>\r\n          <div class=\"hand-info\">\r\n            <div class=\"hand-name\" :title=\"artifactMap[aid] ? artifactMap[aid].name : aid\">\r\n              {{ artifactMap[aid] ? artifactMap[aid].name : aid }}\r\n            </div>\r\n            <div class=\"hand-era\" v-if=\"artifactMap[aid] && (artifactMap[aid].era || artifactMap[aid].location)\">\r\n              {{ artifactMap[aid].era }}<span v-if=\"artifactMap[aid].location\"> · {{ artifactMap[aid].location }}</span>\r\n            </div>\r\n            <div class=\"hand-tags\" v-if=\"artifactMap[aid] && artifactMap[aid].collectionTags && artifactMap[aid].collectionTags.length\">\r\n              <span\r\n                class=\"hand-tag\"\r\n                v-for=\"tag in artifactMap[aid].collectionTags.slice(0,2)\"\r\n                :key=\"tag\"\r\n              >{{ tag }}</span>\r\n              <span class=\"hand-tag more\" v-if=\"artifactMap[aid].collectionTags.length > 2\">+{{ artifactMap[aid].collectionTags.length - 2 }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 收藏集进度：仅展示与自己已拥有奇物相关的收藏集，支持展开查看成员清单 -->\r\n    <div class=\"collections-panel\" v-if=\"gamePhase !== 'preparation'\">\r\n      <div class=\"collections-section\">\r\n        <h4 class=\"collections-title\">收藏集进度</h4>\r\n        <div class=\"collections-list\">\r\n          <div \r\n            v-for=\"collection in collectionsComputed\" \r\n            :key=\"collection.id\"\r\n            class=\"collection-progress-item\"\r\n            :class=\"{ completed: collection._current >= collection.requiredCount }\"\r\n          >\r\n            <div class=\"collection-header\" @click=\"toggleCollection(collection)\">\r\n              <div class=\"collection-icon\">🏆</div>\r\n              <div class=\"collection-info\">\r\n                <div class=\"collection-name\">{{ collection.name }}</div>\r\n                <div class=\"collection-description\">{{ collection.description }}</div>\r\n              </div>\r\n              <div class=\"collection-reward\" v-if=\"collection._current >= collection.requiredCount\">\r\n                <span class=\"reward-badge\">✓</span>\r\n              </div>\r\n            </div>\r\n            <!-- 展开展示该收藏集所需所有商品 -->\r\n            <div class=\"collection-members\" v-if=\"expandedCollections[collection.id]\">\r\n              <div class=\"member-item\" v-for=\"aid in (collection.artifactIds || [])\" :key=\"aid\">\r\n                <img class=\"member-image\" :src=\"artifactMap[aid] ? artifactMap[aid].image : 'https://via.placeholder.com/60x40?text=No+Img'\" />\r\n                <div class=\"member-info\">\r\n                  <div class=\"member-name\">{{ artifactMap[aid] ? artifactMap[aid].name : aid }}</div>\r\n                  <div class=\"member-meta\">{{ artifactMap[aid] && artifactMap[aid].era }}<span v-if=\"artifactMap[aid] && artifactMap[aid].location\"> · {{ artifactMap[aid].location }}</span></div>\r\n                </div>\r\n                <div class=\"member-status\" :class=\"{ owned: currentPlayer && currentPlayer.artifacts && currentPlayer.artifacts.includes(aid) }\">\r\n                  {{ currentPlayer && currentPlayer.artifacts && currentPlayer.artifacts.includes(aid) ? '已拥有' : '未拥有' }}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"progress-container\">\r\n              <div class=\"progress-bar\">\r\n                <div \r\n                  class=\"progress-fill\"\r\n                  :style=\"{ width: collection._progress + '%' }\"\r\n                ></div>\r\n              </div>\r\n              <div class=\"progress-text\">\r\n                {{ collection._current }}/{{ collection.requiredCount }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 聊天/日志面板：合并系统日志与聊天消息为统一时间序信息流 -->\r\n    <div class=\"chat-panel\" v-if=\"gamePhase !== 'preparation'\">\r\n      <div class=\"chat-header\">\r\n        <h4 class=\"chat-title\">聊天 / 日志</h4>\r\n        <div class=\"chat-status\">\r\n          <span class=\"status-dot\"></span>\r\n          <span class=\"status-text\">在线</span>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"chat-messages\" ref=\"chatContainer\">\r\n        <div \r\n          v-for=\"message in chatFeed\" \r\n          :key=\"message.id\"\r\n          class=\"chat-message\"\r\n          :class=\"{ 'own-message': message.type === 'chat' && message.userId === (user && user.id), 'system-log': message.type === 'log' }\"\r\n        >\r\n          <div class=\"message-header\">\r\n            <span class=\"message-username\">{{ message.type === 'log' ? '系统' : message.username }}</span>\r\n            <span class=\"message-time\">{{ formatMessageTime(message.timestamp) }}</span>\r\n          </div>\r\n          <div class=\"message-content\">{{ message.content }}</div>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"chat-input\">\r\n        <input \r\n          v-model=\"newMessage\"\r\n          @keyup.enter=\"sendMessage\"\r\n          placeholder=\"输入消息...\"\r\n          class=\"message-input\"\r\n        />\r\n        <button @click=\"sendMessage\" class=\"send-button\" :disabled=\"!newMessage.trim()\">\r\n          <span class=\"send-icon\">📤</span>\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 卡牌详情弹窗：展示所选奇物的核心信息与标签 -->\r\n    <div v-if=\"showCardDetail\" class=\"card-detail-popup\">\r\n      <div class=\"popup-overlay\" @click=\"hideCardDetail\"></div>\r\n      <div class=\"popup-content\" v-if=\"selectedCard\">\r\n        <img \r\n          class=\"detail-image\" \r\n          :src=\"selectedCard.image\" \r\n          alt=\"奇物图片\"\r\n        />\r\n        <div class=\"detail-content\">\r\n          <h3 class=\"detail-name\">{{ selectedCard.name }}</h3>\r\n          <p class=\"detail-era\">{{ selectedCard.era }} - {{ selectedCard.location }}</p>\r\n          <p class=\"detail-story\">{{ selectedCard.story }}</p>\r\n          <div class=\"detail-tags\">\r\n            <span \r\n              v-for=\"tag in selectedCard.collectionTags\" \r\n              :key=\"tag\"\r\n              class=\"detail-tag\"\r\n            >\r\n              {{ tag }}\r\n            </span>\r\n          </div>\r\n          <p class=\"detail-value\">基础价值: {{ selectedCard.baseValue }}</p>\r\n            \r\n        </div>\r\n        <button class=\"close-button\" @click=\"hideCardDetail\">关闭</button>\r\n      </div>\r\n    </div>\r\n\r\n      <!-- 文物讲述弹层：以角色对白形式讲述 selectedCard 的关键信息 -->\r\n      <div v-if=\"showNarration && selectedCard\" class=\"narration-popup\">\r\n        <div class=\"popup-overlay\" @click=\"closeNarration\"></div>\r\n        <div class=\"popup-content narration-content\">\r\n          <!-- 顶部：文物大图与快速元信息，图片下方显示名称 -->\r\n          <div class=\"artifact-media\" v-if=\"selectedCard\">\r\n            <img class=\"artifact-image-large\" :src=\"selectedCard.image || 'https://via.placeholder.com/800x240?text=Artifact'\" alt=\"artifact\" />\r\n            <div class=\"artifact-quick-meta\">\r\n              <span class=\"badge era\" v-if=\"selectedCard.era\">{{ selectedCard.era }}</span>\r\n              <span class=\"badge location\" v-if=\"selectedCard.location\">{{ selectedCard.location }}</span>\r\n              <span class=\"badge value\" v-if=\"selectedCard.baseValue !== undefined\">价值 {{ selectedCard.baseValue }}</span>\r\n              <span class=\"badge tags\" v-if=\"(selectedCard.collectionTags || []).length\">{{ (selectedCard.collectionTags || []).slice(0,3).join('、') }}</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"artifact-caption\" v-if=\"selectedCard && selectedCard.name\">{{ selectedCard.name }}</div>\r\n\r\n          <!-- 下方：人物与对白一行排列 -->\r\n          <div class=\"narration-dialog\">\r\n            <!-- 左侧：角色大图与姓名 -->\r\n            <div class=\"character-side\" :style=\"{ borderColor: narrationCharacter && narrationCharacter.color ? narrationCharacter.color : '#3b82f6' }\">\r\n              <img class=\"character-image\" :src=\"(narrationCharacter && narrationCharacter.image) || '/images/guide.png'\" />\r\n              <div class=\"character-name\" :style=\"{ color: narrationCharacter && narrationCharacter.color ? narrationCharacter.color : '#3b82f6' }\">\r\n                {{ narrationCharacterName }}\r\n              </div>\r\n            </div>\r\n            <!-- 右侧：对白气泡 -->\r\n            <div class=\"speech-side\">\r\n              <div class=\"speech-bubble\">\r\n                <div class=\"speech-text\">{{ typingText }}</div>\r\n              </div>\r\n              <div class=\"narration-actions\">\r\n                <button class=\"control-button primary\" @click=\"closeNarration\">好的</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n\r\n    <!-- 手牌弹窗：查看某位玩家的手牌缩略（当前仅展示当前玩家持有的真实列表） -->\r\n    <div v-if=\"showHandPopup\" class=\"hand-popup\">\r\n      <div class=\"popup-overlay\" @click=\"hideHand\"></div>\r\n      <div class=\"popup-content\">\r\n        <h3 class=\"hand-title\">{{ handPlayer ? handPlayer.name + ' 的手牌' : '手牌' }}</h3>\r\n        <div class=\"hand-grid\">\r\n          <div v-for=\"aid in (handPlayer ? handPlayer.artifacts : [])\" :key=\"aid\" class=\"hand-card\">\r\n            <img class=\"hand-image\" :src=\"artifactMap[aid] ? artifactMap[aid].image : 'https://via.placeholder.com/160x100?text=未知卡牌'\" />\r\n            <div class=\"hand-name\">{{ artifactMap[aid] ? artifactMap[aid].name : aid }}</div>\r\n          </div>\r\n        </div>\r\n        <button class=\"close-button\" @click=\"hideHand\">关闭</button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 游戏结束对话框：展示最终排名与赢家信息，提供回房或去列表的导航 -->\r\n    <div v-if=\"showGameEndDialog\" class=\"game-end-popup\">\r\n      <div class=\"popup-overlay\" @click=\"closeGameEndDialog\"></div>\r\n      <div class=\"popup-content game-end-content\">\r\n        <div class=\"game-end-header\">\r\n          <div class=\"game-end-icon\">🏆</div>\r\n          <h2 class=\"game-end-title\">游戏结束</h2>\r\n          <p class=\"game-end-subtitle\" v-if=\"winnerInfo\">胜者：{{ winnerInfo.name }} · 总分 {{ winnerInfo.total }}</p>\r\n          <p class=\"game-end-subtitle\" v-else>感谢参与时空旅人拍卖会！</p>\r\n        </div>\r\n        <div class=\"final-scoreboard\" v-if=\"finalScores && finalScores.length\">\r\n          <div class=\"score-row\" v-for=\"(p, idx) in finalScores\" :key=\"p.userId\">\r\n            <div class=\"rank\">{{ idx + 1 }}</div>\r\n            <img class=\"score-avatar\" :src=\"p.avatar\" />\r\n            <div class=\"name\">{{ p.name }}</div>\r\n            <div class=\"detail\">收藏集 {{ p.collectionScore }} + 奇物 {{ p.artifactScore }} = <b>{{ p.total }}</b></div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"game-end-actions\">\r\n          <button class=\"action-button primary\" @click=\"stayInRoom\">\r\n            <span class=\"btn-icon\">🏠</span>\r\n            留在房间\r\n          </button>\r\n          <button class=\"action-button secondary\" @click=\"goToRooms\">\r\n            <span class=\"btn-icon\">📋</span>\r\n            返回房间列表\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapGetters } from 'vuex'\r\nimport AuctionPanel from '../../components/auction-panel/auction-panel.vue'\r\nimport roomService from '../../services/room-service'\r\nimport { getSupabase } from '../../services/supabase-client'\r\nimport auctionService from '../../services/auction-service'\r\nimport { startCountdown, clearCountdown } from '../../features/game/countdown'\r\nimport { loadRoomState as loadRoomStateService } from '../../features/game/room-state.service'\r\nimport { subscribeRoomRealtime as subscribeRoomRealtimeService, unsubscribeRoomRealtime as unsubscribeRoomRealtimeService } from '../../features/game/room-realtime'\r\nimport { startGame as startGameFlow, autoStartAuction as autoStartAuctionFlow } from '../../features/game/auction-flow.service'\r\nimport { sendChatMessage } from '../../features/game/chat.service'\r\nimport { toggleReady as toggleReadyAction, moveToSeat as moveToSeatAction, leaveRoom as leaveRoomAction } from '../../features/game/room-actions.service'\r\nimport { loadArtifacts as loadArtifactsService } from '../../features/game/artifacts.service'\r\nimport { loadCollectionsFromArtifacts, getCurrentCollectionCount as getCollectionCountUtil, getCollectionProgress as getCollectionProgressUtil } from '../../features/game/collections.utils'\r\nimport { formatMessageTime as formatMessageTimeHelper, getAvatarFor as getAvatarForHelper, getNameFor as getNameForHelper } from '../../features/game/ui.helpers'\r\nimport { firstLoginDialogue as firstLoginDialogueConfig, getCurrentLanguage as getCurrentLanguageImported } from '../../config/dialogue-config'\r\nexport default {\r\n  name: 'GameIndex',\r\n  components: {\r\n    AuctionPanel\r\n  },\r\n  data() {\r\n    return {\r\n      selectedCard: null,\r\n      showHandPopup: false,\r\n      handPlayer: null,\r\n      artifactMap: {},\r\n      room: null,\r\n      profileMap: {},\r\n      refreshTimer: null,\r\n      collections: [],\r\n      showGameEndDialog: false,\r\n      finalScores: [],\r\n      winnerInfo: null,\r\n      auctionCountdown: 0,\r\n      auctionTimer: null,\r\n      currentAuction: null,\r\n      // 回合相关（前端实时显示，房主每轮开拍时广播以保持同步）\r\n      roundCount: 0,\r\n      totalRounds: 6,\r\n      chatMessages: [],\r\n      newMessage: '',\r\n      chatChannel: null,\r\n      countdownInProgress: false,\r\n      expandedCollections: {},\r\n      showNarration: false,\r\n      typingText: '',\r\n      typingTimer: null,\r\n      // 存储所有玩家的手牌数据，用于价值计算\r\n      allPlayersArtifacts: {},\r\n      // 文物轮播相关数据\r\n      artifactCarouselData: [],\r\n      currentSlide: 0,\r\n      carouselInterval: null,\r\n      // 音乐控制相关数据\r\n      isMusicPlaying: false,\r\n      audioElement: null,\r\n      musicVolume: 0.5\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState(['gamePhase', 'gameLog', 'showCardDetail', 'user', 'roomId', 'roundCurrent', 'roundTotal']),\r\n    // 将当前玩家注入到渲染上下文，避免模板引用报错\r\n    currentPlayer() { return this.$store.state.currentPlayer },\r\n    isOwner() { return this.room && this.user && this.room.owner_id === this.user.id },\r\n    allReady() {\r\n      const players = (this.room && this.room.room_players) ? this.room.room_players : []\r\n      return players.length > 0 && players.every(p => !!p.is_ready)\r\n    },\r\n    currentUserReady() {\r\n      const user = this.user\r\n      const players = (this.room && this.room.room_players) ? this.room.room_players : []\r\n      if (!user) return false\r\n      const me = players.find(p => p.user_id === user.id)\r\n      return !!(me && me.is_ready)\r\n    },\r\n    playerCount() {\r\n      return (this.room && this.room.room_players) ? this.room.room_players.length : 0\r\n    },\r\n    ownerName() {\r\n      if (!this.room) return '-'\r\n      return this.getNameFor(this.room.owner_id)\r\n    },\r\n    seatCount() { return (this.room && Number(this.room.max_players)) ? Number(this.room.max_players) : 0 },\r\n    seats() {\r\n      const players = (this.room && this.room.room_players) ? this.room.room_players : []\r\n      const max = this.seatCount\r\n      const seats = Array.from({ length: max }, () => ({ player: null }))\r\n      // 放置已设置座位的玩家\r\n      players.forEach(p => {\r\n        const idx = typeof p.seat_index === 'number' ? p.seat_index : -1\r\n        if (idx >= 0 && idx < max && !seats[idx].player) seats[idx].player = p\r\n      })\r\n      // 将未设置座位的玩家依次放到空位\r\n      players.filter(p => typeof p.seat_index !== 'number' || p.seat_index < 0).forEach(p => {\r\n        const emptyIdx = seats.findIndex(s => !s.player)\r\n        if (emptyIdx >= 0) seats[emptyIdx].player = p\r\n      })\r\n      return seats\r\n    },\r\n    gamePhaseText() {\r\n      const phaseMap = {\r\n        'preparation': '准备阶段',\r\n        'countdown': '预倒计时',\r\n        'intermission': '间歇阶段',\r\n        'auction': '拍卖阶段',\r\n        'settlement': '结算阶段'\r\n      }\r\n      return phaseMap[this.gamePhase] || '未知阶段'\r\n    },\r\n   \r\n\r\n    // 根据当前用户手牌计算收藏集显示数据，带缓存字段，便于模板直接引用\r\n    collectionsComputed() {\r\n      const list = Array.isArray(this.collections) ? this.collections : []\r\n      // 仅展示用户手牌中至少包含1件该收藏集的情况\r\n      return list\r\n        .map(col => {\r\n          const current = this.getCurrentCollectionCount(col)\r\n          const progress = Math.min((current / (col.requiredCount || 1)) * 100, 100)\r\n          return { ...col, _current: current, _progress: progress }\r\n        })\r\n        .filter(col => col._current > 0)\r\n    },\r\n\r\n    // 合并聊天与系统日志为同一信息流，按时间排序\r\n    chatFeed() {\r\n      const logs = (this.gameLog || []).map((l, idx) => ({\r\n        id: `log-${l.timestamp || idx}`,\r\n        type: 'log',\r\n        userId: null,\r\n        username: '系统',\r\n        content: l.message,\r\n        timestamp: l.timestamp || 0\r\n      }))\r\n      const chats = (this.chatMessages || []).map(m => ({ ...m, type: 'chat' }))\r\n      const merged = [...logs, ...chats]\r\n      return merged.sort((a, b) => (a.timestamp || 0) - (b.timestamp || 0))\r\n    },\r\n    // 暴露对话配置供模板使用\r\n    firstLoginConfig() { return firstLoginDialogueConfig },\r\n    // 当前讲述角色配置与名称\r\n    narrationCharacterName() { return (this.getCurrentLanguage() === 'zh-CN') ? '美里' : 'Misato' },\r\n    narrationCharacter() {\r\n      const key = this.narrationCharacterName\r\n      const chars = firstLoginDialogueConfig && firstLoginDialogueConfig.characters\r\n      return (chars && chars[key]) ? chars[key] : { image: '/images/guide.png', position: 'right', color: '#3b82f6' }\r\n    }\r\n  },\r\n  async mounted() {\r\n    const roomId = this.$route.query.roomId\r\n    if (roomId) this.$store.commit('SET_ROOM_ID', roomId)\r\n    await this.initializeGame()\r\n    await this.loadRoomState()\r\n    // 立即初始化文物轮播数据，确保准备阶段就有内容\r\n    await this.initializeArtifactCarousel()\r\n    // loadRoomState 中已经调用了 loadAllPlayersArtifacts，这里确保数据加载\r\n    await this.subscribeRoomRealtime()\r\n    // 初始化音乐播放器\r\n    this.initializeMusic()\r\n  },\r\n  beforeDestroy() {\r\n    this.unsubscribeRoomRealtime()\r\n    if (this.refreshTimer) { clearInterval(this.refreshTimer); this.refreshTimer = null }\r\n    if (this.auctionTimer) { clearInterval(this.auctionTimer); this.auctionTimer = null }\r\n    if (this.typingTimer) { clearInterval(this.typingTimer); this.typingTimer = null }\r\n    if (this.carouselInterval) { clearInterval(this.carouselInterval); this.carouselInterval = null }\r\n    // 清理音乐播放器\r\n    this.cleanupMusic()\r\n    this.$set(this, 'auctionCountdown', 0)\r\n  },\r\n  watch: {\r\n    gameLog() {\r\n      this.$nextTick(() => {\r\n        const chatContainer = this.$refs.chatContainer\r\n        if (chatContainer) { chatContainer.scrollTop = chatContainer.scrollHeight }\r\n      })\r\n    },\r\n    // 监听游戏阶段变化，在准备阶段确保轮播数据存在\r\n    gamePhase(newPhase) {\r\n      if (newPhase === 'preparation') {\r\n        this.$nextTick(() => {\r\n          // 如果轮播数据为空，重新初始化\r\n          if (!this.artifactCarouselData || this.artifactCarouselData.length === 0) {\r\n            this.initializeArtifactCarousel()\r\n          } else {\r\n            // 数据已存在，只需确保轮播正常运行\r\n            this.startAutoCarousel()\r\n          }\r\n        })\r\n      } else {\r\n        // 离开准备阶段时停止轮播\r\n        this.stopAutoCarousel()\r\n      }\r\n      \r\n      // 根据游戏阶段调整音乐播放\r\n      this.handleGamePhaseMusic(newPhase)\r\n    }\r\n  },\r\n  methods: {\r\n    // 初始化文物轮播数据（改进版：确保总有内容显示）\r\n    async initializeArtifactCarousel() {\r\n      try {\r\n        console.log('🧭 开始初始化文物轮播数据...')\r\n        \r\n        // 先检查是否有缓存的轮播数据\r\n        if (this.artifactCarouselData && this.artifactCarouselData.length > 0) {\r\n          console.log('📚 使用缓存轮播数据')\r\n          this.startAutoCarousel()\r\n          return\r\n        }\r\n        \r\n        // 直接使用artifacts表获取数据\r\n        const supabase = getSupabase()\r\n        console.log('🔗 获取Supabase实例:', supabase ? '✅ 成功' : '❌ 失败')\r\n        \r\n        console.log('📥 正在从artifacts表获取数据...')\r\n        const { data: artifactData, error: artifactError } = await supabase\r\n          .from('artifacts')\r\n          .select('id, name, era, location, image, base_value')\r\n          .limit(10) // 获取10个文物用于轮播\r\n          \r\n        console.log('📊 从artifacts表获取数据结果:', {\r\n          dataLength: artifactData ? artifactData.length : 0,\r\n          error: artifactError,\r\n          data: artifactData\r\n        })\r\n        \r\n        let finalData = []\r\n        \r\n        if (artifactError) {\r\n          console.error('❌ 从artifacts表获取文物数据失败:', artifactError)\r\n          console.log('🔄 使用模拟数据作为备用...')\r\n          finalData = this.getMockArtifactData()\r\n        } else if (artifactData && artifactData.length > 0) {\r\n          console.log('✅ 成功获取到文物数据:', artifactData.length, '条')\r\n          // 处理真实数据\r\n          finalData = artifactData.map((item, index) => {\r\n            console.log(`📸 处理文物 ${index + 1}:`, item.name, '原始图片URL:', item.image)\r\n            \r\n            // 确保图片URL是完整的URL\r\n            let imageUrl = item.image\r\n            if (imageUrl) {\r\n              if (imageUrl.startsWith('/')) {\r\n                // 相对路径，转换为绝对路径\r\n                console.log('🔄 转换相对路径为绝对路径...')\r\n                if (imageUrl.startsWith('/static/')) {\r\n                  // 静态资源路径，使用项目根路径\r\n                  imageUrl = window.location.origin + imageUrl\r\n                } else {\r\n                  // 其他相对路径，使用Supabase存储路径\r\n                  imageUrl = 'https://tgkzpywukorcwdsbfubw.supabase.co' + imageUrl\r\n                }\r\n              } else if (!imageUrl.startsWith('http')) {\r\n                // 可能是相对路径但缺少斜杠\r\n                console.log('🔄 处理可能缺少斜杠的路径...')\r\n                imageUrl = 'https://tgkzpywukorcwdsbfubw.supabase.co/storage/v1/object/public/' + imageUrl\r\n              }\r\n            }\r\n            \r\n            const processedItem = {\r\n              id: item.id,\r\n              name: item.name,\r\n              era: item.era,\r\n              location: item.location,\r\n              image: imageUrl || 'https://via.placeholder.com/400x300?text=文物预览',\r\n              baseValue: item.base_value\r\n            }\r\n            \r\n            console.log(`✅ 文物 ${index + 1} 处理完成 - 最终图片URL:`, processedItem.image)\r\n            return processedItem\r\n          })\r\n        } else {\r\n          console.log('📭 artifacts表为空，使用模拟数据')\r\n          finalData = this.getMockArtifactData()\r\n        }\r\n        \r\n        // 确保最终数据不为空\r\n        if (finalData.length === 0) {\r\n          console.log('⚠️ 最终数据为空，使用备用模拟数据')\r\n          finalData = this.getMockArtifactData()\r\n        }\r\n        \r\n        this.artifactCarouselData = finalData\r\n        console.log('🎯 最终轮播数据:', this.artifactCarouselData.length, '条')\r\n        console.log('🔄 开始自动轮播...')\r\n        \r\n        // 开始自动轮播\r\n        this.startAutoCarousel()\r\n      } catch (error) {\r\n        console.error('💥 初始化文物轮播失败:', error)\r\n        console.log('🔄 使用模拟数据作为最终备用...')\r\n        // 确保即使出错也有数据展示\r\n        this.artifactCarouselData = this.getMockArtifactData()\r\n        this.startAutoCarousel()\r\n      }\r\n    },\r\n    \r\n    // 获取模拟文物数据（备用方案）\r\n    getMockArtifactData() {\r\n      return [\r\n        {\r\n          id: 'artifact_001',\r\n          name: '唐代秘色瓷',\r\n          era: '唐代',\r\n          location: '中国',\r\n          image: 'https://via.placeholder.com/400x300/f0f0f0/666666?text=唐代秘色瓷',\r\n          baseValue: 8\r\n        },\r\n        {\r\n          id: 'artifact_002',\r\n          name: '达芬奇奇设图',\r\n          era: '文艺复兴',\r\n          location: '意大利',\r\n          image: 'https://via.placeholder.com/400x300/f0f0f0/666666?text=达芬奇奇设图',\r\n          baseValue: 9\r\n        },\r\n        {\r\n          id: 'artifact_003',\r\n          name: '琥珀化石',\r\n          era: '史前',\r\n          location: '波罗的海',\r\n          image: 'https://via.placeholder.com/400x300/f0f0f0/666666?text=琥珀化石',\r\n          baseValue: 6\r\n        },\r\n        {\r\n          id: 'artifact_004',\r\n          name: '维京龙头船',\r\n          era: '维京时代',\r\n          location: '北欧',\r\n          image: 'https://via.placeholder.com/400x300/f0f0f0/666666?text=维京龙头船',\r\n          baseValue: 7\r\n        },\r\n        {\r\n          id: 'artifact_005',\r\n          name: '星盘仪',\r\n          era: '中世纪',\r\n          location: '阿拉伯',\r\n          image: 'https://via.placeholder.com/400x300/f0f0f0/666666?text=星盘仪',\r\n          baseValue: 7\r\n        }\r\n      ]\r\n    },\r\n    \r\n    // 开始自动轮播\r\n    startAutoCarousel() {\r\n      if (this.carouselInterval) {\r\n        clearInterval(this.carouselInterval)\r\n      }\r\n      \r\n      // 确保有数据才开启轮播\r\n      if (!this.artifactCarouselData || this.artifactCarouselData.length === 0) {\r\n        console.log('⚠️ 轮播数据为空，不启动自动轮播')\r\n        return\r\n      }\r\n      \r\n      this.carouselInterval = setInterval(() => {\r\n        this.nextSlide()\r\n      }, 3000) // 每3秒自动切换\r\n    },\r\n    \r\n    // 停止自动轮播\r\n    stopAutoCarousel() {\r\n      if (this.carouselInterval) {\r\n        clearInterval(this.carouselInterval)\r\n        this.carouselInterval = null\r\n      }\r\n    },\r\n    \r\n    // 下一张幻灯片\r\n    nextSlide() {\r\n      if (this.artifactCarouselData && this.artifactCarouselData.length > 0) {\r\n        this.currentSlide = (this.currentSlide + 1) % this.artifactCarouselData.length\r\n      }\r\n    },\r\n    \r\n    // 上一张幻灯片\r\n    prevSlide() {\r\n      if (this.artifactCarouselData && this.artifactCarouselData.length > 0) {\r\n        this.currentSlide = (this.currentSlide - 1 + this.artifactCarouselData.length) % this.artifactCarouselData.length\r\n      }\r\n    },\r\n    \r\n    // 跳转到指定幻灯片\r\n    goToSlide(index) {\r\n      if (this.artifactCarouselData && index >= 0 && index < this.artifactCarouselData.length) {\r\n        this.currentSlide = index\r\n      }\r\n    },\r\n    \r\n    // 处理图片加载错误\r\n    handleImageError(artifact) {\r\n      console.warn(`文物图片加载失败: ${artifact.name}`)\r\n      // 可以设置默认图片或使用占位符\r\n      artifact.image = 'https://via.placeholder.com/400x300?text=文物预览'\r\n    },\r\n\r\n    // 去掉模拟初始化玩家，改为使用房间的实际玩家列表\r\n    async initializeGame() {\r\n      const artifacts = await this.loadArtifacts()\r\n      this.artifactMap = artifacts.reduce((acc, a) => { acc[a.id] = a; return acc }, {})\r\n      await this.loadCollections()\r\n    },\r\n    async subscribeRoomRealtime() {\r\n      const rid = this.$store.state.roomId\r\n      if (!rid) return\r\n      const supabase = getSupabase()\r\n      const { roomChannel, broadcastChannel } = subscribeRoomRealtimeService(\r\n        { roomId: rid, supabase, onLoadRoomState: this.loadRoomState },\r\n        {\r\n          onGameStarted: async (_payload) => {\r\n            // 防止重复启动多个倒计时\r\n            if (this.countdownInProgress) return\r\n            this.countdownInProgress = true\r\n            \r\n            // 新局开始：重置聊天消息和价值数据\r\n            this.chatMessages = []\r\n            this.allPlayersArtifacts = {}\r\n            // 重置回合数\r\n            this.$store.commit('RESET_ROUND')\r\n            this.$store.commit('SET_ROUND_TOTAL', 6)\r\n            \r\n            this.$store.commit('SET_GAME_PHASE', 'countdown')\r\n            this.$set(this, 'auctionCountdown', 5)\r\n            const me = (this.room && this.room.room_players ? this.room.room_players : []).find(p => p.user_id === this.$store.state.user.id)\r\n            if (me) {\r\n              this.$store.commit('SET_CURRENT_PLAYER', { id: me.user_id, name: this.getNameFor(me.user_id), energy: 50, artifacts: [], items: [] })\r\n            }\r\n            if (this.auctionTimer) { clearInterval(this.auctionTimer); this.auctionTimer = null }\r\n            this.$nextTick(() => {\r\n              startCountdown({\r\n                seconds: 5,\r\n                onTick: (s) => { this.$set(this, 'auctionCountdown', s) },\r\n                onDone: async () => { this.countdownInProgress = false; if (this.isOwner) { await this.autoStartAuction() } },\r\n                getRef: () => this.auctionTimer,\r\n                setRef: (id) => { this.auctionTimer = id },\r\n              })\r\n            })\r\n          },\r\n          onAuctionStarted: async (duration, payload) => { \r\n            // 确保所有玩家都能看到拍卖数据\r\n            await this.loadRoomState()\r\n            \r\n            // 同步回合数（如果广播中包含了回合信息）\r\n            if (payload && typeof payload.roundCurrent === 'number') {\r\n              this.$store.commit('SET_ROUND_CURRENT', payload.roundCurrent)\r\n            }\r\n            if (payload && typeof payload.roundTotal === 'number') {\r\n              this.$store.commit('SET_ROUND_TOTAL', payload.roundTotal)\r\n            }\r\n            \r\n            this.startAuctionTimer(duration) \r\n          },\r\n          onBidUpdate: ({ auctionId, highestBid, highestBidder }) => {\r\n            if (!auctionId) return\r\n            const list = this.$store.state.currentAuctions || []\r\n            const idx = list.findIndex(a => a.id === auctionId)\r\n            if (idx >= 0) {\r\n              const next = { ...list[idx], highestBid, highestBidder }\r\n              this.$store.commit('ADD_OR_UPDATE_AUCTION', next)\r\n            }\r\n          },\r\n          // 旧回合广播已移除，统一本地推进，不再接收该事件\r\n          onRoundUpdated: (_data) => {},\r\n          onGameEnded: () => {\r\n            this.$store.commit('SET_GAME_PHASE', 'settlement')\r\n        this.computeFinalScores().finally(() => { this.showGameEndDialog = true })\r\n            if (this.auctionTimer) { clearInterval(this.auctionTimer); this.auctionTimer = null }\r\n          },\r\n          onAuctionEnded: async () => { await this.loadRoomState() },\r\n          onChatMessage: (message) => {\r\n            // 避免重复添加消息\r\n            if (!message || !message.id) return\r\n            const existing = this.chatMessages.find(m => m.id === message.id || (m.userId === message.userId && m.timestamp === message.timestamp && m.content === message.content))\r\n            if (existing) return\r\n            \r\n            this.chatMessages.push(message)\r\n            this.$nextTick(() => {\r\n              const chatContainer = this.$refs.chatContainer\r\n              if (chatContainer) { chatContainer.scrollTop = chatContainer.scrollHeight }\r\n            })\r\n          },\r\n        },\r\n        () => { if (!this.refreshTimer) { this.refreshTimer = setInterval(this.loadRoomState, 1000) } }\r\n      )\r\n      this.roomChannel = roomChannel\r\n      this.broadcastChannel = broadcastChannel\r\n    },\r\n    unsubscribeRoomRealtime() {\r\n      unsubscribeRoomRealtimeService(this.roomChannel, this.broadcastChannel)\r\n      this.roomChannel = null\r\n      this.broadcastChannel = null\r\n    },\r\n    async loadRoomState() {\r\n      const rid = this.$store.state.roomId\r\n      const supabase = getSupabase()\r\n      await loadRoomStateService({\r\n        roomId: rid,\r\n        roomService,\r\n        supabase,\r\n        artifactMap: this.artifactMap,\r\n        store: this.$store,\r\n        setRoom: (room) => { this.room = room },\r\n        setProfileMap: (map) => { this.profileMap = map },\r\n        setGamePhase: (phase) => { this.$store.commit('SET_GAME_PHASE', phase) },\r\n        clearAuctionTimer: () => { if (this.auctionTimer) { clearInterval(this.auctionTimer); this.auctionTimer = null } },\r\n        setAuctionCountdown: (n) => { this.$set(this, 'auctionCountdown', n) },\r\n        onShowGameEnd: () => { this.showGameEndDialog = true; setTimeout(() => { this.handleGameEnd() }, 3000) },\r\n      })\r\n      // 加载所有玩家的手牌数据，用于价值计算\r\n      await this.loadAllPlayersArtifacts()\r\n      // 如果刷新后发现仍有活跃拍卖，但本地无倒计时，则用当前剩余时间启动统一倒计时\r\n      const auctions = this.$store.state.currentAuctions || []\r\n      if (this.$store.state.gamePhase === 'auction' && auctions.length > 0) {\r\n        const remaining = Number(this.auctionCountdown || 0)\r\n        if (!this.auctionTimer && remaining > 0) {\r\n          startCountdown({\r\n            seconds: remaining,\r\n            onTick: (s) => { this.$set(this, 'auctionCountdown', s); },\r\n            onDone: async () => { await this.onAuctionTimeUp() },\r\n            getRef: () => this.auctionTimer,\r\n            setRef: (id) => { this.auctionTimer = id },\r\n          })\r\n        }\r\n      }\r\n    },\r\n    \r\n    // 加载所有玩家的手牌数据\r\n    async loadAllPlayersArtifacts() {\r\n      try {\r\n        const rid = this.$store.state.roomId\r\n        if (!rid) {\r\n          this.allPlayersArtifacts = {}\r\n          return\r\n        }\r\n        \r\n        const supabase = getSupabase()\r\n        // 获取房间内所有玩家的手牌数据\r\n        const { data: allArtifacts } = await supabase\r\n          .from('room_artifacts')\r\n          .select('owner_user_id, artifact_id')\r\n          .eq('room_id', rid)\r\n        \r\n        // 按玩家ID分组\r\n        const playerArtifactsMap = {}\r\n        if (allArtifacts && allArtifacts.length > 0) {\r\n          allArtifacts.forEach(row => {\r\n            const userId = row.owner_user_id\r\n            if (!playerArtifactsMap[userId]) {\r\n              playerArtifactsMap[userId] = []\r\n            }\r\n            playerArtifactsMap[userId].push(row.artifact_id)\r\n          })\r\n        }\r\n        \r\n        // 使用 Vue.set 确保响应式更新\r\n        this.$set(this, 'allPlayersArtifacts', playerArtifactsMap)\r\n      } catch (e) {\r\n        console.warn('[game] loadAllPlayersArtifacts failed', e)\r\n        this.allPlayersArtifacts = {}\r\n      }\r\n    },\r\n    async toggleReady() {\r\n      try {\r\n        const rid = this.$store.state.roomId\r\n        const uid = this.$store.state.user && this.$store.state.user.id\r\n        if (!rid || !uid) return\r\n        await toggleReadyAction({ roomId: rid, userId: uid, room: this.room, roomService, reload: this.loadRoomState })\r\n      } catch (e) { console.warn('[game] toggleReady failed', e) }\r\n    },\r\n    async moveToSeat(idx) {\r\n      try {\r\n        const rid = this.$store.state.roomId\r\n        const uid = this.$store.state.user && this.$store.state.user.id\r\n        if (!rid || !uid) return\r\n        const targetSeat = { index: idx, player: this.seats[idx] && this.seats[idx].player }\r\n        await moveToSeatAction({ roomId: rid, userId: uid, room: this.room, seats: targetSeat, roomService, reload: this.loadRoomState })\r\n      } catch (e) { console.warn('[game] moveToSeat failed', e) }\r\n    },\r\n    async leaveRoom() {\r\n      try {\r\n        const rid = this.$store.state.roomId\r\n        const uid = this.$store.state.user && this.$store.state.user.id\r\n        if (!rid || !uid) return\r\n        await leaveRoomAction({\r\n          roomId: rid,\r\n          userId: uid,\r\n          clearAuctionTimer: () => { if (this.auctionTimer) { clearInterval(this.auctionTimer); this.auctionTimer = null } },\r\n          setCountdown: (n) => { this.$set(this, 'auctionCountdown', n) },\r\n          store: this.$store,\r\n          auctionService,\r\n          roomService,\r\n          unsubscribe: () => this.unsubscribeRoomRealtime(),\r\n          setRoomId: (v) => this.$store.commit('SET_ROOM_ID', v),\r\n          setLocalRoom: (v) => { this.room = v },\r\n          navigateToRooms: () => this.$router.push('/rooms'),\r\n        })\r\n      } catch (e) { console.warn('[game] leaveRoom failed', e) }\r\n    },\r\n    \r\n    // 游戏结束处理\r\n    async handleGameEnd() {\r\n      try {\r\n        const rid = this.$store.state.roomId\r\n        if (rid) {\r\n          // 将房间状态重置为 waiting，便于继续房间内准备/新一局\r\n          const supabase = getSupabase()\r\n          await supabase.from('rooms').update({ status: 'waiting' }).eq('id', rid)\r\n          // 跳转回房间页面（游戏页携带 roomId 即是房间界面）\r\n          this.$router.push({ path: '/game', query: { roomId: rid, gameEnded: 'true' } })\r\n        } else {\r\n          this.$router.push('/rooms')\r\n        }\r\n      } catch (e) {\r\n        console.warn('[game] handleGameEnd failed', e)\r\n        // 兜底跳回房间列表\r\n        this.$router.push('/rooms')\r\n      }\r\n    },\r\n\r\n    // 音乐控制相关方法\r\n    initializeMusic() {\r\n      try {\r\n        // 创建音频元素\r\n        this.audioElement = new Audio('/images/bgm.mp3')\r\n        this.audioElement.loop = true\r\n        this.audioElement.volume = this.musicVolume\r\n        \r\n        // 监听音频播放状态\r\n        this.audioElement.addEventListener('loadeddata', () => {\r\n          console.log('🎵 背景音乐加载完成')\r\n        })\r\n        \r\n        this.audioElement.addEventListener('error', (e) => {\r\n          console.error('🎵 背景音乐加载失败:', e)\r\n        })\r\n        \r\n        // 尝试自动播放（需要用户交互后才能生效）\r\n        this.audioElement.load()\r\n      } catch (error) {\r\n        console.error('🎵 初始化音乐播放器失败:', error)\r\n      }\r\n    },\r\n    \r\n    toggleMusic() {\r\n      if (!this.audioElement) return\r\n      \r\n      if (this.isMusicPlaying) {\r\n        this.pauseMusic()\r\n      } else {\r\n        this.playMusic()\r\n      }\r\n    },\r\n    \r\n    async playMusic() {\r\n      if (!this.audioElement) return\r\n      \r\n      try {\r\n        await this.audioElement.play()\r\n        this.isMusicPlaying = true\r\n        console.log('🎵 背景音乐开始播放')\r\n      } catch (error) {\r\n        console.warn('🎵 音乐播放失败，可能需要用户交互:', error)\r\n        // 如果是自动播放策略导致的失败，我们仍将状态标记为播放\r\n        this.isMusicPlaying = true\r\n      }\r\n    },\r\n    \r\n    pauseMusic() {\r\n      if (!this.audioElement) return\r\n      \r\n      this.audioElement.pause()\r\n      this.isMusicPlaying = false\r\n      console.log('🎵 背景音乐暂停')\r\n    },\r\n    \r\n    setVolume(volume) {\r\n      this.musicVolume = Math.max(0, Math.min(1, volume))\r\n      if (this.audioElement) {\r\n        this.audioElement.volume = this.musicVolume\r\n      }\r\n    },\r\n    \r\n    cleanupMusic() {\r\n      if (this.audioElement) {\r\n        this.pauseMusic()\r\n        this.audioElement = null\r\n      }\r\n    },\r\n    \r\n    // 根据游戏阶段处理音乐播放\r\n    handleGamePhaseMusic(phase) {\r\n      if (!this.audioElement) return\r\n      \r\n      // 只有在音乐正在播放时才需要根据阶段调整\r\n      if (!this.isMusicPlaying) return\r\n      \r\n      switch (phase) {\r\n        case 'preparation':\r\n          // 准备阶段：正常播放\r\n          this.setVolume(0.5)\r\n          break\r\n        case 'countdown':\r\n        case 'intermission':\r\n          // 倒计时和间歇阶段：降低音量\r\n          this.setVolume(0.3)\r\n          break\r\n        case 'auction':\r\n          // 拍卖阶段：正常音量\r\n          this.setVolume(0.5)\r\n          break\r\n        case 'item':\r\n          // 道具阶段：稍微降低音量\r\n          this.setVolume(0.4)\r\n          break\r\n        case 'settlement':\r\n          // 结算阶段：降低音量\r\n          this.setVolume(0.3)\r\n          break\r\n        default:\r\n          this.setVolume(0.5)\r\n      }\r\n    },\r\n\r\n    // 音乐控制相关方法\r\n    initializeMusic() {\r\n      try {\r\n        // 创建音频元素\r\n        this.audioElement = new Audio('/images/bgm.mp3')\r\n        this.audioElement.loop = true\r\n        this.audioElement.volume = this.musicVolume\r\n        \r\n        // 监听音频播放状态\r\n        this.audioElement.addEventListener('loadeddata', () => {\r\n          console.log('🎵 背景音乐加载完成')\r\n        })\r\n        \r\n        this.audioElement.addEventListener('error', (e) => {\r\n          console.error('🎵 背景音乐加载失败:', e)\r\n        })\r\n        \r\n        // 尝试自动播放（需要用户交互后才能生效）\r\n        this.audioElement.load()\r\n      } catch (error) {\r\n        console.error('🎵 初始化音乐播放器失败:', error)\r\n      }\r\n    },\r\n    \r\n    toggleMusic() {\r\n      if (!this.audioElement) return\r\n      \r\n      if (this.isMusicPlaying) {\r\n        this.pauseMusic()\r\n      } else {\r\n        this.playMusic()\r\n      }\r\n    },\r\n    \r\n    async playMusic() {\r\n      if (!this.audioElement) return\r\n      \r\n      try {\r\n        await this.audioElement.play()\r\n        this.isMusicPlaying = true\r\n        console.log('🎵 背景音乐开始播放')\r\n      } catch (error) {\r\n        console.warn('🎵 音乐播放失败，可能需要用户交互:', error)\r\n        // 如果是自动播放策略导致的失败，我们仍将状态标记为播放\r\n        this.isMusicPlaying = true\r\n      }\r\n    },\r\n    \r\n    pauseMusic() {\r\n      if (!this.audioElement) return\r\n      \r\n      this.audioElement.pause()\r\n      this.isMusicPlaying = false\r\n      console.log('🎵 背景音乐暂停')\r\n    },\r\n    \r\n    setVolume(volume) {\r\n      this.musicVolume = Math.max(0, Math.min(1, volume))\r\n      if (this.audioElement) {\r\n        this.audioElement.volume = this.musicVolume\r\n      }\r\n    },\r\n    \r\n    cleanupMusic() {\r\n      if (this.audioElement) {\r\n        this.pauseMusic()\r\n        this.audioElement = null\r\n      }\r\n    },\r\n    \r\n    // 根据游戏阶段处理音乐播放\r\n    handleGamePhaseMusic(phase) {\r\n      if (!this.audioElement) return\r\n      \r\n      // 只有在音乐正在播放时才需要根据阶段调整\r\n      if (!this.isMusicPlaying) return\r\n      \r\n      switch (phase) {\r\n        case 'preparation':\r\n          // 准备阶段：正常播放\r\n          this.setVolume(0.5)\r\n          break\r\n        case 'countdown':\r\n        case 'intermission':\r\n          // 倒计时和间歇阶段：降低音量\r\n          this.setVolume(0.3)\r\n          break\r\n        case 'auction':\r\n          // 拍卖阶段：正常音量\r\n          this.setVolume(0.5)\r\n          break\r\n        case 'item':\r\n          // 道具阶段：稍微降低音量\r\n          this.setVolume(0.4)\r\n          break\r\n        case 'settlement':\r\n          // 结算阶段：降低音量\r\n          this.setVolume(0.3)\r\n          break\r\n        default:\r\n          this.setVolume(0.5)\r\n      }\r\n    },\r\n    async startGame() {\r\n      try {\r\n        const rid = this.$store.state.roomId\r\n        const uid = this.$store.state.user && this.$store.state.user.id\r\n        if (!rid || !uid || !this.isOwner || !this.allReady) return\r\n        // 新局开始前重置系统日志、聊天消息和价值数据\r\n        try { this.$store.commit('CLEAR_GAME_LOG') } catch (_) {}\r\n        this.chatMessages = []\r\n        this.allPlayersArtifacts = {}\r\n        await roomService.startGame(rid, uid)\r\n        const supabase = getSupabase()\r\n        this.roundCount = 0\r\n        await startGameFlow({\r\n          roomId: rid,\r\n          userId: uid,\r\n          isOwner: this.isOwner,\r\n          allReady: this.allReady,\r\n          store: this.$store,\r\n          supabase,\r\n          setCountdown: (n) => this.$set(this, 'auctionCountdown', n),\r\n          setCurrentPlayerFromRoom: () => {\r\n            const me = (this.room && this.room.room_players ? this.room.room_players : []).find(p => p.user_id === uid)\r\n            if (me) { this.$store.commit('SET_CURRENT_PLAYER', { id: me.user_id, name: this.getNameFor(me.user_id), energy: 50, artifacts: [], items: [] }) }\r\n          },\r\n          onCountdownDone: async () => {\r\n            if (this.isOwner) { await this.autoStartAuction() }\r\n          },\r\n        })\r\n        // 房主本地也启动预倒计时，防止广播不回传导致不触发 onGameStarted\r\n        if (!this.countdownInProgress) {\r\n          this.countdownInProgress = true\r\n          // 确保本地也重置数据\r\n          this.chatMessages = []\r\n          this.allPlayersArtifacts = {}\r\n          this.$store.commit('SET_GAME_PHASE', 'countdown')\r\n          this.$set(this, 'auctionCountdown', 5)\r\n          const me = (this.room && this.room.room_players ? this.room.room_players : []).find(p => p.user_id === uid)\r\n          if (me) {\r\n            this.$store.commit('SET_CURRENT_PLAYER', { id: me.user_id, name: this.getNameFor(me.user_id), energy: 50, artifacts: [], items: [] })\r\n          }\r\n          if (this.auctionTimer) { clearInterval(this.auctionTimer); this.auctionTimer = null }\r\n          this.$nextTick(() => {\r\n            startCountdown({\r\n              seconds: 5,\r\n              onTick: (s) => { this.$set(this, 'auctionCountdown', s) },\r\n              onDone: async () => { this.countdownInProgress = false; if (this.isOwner) { await this.autoStartAuction() } },\r\n              getRef: () => this.auctionTimer,\r\n              setRef: (id) => { this.auctionTimer = id },\r\n            })\r\n          })\r\n        }\r\n      } catch (e) { console.warn('[game] startGame failed', e) }\r\n    },\r\n    \r\n    async startAuction() {\r\n      // 同时抽取多件进行拍卖（示例为2件）\r\n      const artifacts = await this.loadArtifacts()\r\n      if (artifacts.length > 0) {\r\n        const picks = []\r\n        while (picks.length < Math.min(2, artifacts.length)) {\r\n          const candidate = artifacts[Math.floor(Math.random() * artifacts.length)]\r\n          if (!picks.find(p => p.id === candidate.id)) picks.push(candidate)\r\n        }\r\n        for (const art of picks) {\r\n          await this.$store.dispatch('startAuction', art)\r\n        }\r\n      }\r\n    },\r\n    \r\n    async loadArtifacts() {\r\n      try {\r\n        const supabase = getSupabase()\r\n        return await loadArtifactsService({ supabase })\r\n      } catch (error) { console.error('加载卡牌数据失败:', error); return [] }\r\n    },\r\n    \r\n    showArtifactDetail(artifactId) {\r\n      // 若已加载artifactMap，则优先展示真实数据\r\n      const artifact = this.artifactMap[artifactId]\r\n      if (artifact) {\r\n        this.selectedCard = artifact\r\n      } else {\r\n        // 回退：维持原示例\r\n        this.selectedCard = {\r\n          id: artifactId,\r\n          name: '示例奇物',\r\n          era: '古代',\r\n          location: '未知',\r\n          story: '这是一个神秘的奇物...',\r\n          collectionTags: ['艺术瑰宝'],\r\n          baseValue: 8,\r\n          image: 'https://via.placeholder.com/300x200?text=示例奇物'\r\n        }\r\n      }\r\n      this.$store.commit('SET_SHOW_CARD_DETAIL', true)\r\n    },\r\n    \r\n    hideCardDetail() {\r\n      this.$store.commit('SET_SHOW_CARD_DETAIL', false)\r\n      this.selectedCard = null\r\n    },\r\n    showArtifactDetailFromAuction(artifact) {\r\n      this.selectedCard = artifact\r\n      this.$store.commit('SET_SHOW_CARD_DETAIL', false)\r\n      this.openNarration()\r\n    },\r\n    // 计算玩家总价值（支持所有玩家）\r\n    getPlayerTotalValue(userId) {\r\n      if (!userId) return 0\r\n      \r\n      // 优先从 allPlayersArtifacts 获取所有玩家的手牌数据\r\n      let owned = []\r\n      if (this.allPlayersArtifacts && this.allPlayersArtifacts[userId]) {\r\n        owned = Array.isArray(this.allPlayersArtifacts[userId]) ? this.allPlayersArtifacts[userId] : []\r\n      } else {\r\n        // 回退：如果 allPlayersArtifacts 中没有，尝试从当前玩家数据获取\r\n        const current = this.$store.state.currentPlayer\r\n        if (current && current.id === userId) {\r\n          owned = Array.isArray(this.$store.state.playerArtifacts) ? this.$store.state.playerArtifacts : []\r\n        }\r\n      }\r\n      \r\n      if (!owned || owned.length === 0) return 0\r\n      \r\n      // 确保 artifactMap 已加载\r\n      if (!this.artifactMap || Object.keys(this.artifactMap).length === 0) return 0\r\n      \r\n      let total = 0\r\n      owned.forEach(aid => {\r\n        const a = this.artifactMap[aid]\r\n        if (a && typeof a.baseValue === 'number') {\r\n          total += a.baseValue\r\n        }\r\n      })\r\n      return total\r\n    },\r\n\r\n    showPlayerHand(player) {\r\n      // 构造玩家对象，包含手牌信息\r\n      const playerData = {\r\n        id: player.user_id,\r\n        name: this.getNameFor(player.user_id),\r\n        artifacts: this.currentPlayer && this.currentPlayer.id === player.user_id ? \r\n          (this.currentPlayer.artifacts || []) : []\r\n      }\r\n      this.handPlayer = playerData\r\n      this.showHandPopup = true\r\n    },\r\n\r\n    hideHand() {\r\n      this.handPlayer = null\r\n      this.showHandPopup = false\r\n    },\r\n    \r\n    \r\n    getAvatarFor(userId) { return getAvatarForHelper({ profileMap: this.profileMap, userId }) },\r\n    getNameFor(userId) { return getNameForHelper({ profileMap: this.profileMap, room: this.room, userId }) },\r\n    getCurrentLanguage() { return getCurrentLanguageImported() },\r\n    \r\n    // 加载收藏集数据：基于数据库 artifacts 的 collection_tags 动态生成\r\n    async loadCollections() {\r\n      try { this.collections = loadCollectionsFromArtifacts(this.artifactMap) }\r\n      catch (error) { console.error('加载收藏集数据失败:', error); this.collections = [] }\r\n    },\r\n    \r\n   \r\n    \r\n    // 获取当前收藏集数量（基于当前用户手牌，且受最大要求数上限限制）\r\n    getCurrentCollectionCount(collection) {\r\n      const owned = (this.currentPlayer && this.currentPlayer.artifacts) ? this.currentPlayer.artifacts : []\r\n      return getCollectionCountUtil({ artifactMap: this.artifactMap, ownedArtifactIds: owned, collection })\r\n    },\r\n\r\n\r\n    // 展开/收起收藏集\r\n    toggleCollection(collection) {\r\n      const id = collection && collection.id\r\n      if (!id) return\r\n      this.$set(this.expandedCollections, id, !this.expandedCollections[id])\r\n    },\r\n    \r\n    // 关闭游戏结束对话框\r\n    closeGameEndDialog() {\r\n      this.showGameEndDialog = false\r\n    },\r\n    \r\n    // 留在房间\r\n    stayInRoom() {\r\n      this.showGameEndDialog = false\r\n      try { this.$store.commit('CLEAR_GAME_LOG') } catch (_) {}\r\n      // 返回当前房间准备界面\r\n      const rid = this.$store.state.roomId\r\n      if (rid) {\r\n        this.$store.commit('SET_GAME_PHASE', 'preparation')\r\n        this.$router.push({ path: '/game', query: { roomId: rid } })\r\n      }\r\n    },\r\n    \r\n    // 返回房间列表\r\n    goToRooms() {\r\n      this.showGameEndDialog = false\r\n      this.unsubscribeRoomRealtime()\r\n      try { this.$store.commit('CLEAR_GAME_LOG') } catch (_) {}\r\n      // 返回当前房间准备界面（更符合期望）\r\n      const rid = this.$store.state.roomId\r\n      if (rid) {\r\n        this.$store.commit('SET_GAME_PHASE', 'preparation')\r\n        this.$router.push({ path: '/game', query: { roomId: rid } })\r\n      } else {\r\n        this.$router.push('/rooms')\r\n      }\r\n    },\r\n    \r\n    // 时间到：结束当前所有拍卖并结算到对应玩家手牌，然后进入10s间歇或结束游戏\r\n    async onAuctionTimeUp() {\r\n      try {\r\n        const auctions = this.$store.state.currentAuctions || []\r\n        // 统一倒计时结束：结束所有当前拍卖\r\n        for (const a of auctions) {\r\n          await this.$store.dispatch('endAuction', a.id)\r\n        }\r\n        // 判断是否达到总回合数\r\n        const cur = Number(this.$store.state.roundCurrent || 0)\r\n        const tot = Number(this.$store.state.roundTotal || 6)\r\n        if (cur >= tot) {\r\n          // 触发结束\r\n          this.$store.commit('SET_GAME_PHASE', 'settlement')\r\n          await this.computeFinalScores()\r\n          this.showGameEndDialog = true\r\n          return\r\n        }\r\n        // 否则进入10s间歇阶段\r\n        this.startIntermissionTimer(10)\r\n      } catch (e) { console.warn('[game] onAuctionTimeUp failed', e) }\r\n    },\r\n\r\n    // 开始拍卖倒计时：统一每轮拍卖只有一个倒计时\r\n    startAuctionTimer(duration = 30) {\r\n      this.$store.commit('SET_GAME_PHASE', 'auction')\r\n      startCountdown({\r\n        seconds: duration,\r\n        onTick: (s) => { this.$set(this, 'auctionCountdown', s); },\r\n        onDone: async () => { await this.onAuctionTimeUp() },\r\n        getRef: () => this.auctionTimer,\r\n        setRef: (id) => { this.auctionTimer = id },\r\n      })\r\n    },\r\n\r\n\r\n    \r\n    // 每轮之间的间歇计时器，结束后自动开始下一轮拍卖\r\n    startIntermissionTimer(duration = 10) {\r\n      this.$store.commit('SET_GAME_PHASE', 'intermission')\r\n      startCountdown({\r\n        seconds: duration,\r\n        onTick: (s) => { this.$set(this, 'auctionCountdown', s); },\r\n        onDone: async () => {\r\n          if (this.isOwner) {\r\n            await this.autoStartAuction()\r\n          }\r\n        },\r\n        getRef: () => this.auctionTimer,\r\n        setRef: (id) => { this.auctionTimer = id },\r\n      })\r\n    },\r\n    \r\n    // 自动开始拍卖\r\n    async autoStartAuction() {\r\n      try {\r\n        const rid = this.$store.state.roomId\r\n        const supabase = getSupabase()\r\n        await autoStartAuctionFlow({\r\n          roomId: rid,\r\n          store: this.$store,\r\n          supabase,\r\n          loadArtifacts: () => this.loadArtifacts(),\r\n          dispatchStartAuction: (art) => this.$store.dispatch('startAuction', art),\r\n          startAuctionTimer: (sec) => this.startAuctionTimer(sec),\r\n          roundCount: this.roundCount,\r\n          totalRounds: this.totalRounds,\r\n          setRoundCount: (n) => { this.roundCount = n },\r\n        })\r\n      } catch (e) { console.warn('[game] autoStartAuction failed', e) }\r\n    },\r\n    \r\n    // 发送聊天消息\r\n    async sendMessage() {\r\n      if (!this.newMessage.trim() || !this.user) return\r\n      const message = { \r\n        id: Date.now(), \r\n        userId: this.user.id, \r\n        username: this.getNameFor(this.user.id), \r\n        content: this.newMessage.trim(), \r\n        timestamp: Date.now() \r\n      }\r\n      // 本地立即显示，提供即时反馈\r\n      this.chatMessages.push(message)\r\n      this.newMessage = ''\r\n      \r\n      // 滚动到底部\r\n      this.$nextTick(() => {\r\n        const chatContainer = this.$refs.chatContainer\r\n        if (chatContainer) { chatContainer.scrollTop = chatContainer.scrollHeight }\r\n      })\r\n      \r\n      // 发送到服务器，广播给所有玩家\r\n      const rid = this.$store.state.roomId\r\n      if (rid) { \r\n        try { \r\n          const supabase = getSupabase()\r\n          await sendChatMessage({ supabase, roomId: rid, message }) \r\n        } catch (e) { \r\n          console.warn('[game] sendMessage failed', e)\r\n          // 发送失败时，可以选择移除本地消息或保留（保留提供更好的用户体验）\r\n        } \r\n      }\r\n    },\r\n    \r\n    // 格式化消息时间\r\n    formatMessageTime(timestamp) { return formatMessageTimeHelper(timestamp) }\r\n    ,\r\n\r\n    // 计算最终得分并确定赢家\r\n    async computeFinalScores() {\r\n      try {\r\n        const rid = this.$store.state.roomId\r\n        if (!rid) return\r\n        const supabase = getSupabase()\r\n        const { data: rows } = await supabase\r\n          .from('room_artifacts')\r\n          .select('owner_user_id, artifact_id')\r\n          .eq('room_id', rid)\r\n        const userToArtifacts = {}\r\n        ;(rows || []).forEach(r => {\r\n          if (!userToArtifacts[r.owner_user_id]) userToArtifacts[r.owner_user_id] = []\r\n          userToArtifacts[r.owner_user_id].push(r.artifact_id)\r\n        })\r\n\r\n        const collections = Array.isArray(this.collections) ? this.collections : []\r\n        const scores = Object.keys(userToArtifacts).map(uid => {\r\n          const owned = userToArtifacts[uid]\r\n          // 收藏集分数\r\n          let collectionScore = 0\r\n          collections.forEach(col => {\r\n            const current = getCollectionCountUtil({ artifactMap: this.artifactMap, ownedArtifactIds: owned, collection: col })\r\n            if (current >= (col.requiredCount || 1)) collectionScore += (col.rewardPoints || 0)\r\n          })\r\n          // 零散奇物分数（基础价值一半，向下取整）\r\n          let artifactScore = 0\r\n          owned.forEach(aid => {\r\n            const a = this.artifactMap[aid]\r\n            if (a && typeof a.baseValue === 'number') artifactScore += Math.floor(a.baseValue / 2)\r\n          })\r\n        \r\n          const total = collectionScore + artifactScore\r\n          return {\r\n            userId: uid,\r\n            name: this.getNameFor(uid),\r\n            avatar: this.getAvatarFor(uid),\r\n            collectionScore,\r\n            artifactScore,\r\n            total\r\n          }\r\n        })\r\n\r\n        const sorted = scores.sort((a, b) => b.total - a.total)\r\n        this.finalScores = sorted\r\n        this.winnerInfo = sorted[0] || null\r\n\r\n        if (this.winnerInfo) {\r\n          this.$store.commit('ADD_GAME_LOG', { timestamp: Date.now(), message: `本局结束，胜者：${this.winnerInfo.name}（总分 ${this.winnerInfo.total}）` })\r\n        }\r\n      } catch (e) { console.warn('[game] computeFinalScores failed', e) }\r\n    },\r\n\r\n    // 开启/关闭文物讲述\r\n    openNarration() {\r\n      // 构造讲述文本，包含基本介绍 + 故事\r\n      const base = `${this.selectedCard.name}，来自 ${this.selectedCard.era}${this.selectedCard.location ? ' · ' + this.selectedCard.location : ''}。\\n`\r\n      const story = (this.selectedCard.story || '').trim()\r\n      const full = `${base}${story}`.trim()\r\n      // 打字机效果\r\n      this.typingText = ''\r\n      this.showNarration = true\r\n      const speed = (firstLoginDialogueConfig && firstLoginDialogueConfig.animations && firstLoginDialogueConfig.animations.textTypingSpeed) || 30\r\n      if (this.typingTimer) { clearInterval(this.typingTimer); this.typingTimer = null }\r\n      let i = 0\r\n      this.typingTimer = setInterval(() => {\r\n        if (i >= full.length) {\r\n          clearInterval(this.typingTimer)\r\n          this.typingTimer = null\r\n        } else {\r\n          this.typingText += full[i]\r\n          i += 1\r\n        }\r\n      }, speed)\r\n    },\r\n    closeNarration() {\r\n      if (this.typingTimer) { clearInterval(this.typingTimer); this.typingTimer = null }\r\n      this.showNarration = false\r\n      this.typingText = ''\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped src=\"./index.scss\"></style>"],"mappings":"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","ignoreList":[]}]}