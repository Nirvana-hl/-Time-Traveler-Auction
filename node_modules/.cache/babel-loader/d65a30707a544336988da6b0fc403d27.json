{"remainingRequest":"D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\babel-loader\\lib\\index.js!D:\\大学生活\\大三\\全栈ai\\项目\\-Time-Traveler-Auction\\src\\features\\game\\room-state.service.js","dependencies":[{"path":"D:\\大学生活\\大三\\全栈ai\\项目\\-Time-Traveler-Auction\\src\\features\\game\\room-state.service.js","mtime":1762781804549},{"path":"D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1762215254891},{"path":"D:\\大学生活\\大三\\全栈ai\\项目\\node_modules\\babel-loader\\lib\\index.js","mtime":1762215256120}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8g5bCB6KOF5oi/6Ze054q25oCB5ZCM5q2l6YC76L6R77yM5YeP5bCR6aG16Z2i5L2T56ev5bm25o+Q5Y2H5Y+v6K+75oCnCgovKioKICog5ZCM5q2l5oi/6Ze054q25oCB77yI5Ymv5L2c55So5byP77yJ77yaCiAqIC0g5ouJ5Y+W5oi/6Ze05LiO546p5a625bm25oyJ5bqn5L2N5o6S5bqPCiAqIC0g5qC55o2u5oi/6Ze054q25oCB5YiH5o2i6Zi25q615LiO5riF55CG5YCS6K6h5pe2CiAqIC0g5ZyoIHBsYXlpbmcg5ZCM5q2l5rS76LeD5ouN5Y2WCiAqIC0g5ZyoIGVuZGVkIOi/m+WFpee7k+eul+W5tuWbnumAgAogKiAtIOaLieWPliBwcm9maWxlc++8iOaYteensC/lpLTlg4/vvIkKICogLSDmi4nlj5blvZPliY3nlKjmiLfmiYvniYzlubblhpnlhaUgc3RvcmUKICovCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkUm9vbVN0YXRlKHsKICByb29tSWQsCiAgcm9vbVNlcnZpY2UsCiAgc3VwYWJhc2UsCiAgYXJ0aWZhY3RNYXAsCiAgc3RvcmUsCiAgc2V0Um9vbSwKICBzZXRQcm9maWxlTWFwLAogIHNldEdhbWVQaGFzZSwKICBjbGVhckF1Y3Rpb25UaW1lciwKICBzZXRBdWN0aW9uQ291bnRkb3duLAogIG9uU2hvd0dhbWVFbmQKfSkgewogIHRyeSB7CiAgICBpZiAoIXJvb21JZCkgewogICAgICBzZXRSb29tKG51bGwpOwogICAgICByZXR1cm47CiAgICB9CgogICAgLy8g5oi/6Ze05LiO546p5a62CiAgICBjb25zdCByb29tID0gYXdhaXQgcm9vbVNlcnZpY2UuZ2V0Um9vbShyb29tSWQpOwogICAgY29uc3QgcGxheWVycyA9IHJvb20gJiYgcm9vbS5yb29tX3BsYXllcnMgPyBbLi4ucm9vbS5yb29tX3BsYXllcnNdIDogW107CiAgICBwbGF5ZXJzLnNvcnQoKGEsIGIpID0+IHsKICAgICAgY29uc3QgYWkgPSB0eXBlb2YgYS5zZWF0X2luZGV4ID09PSAnbnVtYmVyJyA/IGEuc2VhdF9pbmRleCA6IDk5OTk7CiAgICAgIGNvbnN0IGJpID0gdHlwZW9mIGIuc2VhdF9pbmRleCA9PT0gJ251bWJlcicgPyBiLnNlYXRfaW5kZXggOiA5OTk5OwogICAgICByZXR1cm4gYWkgLSBiaTsKICAgIH0pOwogICAgcm9vbS5yb29tX3BsYXllcnMgPSBwbGF5ZXJzOwogICAgc2V0Um9vbShyb29tKTsKCiAgICAvLyDnrYnlvoXmgIEgLT4g5YeG5aSH6Zi25q615bm25riF55CG5YCS6K6h5pe25LiO5ouN5Y2WCiAgICBpZiAocm9vbSAmJiByb29tLnN0YXR1cyA9PT0gJ3dhaXRpbmcnKSB7CiAgICAgIHNldEdhbWVQaGFzZSgncHJlcGFyYXRpb24nKTsKICAgICAgY2xlYXJBdWN0aW9uVGltZXIgJiYgY2xlYXJBdWN0aW9uVGltZXIoKTsKICAgICAgc2V0QXVjdGlvbkNvdW50ZG93biAmJiBzZXRBdWN0aW9uQ291bnRkb3duKDApOwogICAgICBzdG9yZS5jb21taXQoJ1NFVF9DVVJSRU5UX0FVQ1RJT05TJywgW10pOwogICAgfQoKICAgIC8vIHBsYXlpbmcgLT4g5ZCM5q2l5rS76LeD5ouN5Y2W77yI5omA5pyJ546p5a626YO95bqU6K+l55yL5Yiw77yJCiAgICBpZiAocm9vbSAmJiByb29tLnN0YXR1cyA9PT0gJ3BsYXlpbmcnKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgewogICAgICAgICAgZGF0YTogZGJBdWN0aW9ucwogICAgICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5mcm9tKCdhdWN0aW9ucycpLnNlbGVjdCgnKicpLmVxKCdzdGF0dXMnLCAnYWN0aXZlJykuZXEoJ3Jvb21faWQnLCByb29tSWQpOwoKICAgICAgICAvLyDlkIzmraXmiYDmnInmtLvot4Pmi43ljZbvvIzkvb/nlKggQUREX09SX1VQREFURV9BVUNUSU9OIOehruS/neabtOaWsOW3suWtmOWcqOeahOaLjeWNlgogICAgICAgIGNvbnN0IGRiQXVjdGlvbklkcyA9IG5ldyBTZXQoKTsKICAgICAgICBjb25zdCBhdWN0aW9uc1RvU3luYyA9IFtdOwogICAgICAgIGxldCBtaW5SZW1haW5pbmcgPSBudWxsOwogICAgICAgIGZvciAoY29uc3Qgcm93IG9mIGRiQXVjdGlvbnMgfHwgW10pIHsKICAgICAgICAgIGRiQXVjdGlvbklkcy5hZGQocm93LmlkKTsKICAgICAgICAgIC8vIOS8mOWFiOS9v+eUqCBhcnRpZmFjdE1hcO+8jOWmguaenOayoeacieWImeS7jiByb3cuYXJ0aWZhY3Qg6I635Y+W77yM5pyA5ZCO5L2/55So6buY6K6k5YC8CiAgICAgICAgICBsZXQgYXJ0aWZhY3QgPSBhcnRpZmFjdE1hcCAmJiBhcnRpZmFjdE1hcFtyb3cuYXJ0aWZhY3RfaWRdID8gYXJ0aWZhY3RNYXBbcm93LmFydGlmYWN0X2lkXSA6IHJvdy5hcnRpZmFjdCB8fCB7CiAgICAgICAgICAgIGlkOiByb3cuYXJ0aWZhY3RfaWQsCiAgICAgICAgICAgIG5hbWU6IHJvdy5hcnRpZmFjdF9pZAogICAgICAgICAgfTsKCiAgICAgICAgICAvLyDln7rkuo4gY3JlYXRlZF9hdCDkuI4gdGltZV9yZW1haW5pbmcg6K6h566X5Ymp5L2Z5pe26Ze077yIdGltZV9yZW1haW5pbmcg6KeG5Li65oC75pe26ZW/77yJCiAgICAgICAgICBjb25zdCBjcmVhdGVkQXQgPSByb3cuY3JlYXRlZF9hdCA/IG5ldyBEYXRlKHJvdy5jcmVhdGVkX2F0KS5nZXRUaW1lKCkgOiBEYXRlLm5vdygpOwogICAgICAgICAgY29uc3QgdG90YWwgPSB0eXBlb2Ygcm93LnRpbWVfcmVtYWluaW5nID09PSAnbnVtYmVyJyAmJiByb3cudGltZV9yZW1haW5pbmcgPiAwID8gcm93LnRpbWVfcmVtYWluaW5nIDogMzA7CiAgICAgICAgICBjb25zdCBlbGFwc2VkID0gTWF0aC5mbG9vcigoRGF0ZS5ub3coKSAtIGNyZWF0ZWRBdCkgLyAxMDAwKTsKICAgICAgICAgIGNvbnN0IHJlbWFpbmluZyA9IE1hdGgubWF4KDAsIHRvdGFsIC0gZWxhcHNlZCk7CiAgICAgICAgICBpZiAobWluUmVtYWluaW5nID09PSBudWxsKSBtaW5SZW1haW5pbmcgPSByZW1haW5pbmc7ZWxzZSBtaW5SZW1haW5pbmcgPSBNYXRoLm1pbihtaW5SZW1haW5pbmcsIHJlbWFpbmluZyk7CiAgICAgICAgICBjb25zdCBhdWN0aW9uID0gewogICAgICAgICAgICBpZDogcm93LmlkLAogICAgICAgICAgICBhcnRpZmFjdCwKICAgICAgICAgICAgaGlnaGVzdEJpZDogcm93LmhpZ2hlc3RfYmlkIHx8IDAsCiAgICAgICAgICAgIGhpZ2hlc3RCaWRkZXI6IHJvdy5oaWdoZXN0X2JpZGRlciB8fCBudWxsLAogICAgICAgICAgICB0aW1lUmVtYWluaW5nOiByZW1haW5pbmcsCiAgICAgICAgICAgIGJpZHM6IFtdLAogICAgICAgICAgICBzdGFydFRpbWU6IGNyZWF0ZWRBdCwKICAgICAgICAgICAgc3RhdHVzOiAnYWN0aXZlJywKICAgICAgICAgICAgX3RpbWVyOiBudWxsCiAgICAgICAgICB9OwogICAgICAgICAgYXVjdGlvbnNUb1N5bmMucHVzaChhdWN0aW9uKTsKICAgICAgICB9CgogICAgICAgIC8vIOaJuemHj+WQjOatpeaJgOacieaLjeWNlu+8jOehruS/neaJgOacieeOqeWutumDveiDveeci+WIsAogICAgICAgIGF1Y3Rpb25zVG9TeW5jLmZvckVhY2goYXVjdGlvbiA9PiB7CiAgICAgICAgICBzdG9yZS5jb21taXQoJ0FERF9PUl9VUERBVEVfQVVDVElPTicsIGF1Y3Rpb24pOwogICAgICAgIH0pOwoKICAgICAgICAvLyDlpoLmnpzmnInmtLvot4Pmi43ljZbvvIznoa7kv53pmLbmrrXorr7nva7kuLogYXVjdGlvbu+8jOW5tuiuvue9rue7n+S4gOWAkuiuoeaXtgogICAgICAgIGlmIChhdWN0aW9uc1RvU3luYy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBzZXRHYW1lUGhhc2UoJ2F1Y3Rpb24nKTsKICAgICAgICAgIGlmICh0eXBlb2YgbWluUmVtYWluaW5nID09PSAnbnVtYmVyJyAmJiBtaW5SZW1haW5pbmcgPiAwKSB7CiAgICAgICAgICAgIHNldEF1Y3Rpb25Db3VudGRvd24gJiYgc2V0QXVjdGlvbkNvdW50ZG93bihtaW5SZW1haW5pbmcpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDlpoLmnpzmsqHmnInmtLvot4Pmi43ljZbvvIzkvYbmiL/pl7TnirbmgIHmmK8gcGxheWluZ++8jOWPr+iDveaYr+WFtuS7lumYtuautQogICAgICAgICAgLy8g5LiN5by65Yi26K6+572uIGdhbWVQaGFzZe+8jOiuqeWFtuS7lumAu+i+keWkhOeQhgogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUud2FybignW3Jvb20tc3RhdGVdIHN5bmMgYWN0aXZlIGF1Y3Rpb25zIGZhaWxlZCcsIGUpOwogICAgICB9CiAgICB9CgogICAgLy8g57uT5p2f5oCBIC0+IOi/m+WFpee7k+eul+W5tuinpuWPkeWbnumAgAogICAgaWYgKHJvb20gJiYgcm9vbS5zdGF0dXMgPT09ICdlbmRlZCcpIHsKICAgICAgc2V0R2FtZVBoYXNlKCdzZXR0bGVtZW50Jyk7CiAgICAgIG9uU2hvd0dhbWVFbmQgJiYgb25TaG93R2FtZUVuZCgpOwogICAgfQoKICAgIC8vIOWKoOi9vSBwcm9maWxlcwogICAgY29uc3QgaWRzID0gQXJyYXkuZnJvbShuZXcgU2V0KHBsYXllcnMubWFwKHAgPT4gcC51c2VyX2lkKS5maWx0ZXIoQm9vbGVhbikpKTsKICAgIGlmIChpZHMubGVuZ3RoID4gMCkgewogICAgICBjb25zdCB7CiAgICAgICAgZGF0YTogcHJvZnMKICAgICAgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oJ3Byb2ZpbGVzJykuc2VsZWN0KCdpZCwgdXNlcm5hbWUsIGF2YXRhcicpLmluKCdpZCcsIGlkcyk7CiAgICAgIGNvbnN0IG1hcCA9IHt9OwogICAgICAocHJvZnMgfHwgW10pLmZvckVhY2gocCA9PiB7CiAgICAgICAgbWFwW3AuaWRdID0gewogICAgICAgICAgdXNlcm5hbWU6IHAudXNlcm5hbWUsCiAgICAgICAgICBhdmF0YXI6IHAuYXZhdGFyCiAgICAgICAgfTsKICAgICAgfSk7CiAgICAgIHNldFByb2ZpbGVNYXAobWFwKTsKICAgIH0gZWxzZSB7CiAgICAgIHNldFByb2ZpbGVNYXAoe30pOwogICAgfQoKICAgIC8vIOWQjOatpeW9k+WJjeeUqOaIt+aJi+eJjAogICAgdHJ5IHsKICAgICAgY29uc3QgdWlkID0gc3RvcmUuc3RhdGUudXNlciAmJiBzdG9yZS5zdGF0ZS51c2VyLmlkOwogICAgICBpZiAocm9vbUlkICYmIHVpZCkgewogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGRhdGE6IG93bmVkCiAgICAgICAgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oJ3Jvb21fYXJ0aWZhY3RzJykuc2VsZWN0KCdhcnRpZmFjdF9pZCcpLmVxKCdyb29tX2lkJywgcm9vbUlkKS5lcSgnb3duZXJfdXNlcl9pZCcsIHVpZCk7CiAgICAgICAgY29uc3QgYWlkcyA9IChvd25lZCB8fCBbXSkubWFwKHIgPT4gci5hcnRpZmFjdF9pZCk7CiAgICAgICAgY29uc3QgbWUgPSAocm9vbSAmJiByb29tLnJvb21fcGxheWVycyA/IHJvb20ucm9vbV9wbGF5ZXJzIDogW10pLmZpbmQocCA9PiBwLnVzZXJfaWQgPT09IHVpZCk7CiAgICAgICAgaWYgKG1lKSB7CiAgICAgICAgICBjb25zdCBuZXh0ID0gewogICAgICAgICAgICBpZDogbWUudXNlcl9pZCwKICAgICAgICAgICAgbmFtZTogc3RvcmUuc3RhdGUudXNlciAmJiBzdG9yZS5zdGF0ZS51c2VyLmVtYWlsIHx8IG1lLnVzZXJfaWQsCiAgICAgICAgICAgIGVuZXJneTogNTAsCiAgICAgICAgICAgIGFydGlmYWN0czogYWlkcywKICAgICAgICAgICAgaXRlbXM6IFtdCiAgICAgICAgICB9OwogICAgICAgICAgc3RvcmUuY29tbWl0KCdTRVRfQ1VSUkVOVF9QTEFZRVInLCBuZXh0KTsKICAgICAgICAgIHN0b3JlLmNvbW1pdCgnU0VUX1BMQVlFUl9BUlRJRkFDVFMnLCBhaWRzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgY29uc29sZS53YXJuKCdbcm9vbS1zdGF0ZV0gc3luYyBwbGF5ZXIgaGFuZCBmYWlsZWQnLCBlKTsKICAgIH0KICB9IGNhdGNoIChlKSB7CiAgICBjb25zb2xlLndhcm4oJ1tyb29tLXN0YXRlXSBsb2FkUm9vbVN0YXRlIGZhaWxlZCcsIGUpOwogIH0KfQ=="},{"version":3,"names":["loadRoomState","roomId","roomService","supabase","artifactMap","store","setRoom","setProfileMap","setGamePhase","clearAuctionTimer","setAuctionCountdown","onShowGameEnd","room","getRoom","players","room_players","sort","a","b","ai","seat_index","bi","status","commit","data","dbAuctions","from","select","eq","dbAuctionIds","Set","auctionsToSync","minRemaining","row","add","id","artifact","artifact_id","name","createdAt","created_at","Date","getTime","now","total","time_remaining","elapsed","Math","floor","remaining","max","min","auction","highestBid","highest_bid","highestBidder","highest_bidder","timeRemaining","bids","startTime","_timer","push","forEach","length","e","console","warn","ids","Array","map","p","user_id","filter","Boolean","profs","in","username","avatar","uid","state","user","owned","aids","r","me","find","next","email","energy","artifacts","items"],"sources":["D:/大学生活/大三/全栈ai/项目/-Time-Traveler-Auction/src/features/game/room-state.service.js"],"sourcesContent":["// 封装房间状态同步逻辑，减少页面体积并提升可读性\n\n/**\n * 同步房间状态（副作用式）：\n * - 拉取房间与玩家并按座位排序\n * - 根据房间状态切换阶段与清理倒计时\n * - 在 playing 同步活跃拍卖\n * - 在 ended 进入结算并回退\n * - 拉取 profiles（昵称/头像）\n * - 拉取当前用户手牌并写入 store\n */\nexport async function loadRoomState({\n  roomId,\n  roomService,\n  supabase,\n  artifactMap,\n  store,\n  setRoom,\n  setProfileMap,\n  setGamePhase,\n  clearAuctionTimer,\n  setAuctionCountdown,\n  onShowGameEnd,\n}) {\n  try {\n    if (!roomId) { setRoom(null); return }\n\n    // 房间与玩家\n    const room = await roomService.getRoom(roomId)\n    const players = (room && room.room_players) ? [...room.room_players] : []\n    players.sort((a, b) => {\n      const ai = (typeof a.seat_index === 'number') ? a.seat_index : 9999\n      const bi = (typeof b.seat_index === 'number') ? b.seat_index : 9999\n      return ai - bi\n    })\n    room.room_players = players\n    setRoom(room)\n\n    // 等待态 -> 准备阶段并清理倒计时与拍卖\n    if (room && room.status === 'waiting') {\n      setGamePhase('preparation')\n      clearAuctionTimer && clearAuctionTimer()\n      setAuctionCountdown && setAuctionCountdown(0)\n      store.commit('SET_CURRENT_AUCTIONS', [])\n    }\n\n    // playing -> 同步活跃拍卖（所有玩家都应该看到）\n    if (room && room.status === 'playing') {\n      try {\n        const { data: dbAuctions } = await supabase\n          .from('auctions')\n          .select('*')\n          .eq('status', 'active')\n          .eq('room_id', roomId)\n\n        // 同步所有活跃拍卖，使用 ADD_OR_UPDATE_AUCTION 确保更新已存在的拍卖\n        const dbAuctionIds = new Set()\n        const auctionsToSync = []\n        \n        let minRemaining = null\n        for (const row of (dbAuctions || [])) {\n          dbAuctionIds.add(row.id)\n          // 优先使用 artifactMap，如果没有则从 row.artifact 获取，最后使用默认值\n          let artifact = artifactMap && artifactMap[row.artifact_id] \n            ? artifactMap[row.artifact_id]\n            : (row.artifact || { id: row.artifact_id, name: row.artifact_id })\n          \n          // 基于 created_at 与 time_remaining 计算剩余时间（time_remaining 视为总时长）\n          const createdAt = row.created_at ? new Date(row.created_at).getTime() : Date.now()\n          const total = (typeof row.time_remaining === 'number' && row.time_remaining > 0) ? row.time_remaining : 30\n          const elapsed = Math.floor((Date.now() - createdAt) / 1000)\n          const remaining = Math.max(0, total - elapsed)\n          if (minRemaining === null) minRemaining = remaining\n          else minRemaining = Math.min(minRemaining, remaining)\n\n          const auction = {\n            id: row.id,\n            artifact,\n            highestBid: row.highest_bid || 0,\n            highestBidder: row.highest_bidder || null,\n            timeRemaining: remaining,\n            bids: [],\n            startTime: createdAt,\n            status: 'active',\n            _timer: null\n          }\n          auctionsToSync.push(auction)\n        }\n        \n        // 批量同步所有拍卖，确保所有玩家都能看到\n        auctionsToSync.forEach(auction => {\n          store.commit('ADD_OR_UPDATE_AUCTION', auction)\n        })\n        \n        // 如果有活跃拍卖，确保阶段设置为 auction，并设置统一倒计时\n        if (auctionsToSync.length > 0) {\n          setGamePhase('auction')\n          if (typeof minRemaining === 'number' && minRemaining > 0) {\n            setAuctionCountdown && setAuctionCountdown(minRemaining)\n          }\n        } else {\n          // 如果没有活跃拍卖，但房间状态是 playing，可能是其他阶段\n          // 不强制设置 gamePhase，让其他逻辑处理\n        }\n      } catch (e) {\n        console.warn('[room-state] sync active auctions failed', e)\n      }\n    }\n\n    // 结束态 -> 进入结算并触发回退\n    if (room && room.status === 'ended') {\n      setGamePhase('settlement')\n      onShowGameEnd && onShowGameEnd()\n    }\n\n    // 加载 profiles\n    const ids = Array.from(new Set(players.map(p => p.user_id).filter(Boolean)))\n    if (ids.length > 0) {\n      const { data: profs } = await supabase\n        .from('profiles')\n        .select('id, username, avatar')\n        .in('id', ids)\n      const map = {}\n      ;(profs || []).forEach(p => { map[p.id] = { username: p.username, avatar: p.avatar } })\n      setProfileMap(map)\n    } else {\n      setProfileMap({})\n    }\n\n    // 同步当前用户手牌\n    try {\n      const uid = store.state.user && store.state.user.id\n      if (roomId && uid) {\n        const { data: owned } = await supabase\n          .from('room_artifacts')\n          .select('artifact_id')\n          .eq('room_id', roomId)\n          .eq('owner_user_id', uid)\n        const aids = (owned || []).map(r => r.artifact_id)\n        const me = (room && room.room_players ? room.room_players : []).find(p => p.user_id === uid)\n        if (me) {\n          const next = {\n            id: me.user_id,\n            name: (store.state.user && store.state.user.email) || me.user_id,\n            energy: 50,\n            artifacts: aids,\n            items: []\n          }\n          store.commit('SET_CURRENT_PLAYER', next)\n          store.commit('SET_PLAYER_ARTIFACTS', aids)\n        }\n      }\n    } catch (e) {\n      console.warn('[room-state] sync player hand failed', e)\n    }\n  } catch (e) {\n    console.warn('[room-state] loadRoomState failed', e)\n  }\n}\n\n\n"],"mappings":"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","ignoreList":[]}]}